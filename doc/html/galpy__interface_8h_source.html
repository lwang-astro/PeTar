<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeTar: galpy_interface.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PeTar
   </div>
   <div id="projectbrief">N-body code for collisional gravitational systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('galpy__interface_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">galpy_interface.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="galpy__interface_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;getopt.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;../src/io.hpp&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;integrateFullOrbit.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html">   15</a></span>&#160;<span class="keyword">class </span><a class="code" href="classIOParamsGalpy.html">IOParamsGalpy</a>{</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">   17</a></span>&#160;    <a class="code" href="classIOParamsContainer.html">IOParamsContainer</a> <a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>;</div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">   18</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;std::string&gt;</a> <a class="code" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">type_args</a>; <span class="comment">// potential type and argument list</span></div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">   19</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;std::string&gt;</a> <a class="code" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">pre_define_type</a>; <span class="comment">// pre defined type name</span></div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">   20</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;std::string&gt;</a> <a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>; <span class="comment">// configure file name</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//IOParams&lt;std::string&gt; unit_set; // unscale, bovy </span></div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">   22</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;double&gt;</a> <a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">//IOParams&lt;double&gt; tscale; </span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">   24</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;double&gt;</a> <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <span class="comment">//IOParams&lt;double&gt; fscale; </span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">//IOParams&lt;double&gt; pscale; </span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    </div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">   28</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a9183f2e1c26b6480684a561e3a170b5b">   30</a></span>&#160;    <a class="code" href="classIOParamsGalpy.html#a9183f2e1c26b6480684a561e3a170b5b">IOParamsGalpy</a>(): <a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>(),</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                     <a class="code" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">type_args</a> (<a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>, <span class="stringliteral">&quot;__NONE__&quot;</span>, <span class="stringliteral">&quot;galpy-type-arg&quot;</span>, <span class="stringliteral">&quot;Add potential types and argumentsto the potential list in the center of the galactic reference frame&quot;</span>),</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                     <a class="code" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">pre_define_type</a> (<a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>, <span class="stringliteral">&quot;__NONE__&quot;</span>, <span class="stringliteral">&quot;galpy-set&quot;</span>, <span class="stringliteral">&quot;Add a pre-defined potential set to the potential list, options are: MWPotential2014&quot;</span>),</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                     <a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>(<a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>, <span class="stringliteral">&quot;__NONE__&quot;</span>, <span class="stringliteral">&quot;galpy-conf-file&quot;</span>, <span class="stringliteral">&quot;A configure file of the time- and space-dependent potentials&quot;</span>),</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                     <span class="comment">//unit_set(input_par_store, &quot;unscale&quot;, &quot;galpy-units&quot;, &quot;Units conversion set: &#39;unscale&#39;: no conversion; all scale factors are 1.0; &#39;bovy&#39;: radial unit: 8 kpc; velocity unit: 220 km/s&quot;),</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                     <a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>(<a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>, 1.0, <span class="stringliteral">&quot;galpy-rscale&quot;</span>, <span class="stringliteral">&quot;Radius scale factor from unit of the input particle data (IN) to Galpy distance unit (1.0)&quot;</span>),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                     <span class="comment">//tscale(input_par_store, 1.0, &quot;galpy-tscale&quot;, &quot;Time scale factor (rscale/vscale) from unit of the input particle data (IN) to Galpy time (1.0)&quot;),</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                     <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>(<a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>, 1.0, <span class="stringliteral">&quot;galpy-vscale&quot;</span>, <span class="stringliteral">&quot;Velocity scale factor from unit of the input particle data (IN) to Galpy velocity unit (1.0)&quot;</span>),</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                     <span class="comment">//fscale(input_par_store, 1.0, &quot;galpy-fscale&quot;, &quot;Acceleration scale factor (vscale^2/rscale) from unit of the input particle data (IN) to Galpy acceleration unit (1.0)&quot;),</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                     <span class="comment">//pscale(input_par_store, 1.0, &quot;galpy-pscale&quot;, &quot;Potential scale factor (vscale^2) from unit of the input particle data (IN) to Galpy potential unit (1.0)&quot;),</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                     <a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>(false) {}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a7525714c40a2cc23a672b9f2498dcc3d">   49</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classIOParamsGalpy.html#a7525714c40a2cc23a672b9f2498dcc3d">read</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[], <span class="keyword">const</span> <span class="keywordtype">int</span> opt_used_pre=0) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">int</span> galpy_flag=-1;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keyword">const</span> <span class="keyword">struct </span>option long_options[] = {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            {<a class="code" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">type_args</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,       required_argument, &amp;galpy_flag, 0}, </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            {<a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>, required_argument, &amp;galpy_flag, 1}, </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            {<a class="code" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">pre_define_type</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>, required_argument, &amp;galpy_flag, 2}, </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            {<a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,     required_argument, &amp;galpy_flag, 3}, </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="comment">//{tscale.key,     required_argument, &amp;galpy_flag, 4}, </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            {<a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,     required_argument, &amp;galpy_flag, 5}, </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <span class="comment">//{fscale.key,     required_argument, &amp;galpy_flag, 6}, </span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="comment">//{pscale.key,     required_argument, &amp;galpy_flag, 7}, </span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            {<span class="stringliteral">&quot;help&quot;</span>, no_argument, 0, <span class="charliteral">&#39;h&#39;</span>},</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            {0,0,0,0}</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        };</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <span class="keywordtype">int</span> opt_used=opt_used_pre;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        <span class="keywordtype">int</span> copt;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordtype">int</span> option_index;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        std::string fname_par;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        optind = 0;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">while</span> ((copt = getopt_long(argc, argv, <span class="stringliteral">&quot;-p:h&quot;</span>, long_options, &amp;option_index)) != -1) </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">switch</span> (copt) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                <span class="keywordflow">switch</span> (galpy_flag) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">type_args</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = optarg;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) <a class="code" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">type_args</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                    opt_used+=2;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = optarg;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) <a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                    opt_used+=2;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">pre_define_type</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = optarg;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) <a class="code" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">pre_define_type</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    opt_used+=2;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) <a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    opt_used+=2;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                <span class="comment">//case 4:</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                <span class="comment">//    tscale.value = atof(optarg);</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="comment">//    if(print_flag) tscale.print(std::cout);</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                <span class="comment">//    opt_used+=2;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                <span class="comment">//    break;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    opt_used+=2;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                <span class="comment">//case 6:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                <span class="comment">//    fscale.value = atof(optarg);</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="comment">//    if(print_flag) fscale.print(std::cout);</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                <span class="comment">//    opt_used+=2;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                <span class="comment">//    break;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <span class="comment">//case 7:</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="comment">//    pscale.value = atof(optarg);</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                <span class="comment">//    if(print_flag) pscale.print(std::cout);</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                <span class="comment">//    opt_used+=2;</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                fname_par = optarg;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    std::string fgalpy_par = fname_par+<span class="stringliteral">&quot;.galpy&quot;</span>; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    FILE* fpar_in;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    <span class="keywordflow">if</span>( (fpar_in = fopen(fgalpy_par.c_str(),<span class="stringliteral">&quot;r&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                        fprintf(stderr,<span class="stringliteral">&quot;Error: Cannot open file %s.\n&quot;</span>, fgalpy_par.c_str());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        abort();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a972926da32b4043d06456ab6d35d7752">readAscii</a>(fpar_in);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    fclose(fpar_in);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                opt_used+=2;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                <a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>.mpi_broadcast();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>){</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;Galpy options:&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    <a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a8bdebaa655392813c07b0dd4ae6469c2">printHelp</a>(std::cout, 2, 10, 23);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;***PS: use petar.galpy.help to check how to setup --galpy-type-arg and --galpy-conf-file.&quot;</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                             &lt;&lt;std::endl;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                opt_used +=2;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) std::cout&lt;&lt;<span class="stringliteral">&quot;----- Finish reading input options of Galpy -----\n&quot;</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">return</span> opt_used;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }    </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classIOParamsGalpy.html#a1942c7fd5832585b77186e543acc640d">  156</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classIOParamsGalpy.html#a1942c7fd5832585b77186e543acc640d">setBovyUnit</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>=<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordtype">double</span> kms_pcmyr=1.022712165045695; <span class="comment">// pc = 30856775814913673 m, yr = 365.25 days</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">double</span> vbase=220.0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordtype">double</span> rbase=8.0;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">double</span> vb_pcmyr = vbase*kms_pcmyr;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 0.001/rbase; <span class="comment">// pc to solar position in Milkyway</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 1.0/vb_pcmyr; <span class="comment">// pc/Myr to solar velocity in Milkyway</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordtype">double</span> tscale = <a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>/<a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>; <span class="comment">// myr to time unit in galpy</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordtype">double</span> fscale = <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>*<a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>/<a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>; <span class="comment">// pc/Myr^2 to acc unit in galpy</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordtype">double</span> pscale = <a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>*<a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>; <span class="comment">// pc^2/Myr^2 to pot unit in galpy</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordtype">double</span> GMscale = pscale*<a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>; <span class="comment">// pc^3/Myr^2</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;----- Unit conversion for Galpy -----\n&quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;rscale  = &quot;</span>&lt;&lt;<a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot;  [8 kpc] / [pc]\n&quot;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;vscale  = &quot;</span>&lt;&lt;<a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot;  [220 km/s] / [pc/Myr]\n&quot;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;tscale  = &quot;</span>&lt;&lt;tscale &lt;&lt;<span class="stringliteral">&quot;  [Solar orbital period/2 pi] / Myr\n&quot;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;fscale  = &quot;</span>&lt;&lt;fscale &lt;&lt;<span class="stringliteral">&quot;  [galpy acceleration unit] / [pc/Myr^2]\n&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;pscale  = &quot;</span>&lt;&lt;pscale &lt;&lt;<span class="stringliteral">&quot;  [galpy potential unit] / [pc^2/Myr^2]\n&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;GMscale = &quot;</span>&lt;&lt;GMscale&lt;&lt;<span class="stringliteral">&quot;  [galpy gravitational constant * mass unit] / [pc^3/Myr^2]\n&quot;</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;};</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classFRWModel.html">  181</a></span>&#160;<span class="keyword">class </span><a class="code" href="classFRWModel.html">FRWModel</a>{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">  183</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>; <span class="comment">// current time (Myr)</span></div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">  184</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>; <span class="comment">// maximum time step to integrate a (Myr)</span></div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">  185</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>; <span class="comment">//scale factor</span></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">  186</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">H0</a>; <span class="comment">// Hubble constant (km s^-1 Mpc^-1)</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classFRWModel.html#a274ccc0053de35e759f314a9c5b9e8ca">  187</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a274ccc0053de35e759f314a9c5b9e8ca">H0_myr</a>; <span class="comment">// scaled Hubble constant (Myr^-1)</span></div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">  188</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">omega_energy</a>; <span class="comment">// normalized dark energy density</span></div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">  189</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">omega_radiation</a>; <span class="comment">// normalized radiation density</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">  190</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">omega_matter</a>; <span class="comment">// normalized matter density</span></div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">  191</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">dt_scale</a>; <span class="comment">// if -1, evolve a backwards with -dt, if 1, evolve forwards with dt, but time integration is not multiplied by dt_scale</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classFRWModel.html#a4e998f4739ff1df966beca89c1e393ed">  193</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a4e998f4739ff1df966beca89c1e393ed">getMatterDensity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _a)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">omega_matter</a>/_a;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classFRWModel.html#a80544a319035cb9fe253f2dee3d63d52">  197</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a80544a319035cb9fe253f2dee3d63d52">getRadiationDensity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _a)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">omega_radiation</a>/(_a*_a);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classFRWModel.html#a747610082f8b89bc7494512925f3d28a">  201</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a747610082f8b89bc7494512925f3d28a">getEnergyDensity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _a)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">omega_energy</a>*(_a*_a);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classFRWModel.html#ac639a14eba5f454ecd905f1e907c8ee4">  205</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#ac639a14eba5f454ecd905f1e907c8ee4">getCurvatureDensity</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">return</span> 1 - <a class="code" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">omega_energy</a> - <a class="code" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">omega_radiation</a> - <a class="code" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">omega_matter</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classFRWModel.html#a361381626bcc60640134c25e6c7357bb">  209</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a361381626bcc60640134c25e6c7357bb">getDensity</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _a)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFRWModel.html#a4e998f4739ff1df966beca89c1e393ed">getMatterDensity</a>(_a) + <a class="code" href="classFRWModel.html#a80544a319035cb9fe253f2dee3d63d52">getRadiationDensity</a>(_a) + <a class="code" href="classFRWModel.html#a747610082f8b89bc7494512925f3d28a">getEnergyDensity</a>(_a) + <a class="code" href="classFRWModel.html#ac639a14eba5f454ecd905f1e907c8ee4">getCurvatureDensity</a>();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classFRWModel.html#aed682fc0d41e7c4263e2512c36cab14c">  213</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classFRWModel.html#aed682fc0d41e7c4263e2512c36cab14c">calcH0Myr</a>() {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">double</span> kms_pcmyr=1.022712165045695; <span class="comment">// pc = 30856775814913673 m, yr = 365.25 days</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="classFRWModel.html#a274ccc0053de35e759f314a9c5b9e8ca">H0_myr</a> = <a class="code" href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">H0</a>*kms_pcmyr*1e-6;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classFRWModel.html#abb7a4dcaa3256b6365ef1cc5e9f5dba4">  223</a></span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#abb7a4dcaa3256b6365ef1cc5e9f5dba4">calcAdot</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _a)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFRWModel.html#a274ccc0053de35e759f314a9c5b9e8ca">H0_myr</a>*sqrt(<a class="code" href="classFRWModel.html#a361381626bcc60640134c25e6c7357bb">getDensity</a>(_a));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classFRWModel.html#a348b0ad06e5e83855a039ab5179806bc">  231</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classFRWModel.html#a348b0ad06e5e83855a039ab5179806bc">updateA</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _dt) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordtype">double</span> adot = <a class="code" href="classFRWModel.html#abb7a4dcaa3256b6365ef1cc5e9f5dba4">calcAdot</a>(<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordtype">double</span> a_tmp = <a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a> + adot*<a class="code" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">dt_scale</a>*_dt;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;10; k++) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordtype">double</span> adot_new = <a class="code" href="classFRWModel.html#abb7a4dcaa3256b6365ef1cc5e9f5dba4">calcAdot</a>(a_tmp);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            a_tmp = <a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a> + 0.5*(adot_new+adot)*<a class="code" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">dt_scale</a>*_dt;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a> = a_tmp;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a> += _dt;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="classFRWModel.html#a904c7a9d484ab006a8bbbc3f557f6e45">  247</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classFRWModel.html#a904c7a9d484ab006a8bbbc3f557f6e45">updateAwithDtmin</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _dt) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        assert(_dt&gt;=0);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        assert(<a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>&gt;0);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">if</span> (_dt==0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> = _dt;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespacegalpy__pot__movie.html#ae50af7118b493b53e207df8685051903">nstep</a> = 1;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>&gt;<a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> = <a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="namespacegalpy__pot__movie.html#ae50af7118b493b53e207df8685051903">nstep</a> = int(_dt/<a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="namespacegalpy__pot__movie.html#ae50af7118b493b53e207df8685051903">nstep</a>; i++) <a class="code" href="classFRWModel.html#a348b0ad06e5e83855a039ab5179806bc">updateA</a>(<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>*<a class="code" href="namespacegalpy__pot__movie.html#ae50af7118b493b53e207df8685051903">nstep</a>&lt;_dt) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> = _dt - <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>*<a class="code" href="namespacegalpy__pot__movie.html#ae50af7118b493b53e207df8685051903">nstep</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="classFRWModel.html#a348b0ad06e5e83855a039ab5179806bc">updateA</a>(<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classFRWModel.html#a262a19eeb8300f0a59c8555e052cbc27">  267</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classFRWModel.html#a262a19eeb8300f0a59c8555e052cbc27">getH</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classFRWModel.html#abb7a4dcaa3256b6365ef1cc5e9f5dba4">calcAdot</a>(<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>)/<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;};</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html">  277</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMWPotentialEvolve.html">MWPotentialEvolve</a>{</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tstream&gt;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">void</span> labelCheck(Tstream&amp; fconf, <span class="keyword">const</span> <span class="keywordtype">char</span>* match) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        std::string label;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        fconf&gt;&gt;label;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span> (label!=match) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy MWPotentialEvolve config: reading label error, should be &quot;</span>&lt;&lt;match&lt;&lt;<span class="stringliteral">&quot; given &quot;</span>&lt;&lt;label&lt;&lt;std::endl;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            abort();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordtype">void</span> eofCheck(std::ifstream&amp; fconf, <span class="keyword">const</span> <span class="keywordtype">char</span>* message) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span>(fconf.eof()) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy MWPotentialEvolve config: reading &quot;</span>&lt;&lt;message&lt;&lt;<span class="stringliteral">&quot; fails! File reaches EOF.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            abort();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">  297</a></span>&#160;    <a class="code" href="classFRWModel.html">FRWModel</a> <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#ac0edc3d6108e395caa1577f0b707e404">  299</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#ac0edc3d6108e395caa1577f0b707e404">m_vir_halo</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a288f772a110797a259b380fe6f193871">  300</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a288f772a110797a259b380fe6f193871">c_halo</a>; <span class="comment">// concentration</span></div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a06882b124341988f3c0d9dc473864755">  301</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a06882b124341988f3c0d9dc473864755">ac_halo</a>; <span class="comment">// formation epoch of halo (Wechsler 2002, Zhao 2003)</span></div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a53bb0027fa3c56b0057224d5a812e8b6">  302</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a53bb0027fa3c56b0057224d5a812e8b6">m_disk</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a6a7ff92430a30fe693b3600967e77bc3">  303</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a6a7ff92430a30fe693b3600967e77bc3">ra_disk</a>;</div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#aec26e403ae40bb15c8374bf2d1fce712">  304</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#aec26e403ae40bb15c8374bf2d1fce712">rb_disk</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a703845f35324fdc51dd04e12a1103869">  305</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a703845f35324fdc51dd04e12a1103869">rho_bulge</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a7b838de9cd30ec4a8577dd0288619c96">  306</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a7b838de9cd30ec4a8577dd0288619c96">alpha_bulge</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a2294a6e2c93d5bf3359543a0cb74d0fb">  307</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a2294a6e2c93d5bf3359543a0cb74d0fb">rcut_bulge</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    } <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#ac0edc3d6108e395caa1577f0b707e404">m_vir_halo</a>;</div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a40943161fcb025e7633e78145e94a8ab">  311</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a40943161fcb025e7633e78145e94a8ab">r_vir_halo</a>;</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a8c48aed3b62e12e8d2c2f0c3b83f3ecc">  312</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a8c48aed3b62e12e8d2c2f0c3b83f3ecc">rho_c_halo</a>;</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a1c00ebdf9675f7f32d3427161c7afa8d">  313</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a1c00ebdf9675f7f32d3427161c7afa8d">gm_halo</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a2a62324b191d80d5bb0f89d24a275a2f">  314</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a2a62324b191d80d5bb0f89d24a275a2f">rs_halo</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#aeec36a599f33df13050485a81d2714f3">  315</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#aeec36a599f33df13050485a81d2714f3">gm_disk</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a6a7ff92430a30fe693b3600967e77bc3">ra_disk</a>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#aec26e403ae40bb15c8374bf2d1fce712">rb_disk</a>;</div>
<div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a2f837fbca88ad8eb1df5325f12926c11">  318</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a2f837fbca88ad8eb1df5325f12926c11">grho_bulge</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a7b838de9cd30ec4a8577dd0288619c96">alpha_bulge</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classMWPotentialEvolve.html#a2294a6e2c93d5bf3359543a0cb74d0fb">rcut_bulge</a>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    } <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a45a7e51221c2de3937fcb72cd90fd11e">  343</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMWPotentialEvolve.html#a45a7e51221c2de3937fcb72cd90fd11e">initialFromFile</a>(<span class="keyword">const</span> std::string&amp; _filename, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _time) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordtype">int</span> my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            std::ifstream fconf;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            fconf.open(_filename.c_str(), std::ifstream::in);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="keywordflow">if</span> (!fconf.is_open()) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy MWPotentialEvolve config: configure file &quot;</span>&lt;&lt;_filename.c_str()&lt;&lt;<span class="stringliteral">&quot; cannot be open!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                abort();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;Time&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;current time (Myr)&quot;</span>);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;scale factor&quot;</span>);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;H0&quot;</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">H0</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;Hubble constant&quot;</span>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;Omega&quot;</span>);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">omega_energy</a>&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">omega_radiation</a>&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">omega_matter</a>;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;cosmological densities&quot;</span>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;dt_scale&quot;</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">dt_scale</a>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;time scale&quot;</span>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;dt_max&quot;</span>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;maximum time step (Myr)&quot;</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;Halo&quot;</span>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_vir_halo&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.c_halo&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ac_halo;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;Halo parameters&quot;</span>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;Disk&quot;</span>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_disk&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ra_disk&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rb_disk;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;Disk parameters&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            labelCheck(fconf, <span class="stringliteral">&quot;Bulge&quot;</span>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            fconf&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rho_bulge&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.alpha_bulge&gt;&gt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rcut_bulge;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            eofCheck(fconf, <span class="stringliteral">&quot;Bulge parameters&quot;</span>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            fconf.close();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        PS::Comm::broadcast(&amp;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>, 1, 0);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        PS::Comm::broadcast(&amp;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>, 1, 0);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>!=_time) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: the time recorded in the MWpotential parameter file, &quot;</span>&lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>&lt;&lt;<span class="stringliteral">&quot;, is not equal to the current system time, &quot;</span>&lt;&lt;_time&lt;&lt;<span class="stringliteral">&quot;!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            abort();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#aed682fc0d41e7c4263e2512c36cab14c">calcH0Myr</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a61d78d2224231b9d052d48cdd2d38eaf">  408</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMWPotentialEvolve.html#a61d78d2224231b9d052d48cdd2d38eaf">readDataFromFile</a>(<span class="keyword">const</span> std::string&amp; _filename, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _time) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> npar=17;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordtype">double</span> pars[npar];</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor"> #ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;         <span class="keywordtype">int</span> my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;         <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor"> #endif</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;             std::ifstream fconf;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;             fconf.open(_filename.c_str(), std::ifstream::in);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;             <span class="keywordflow">if</span> (!fconf.is_open()) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                 std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy MWPotentialEvolve config: configure file &quot;</span>&lt;&lt;_filename.c_str()&lt;&lt;<span class="stringliteral">&quot; cannot be open!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                 abort();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;             }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;npar; i++) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                 fconf&gt;&gt;pars[i];</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                 <span class="keywordflow">if</span> (fconf.eof()) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                     std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy MWPotentialEvolve config: reading number of parameters is &quot;</span>&lt;&lt;npar&lt;&lt;<span class="stringliteral">&quot; parameters, only &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; given!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                     abort();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                 }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;             }        </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;             fconf.close();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;         }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;         PS::Comm::broadcast(pars, npar, 0);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a> = pars[0];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>!=_time) {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;             std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: the time recorded in the MWpotential parameter file, &quot;</span>&lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>&lt;&lt;<span class="stringliteral">&quot;, is not equal to the current system time, &quot;</span>&lt;&lt;_time&lt;&lt;<span class="stringliteral">&quot;!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;             abort();</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;         }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a> = pars[1];</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">H0</a> = pars[2];</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#aed682fc0d41e7c4263e2512c36cab14c">calcH0Myr</a>();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">omega_energy</a> = pars[3];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">omega_radiation</a> = pars[4];</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">omega_matter</a> = pars[5];</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">dt_scale</a> = pars[6];</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a> = pars[7];</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_vir_halo = pars[8];</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.c_halo = pars[9];</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ac_halo = pars[10];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_disk = pars[11];</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ra_disk = pars[12];</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rb_disk = pars[13];</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rho_bulge = pars[14];</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.alpha_bulge = pars[15];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rcut_bulge = pars[16];</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a92e616d63b989428e6424e0d0180de7c">  466</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMWPotentialEvolve.html#a92e616d63b989428e6424e0d0180de7c">writeDataToFile</a>(<span class="keyword">const</span> std::string&amp; _filename) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        std::ofstream fout;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        fout.open(_filename.c_str(), std::ifstream::out);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">if</span> (!fout.is_open()) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Galpy potential parameter file to write, &quot;</span>&lt;&lt;_filename&lt;&lt;<span class="stringliteral">&quot;, cannot be open!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            abort();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        fout&lt;&lt;std::setprecision(14)</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">H0</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">omega_energy</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">omega_radiation</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">omega_matter</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">dt_scale</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">dt_max</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_vir_halo&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.c_halo&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ac_halo&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_disk&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ra_disk&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rb_disk&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rho_bulge&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.alpha_bulge&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            &lt;&lt;<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rcut_bulge</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            &lt;&lt;std::endl;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        fout.close();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    }</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="classMWPotentialEvolve.html#a499debe349e3789cd6fbab95bc56dabb">  498</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classMWPotentialEvolve.html#a499debe349e3789cd6fbab95bc56dabb">calcMWPotentialParameters</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _time) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> = _time-<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a904c7a9d484ab006a8bbbc3f557f6e45">updateAwithDtmin</a>(<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> G_astro = 0.0044983099795944;  <span class="comment">// Msun, pc, Myr</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> pi = 3.141592653589793;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordtype">double</span> z = 1/<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>-1; <span class="comment">// redshift</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">double</span> Ht = <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a262a19eeb8300f0a59c8555e052cbc27">getH</a>(); <span class="comment">// Myr^-1</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordtype">double</span> H0 = <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a274ccc0053de35e759f314a9c5b9e8ca">H0_myr</a>; <span class="comment">// Myr^-1</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordtype">double</span> mass_density_m1 = <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4e998f4739ff1df966beca89c1e393ed">getMatterDensity</a>(<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>)/<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a361381626bcc60640134c25e6c7357bb">getDensity</a>(<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>) - 1;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordtype">double</span> mass_density_m1_z0 = <a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4e998f4739ff1df966beca89c1e393ed">getMatterDensity</a>(1.0) - 1;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordtype">double</span> delta = 18*pi*pi + 82*mass_density_m1 - 39*mass_density_m1*mass_density_m1;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordtype">double</span> delta0 = 18*pi*pi + 82*mass_density_m1_z0 - 39*mass_density_m1_z0*mass_density_m1_z0;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.rho_c_halo = 3*Ht*Ht/(8*pi*G_astro); <span class="comment">// astro unit</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordtype">double</span> rho_c_halo0 = 3*H0*H0/(8*pi*G_astro); <span class="comment">// astro unit</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// halo, update Mvir, Rvir, c (Wechsler 2002, Zhao 2003) in astro unit</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordtype">double</span> mass_z_factor = std::exp(-2*<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ac_halo*z);  </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.m_vir_halo = <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_vir_halo*mass_z_factor; <span class="comment">// Msun</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.r_vir_halo = std::pow(3*<a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.m_vir_halo/(4*pi*delta*<a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.rho_c_halo),1.0/3.0);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordtype">double</span> rvir_z_factor = std::pow(mass_z_factor*delta0*rho_c_halo0/(delta*<a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.rho_c_halo), 1.0/3.0);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">// Galpy parameter for halo in Galpy unit</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordtype">double</span> c0 = <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.c_halo;  <span class="comment">// present-day concentration r_vir/r_s</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordtype">double</span> c = c0/(z+1); <span class="comment">// concentration at reshift z</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordtype">double</span> c_factor = 1.0/(std::log(1+c) - c/(1+c));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.gm_halo = G_astro*<a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.m_vir_halo*c_factor;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.rs_halo = <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.r_vir_halo/c;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <span class="comment">// disk &amp; budge, update mass and radial scale factors (Bullock &amp; Johnston 2005)</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.gm_disk = G_astro*<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.m_disk*mass_z_factor;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.ra_disk = <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.ra_disk*rvir_z_factor;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.rb_disk = <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rb_disk*rvir_z_factor;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.grho_bulge = G_astro*<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rho_bulge*mass_z_factor/std::pow(rvir_z_factor,3-<a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.alpha_bulge);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.alpha_bulge = <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.alpha_bulge;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>.rcut_bulge = <a class="code" href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">init</a>.rcut_bulge*rvir_z_factor;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;};</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html">  544</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structPotentialSetPar.html">PotentialSetPar</a>{</div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">  545</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">mode</a>; <span class="comment">// mode of origin: 0: galactic frame; 1: local particle system frame</span></div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">  546</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">gm</a>; <span class="comment">// G*mass of potential (used for computing acc from particle system)</span></div>
<div class="line"><a name="l00547"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">  547</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[3]; <span class="comment">// position</span></div>
<div class="line"><a name="l00548"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">  548</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[3]; <span class="comment">// velocity</span></div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">  549</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[3]; <span class="comment">// acceleration</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a25bedcd1c113e5bbd80dc59c2b99c4af">  551</a></span>&#160;    <a class="code" href="structPotentialSetPar.html#a25bedcd1c113e5bbd80dc59c2b99c4af">PotentialSetPar</a>(): <a class="code" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">mode</a>(-1), <a class="code" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">gm</a>(0), <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>{0.0,0.0,0.0}, <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>{0.0,0.0,0.0}, <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>{0.0,0.0,0.0} {}</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a2342aa0fad95c171b854d5048dfd9198">  554</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structPotentialSetPar.html#a2342aa0fad95c171b854d5048dfd9198">writeData</a>(std::ostream&amp; fout) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        fout&lt;&lt;<a class="code" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">mode</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            &lt;&lt;<a class="code" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">gm</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;3; i++) fout&lt;&lt;<a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;3; i++) fout&lt;&lt;<a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;3; i++) fout&lt;&lt;<a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a0440188b3ff1ea16d0a2ecea399e0c67">  562</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structPotentialSetPar.html#a0440188b3ff1ea16d0a2ecea399e0c67">readData</a>(std::ifstream&amp; fin) {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        fin&gt;&gt;<a class="code" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">mode</a>&gt;&gt;<a class="code" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">gm</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        fin&gt;&gt;<a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[0]&gt;&gt;<a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[1]&gt;&gt;<a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[2];</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        fin&gt;&gt;<a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[0]&gt;&gt;<a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[1]&gt;&gt;<a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[2];</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        fin&gt;&gt;<a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[0]&gt;&gt;<a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[1]&gt;&gt;<a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[2];</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a043c498a70f8cbed2f3a83b2c6ccee03">  570</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structPotentialSetPar.html#a043c498a70f8cbed2f3a83b2c6ccee03">setOrigin</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> _mode, <span class="keyword">const</span> <span class="keywordtype">double</span> _gm=0, <span class="keyword">const</span> <span class="keywordtype">double</span>* _pos=NULL, <span class="keyword">const</span> <span class="keywordtype">double</span>* _vel=NULL, <span class="keyword">const</span> <span class="keywordtype">double</span>* _acc=NULL) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        assert(_mode&gt;=0&amp;&amp;_mode&lt;=2);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <a class="code" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">mode</a> = _mode;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <a class="code" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">gm</a> = _gm;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keywordflow">if</span> (_pos!=NULL) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[0] = _pos[0];</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[1] = _pos[1];</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[2] = _pos[2];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> (_vel!=NULL) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[0] = _vel[0];</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[1] = _vel[1];</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[2] = _vel[2];</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (_acc!=NULL) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[0] = _acc[0];</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[1] = _acc[1];</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[2] = _acc[2];</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="structPotentialSetPar.html#a301ef58f6a6cfdd6622adfc8ec504416">  591</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structPotentialSetPar.html#a301ef58f6a6cfdd6622adfc8ec504416">clear</a>() {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <a class="code" href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">mode</a> = -1;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">gm</a> = 0.0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[0] = <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[1] = <a class="code" href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">pos</a>[2] = 0.0;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[0] = <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[1] = <a class="code" href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">vel</a>[2] = 0.0;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[0] = <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[1] = <a class="code" href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">acc</a>[2] = 0.0;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;};</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="structPotentialSet.html">  602</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structPotentialSet.html">PotentialSet</a>{</div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">  603</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>; <span class="comment">// number of potential models </span></div>
<div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">  604</a></span>&#160;    <span class="keyword">struct </span>potentialArg* <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>; <span class="comment">//potential arguments array for Gaply</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="structPotentialSet.html#ad38eef44f08ca8a8709a607cf156f6af">  606</a></span>&#160;    <a class="code" href="structPotentialSet.html#ad38eef44f08ca8a8709a607cf156f6af">PotentialSet</a>(): <a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>(0), <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>(NULL) {}</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="structPotentialSet.html#a505ba6bec47bb211e3efed6d0ceeec43">  614</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structPotentialSet.html#a505ba6bec47bb211e3efed6d0ceeec43">generatePotentialArgs</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> _npot, <span class="keywordtype">int</span>* _type, <span class="keywordtype">double</span>* _arg) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        assert(_npot&gt;0);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a> = _npot;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a> = <span class="keyword">new</span> <span class="keyword">struct </span>potentialArg[<a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>]; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#ifdef GALPY_VERSION_1_7_1</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        parse_leapFuncArgs_Full(<a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>, <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>, &amp;_type, &amp;_arg);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        parse_leapFuncArgs_Full(<a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>, <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>, &amp;_type, &amp;_arg, NULL);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="structPotentialSet.html#ab5df10085ca7311029cb112acc07591d">  625</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structPotentialSet.html#ab5df10085ca7311029cb112acc07591d">clear</a>() {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>!=NULL) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            assert(<a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>&gt;0);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            free_potentialArgs(<a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a>, <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            free(<a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a>);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <a class="code" href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">npot</a> = 0;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <a class="code" href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">arguments</a> = NULL;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="structPotentialSet.html#ad6c62996c0f166b5b19c6108bf5ae69c">  635</a></span>&#160;    <a class="code" href="structPotentialSet.html#ad6c62996c0f166b5b19c6108bf5ae69c">~PotentialSet</a>() { </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <a class="code" href="structPotentialSet.html#ab5df10085ca7311029cb112acc07591d">clear</a>(); </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;};</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno"><a class="line" href="structChangeArgument.html">  641</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structChangeArgument.html">ChangeArgument</a>{</div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="structChangeArgument.html#a0e70284724e4d9cd487e9c95bffbc1ee">  642</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structChangeArgument.html#a0e70284724e4d9cd487e9c95bffbc1ee">index</a>; <span class="comment">// index of argument for change</span></div>
<div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="structChangeArgument.html#a96868c86c9e431cb1de82db35c097661">  643</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structChangeArgument.html#a96868c86c9e431cb1de82db35c097661">mode</a>; <span class="comment">// change mode (1: linear; 2: exponential)</span></div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="structChangeArgument.html#afbe443c6700173c8963c49d179624535">  644</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structChangeArgument.html#afbe443c6700173c8963c49d179624535">rate</a>; <span class="comment">// change rate: linear: cofficient a in a*t; exp: cofficient a in exp(a*t)</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno"><a class="line" href="structChangeArgument.html#a21aa76b0b704069895de4d0f6d2e49dc">  647</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structChangeArgument.html#a21aa76b0b704069895de4d0f6d2e49dc">writeData</a>(std::ostream&amp; fout) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        fout&lt;&lt;<a class="code" href="structChangeArgument.html#a0e70284724e4d9cd487e9c95bffbc1ee">index</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="structChangeArgument.html#a96868c86c9e431cb1de82db35c097661">mode</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="structChangeArgument.html#afbe443c6700173c8963c49d179624535">rate</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno"><a class="line" href="structChangeArgument.html#a2cbdb96f16114b3627e35af740ac9da2">  652</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="structChangeArgument.html#a2cbdb96f16114b3627e35af740ac9da2">readData</a>(std::ifstream&amp; fin) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        fin&gt;&gt;<a class="code" href="structChangeArgument.html#a0e70284724e4d9cd487e9c95bffbc1ee">index</a>&gt;&gt;<a class="code" href="structChangeArgument.html#a96868c86c9e431cb1de82db35c097661">mode</a>&gt;&gt;<a class="code" href="structChangeArgument.html#afbe443c6700173c8963c49d179624535">rate</a>;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;};</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="classGalpyManager.html">  658</a></span>&#160;<span class="keyword">class </span><a class="code" href="classGalpyManager.html">GalpyManager</a>{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tstream&gt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordtype">void</span> labelCheck(Tstream&amp; <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* match) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        std::string label;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;label;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">if</span> (label!=match) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: reading label error, should be &quot;</span>&lt;&lt;match&lt;&lt;<span class="stringliteral">&quot; given &quot;</span>&lt;&lt;label&lt;&lt;std::endl;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            abort();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordtype">void</span> eofCheck(std::ifstream&amp; <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="keyword">const</span> <span class="keywordtype">char</span>* message) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.eof()) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: reading &quot;</span>&lt;&lt;message&lt;&lt;<span class="stringliteral">&quot; fails! File reaches EOF.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            abort();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordtype">void</span> gtZeroCheck(<span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">char</span>* message) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">if</span> (n&lt;=0) {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: &quot;</span>&lt;&lt;message&lt;&lt;<span class="stringliteral">&quot; &lt;=0!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            abort();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    }</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordtype">void</span> geZeroCheck(<span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">char</span>* message) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">if</span> (n&lt;0) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: &quot;</span>&lt;&lt;message&lt;&lt;<span class="stringliteral">&quot; &lt;0!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;            abort();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> ttype&gt;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordtype">void</span> resizeArray(<span class="keyword">const</span> <span class="keywordtype">int</span> n_diff, <span class="keyword">const</span> <span class="keywordtype">int</span> index, std::vector&lt;ttype&gt;&amp; array, std::vector&lt;int&gt;&amp; array_offset) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordtype">int</span> offset = array_offset[index];</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">if</span> (n_diff!=0) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            <span class="keywordflow">if</span> (n_diff&gt;0) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                std::vector&lt;ttype&gt; data(n_diff,ttype());</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                array.insert(array.begin()+offset, data.begin(), data.end());</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                array.erase(array.begin()+offset, array.begin()+offset-n_diff);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=index+1; i&lt;array_offset.size(); i++) </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                array_offset[i] += n_diff;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> ttype&gt;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordtype">void</span> eraseArray(<span class="keyword">const</span> <span class="keywordtype">int</span> index, std::vector&lt;ttype&gt;&amp; array, std::vector&lt;int&gt;&amp; array_offset) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordtype">int</span> n = array_offset[index+1] - array_offset[index];</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <span class="keywordtype">int</span> offset = array_offset[index];</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">if</span> (n&gt;0) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;            array.erase(array.begin()+offset, array.begin()+offset+n);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=index+1; i&lt;array_offset.size(); i++) </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            array_offset[i] = array_offset[i+1]-n;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        array_offset.pop_back();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        assert(array_offset.back()==<span class="keywordtype">int</span>(array.size()));</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="comment">// for MPI communication, data IO and initialization</span></div>
<div class="line"><a name="l00737"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">  737</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>; <span class="comment">//  set offset</span></div>
<div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">  738</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>;    <span class="comment">// types for each set</span></div>
<div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">  739</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>; <span class="comment">// arguments of pot for each set</span></div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">  740</a></span>&#160;    std::vector&lt;double&gt; <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>;    <span class="comment">// set offset</span></div>
<div class="line"><a name="l00741"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">  741</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a>;   <span class="comment">// current time, update in evolveChangingArguments</span></div>
<div class="line"><a name="l00742"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">  742</a></span>&#160;    std::vector&lt;ChangeArgument&gt; <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>;  <span class="comment">// changing argument index to evolve</span></div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">  743</a></span>&#160;    std::vector&lt;int&gt; <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>; <span class="comment">// set offset</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <span class="comment">// galpy potential arguments</span></div>
<div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">  745</a></span>&#160;    std::vector&lt;PotentialSetPar&gt; <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>; <span class="comment">// potential parameters for each set</span></div>
<div class="line"><a name="l00746"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">  746</a></span>&#160;    std::vector&lt;PotentialSet&gt; <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>; <span class="comment">// potential arguments for each set</span></div>
<div class="line"><a name="l00747"></a><span class="lineno"><a class="line" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">  747</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="comment">// unit scaling</span></div>
<div class="line"><a name="l00749"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">  749</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno"><a class="line" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">  750</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">  751</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">  752</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">fscale</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">  753</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">pscale</a>;</div>
<div class="line"><a name="l00754"></a><span class="lineno"><a class="line" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">  754</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">gmscale</a>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// IO</span></div>
<div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">  756</a></span>&#160;    std::ifstream <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>;</div>
<div class="line"><a name="l00757"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">  757</a></span>&#160;    std::string <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>;</div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">  758</a></span>&#160;    std::string <a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="comment">// evolving Milkyway potential</span></div>
<div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">  760</a></span>&#160;    <a class="code" href="classMWPotentialEvolve.html">MWPotentialEvolve</a> <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno"><a class="line" href="classGalpyManager.html#ae2744681ee872cd102142706394a3f55">  762</a></span>&#160;    <a class="code" href="classGalpyManager.html#ae2744681ee872cd102142706394a3f55">GalpyManager</a>(): <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>(), <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>(), </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                    <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>(), <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>(), <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>(), <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>(),</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>(), <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>(), <a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>(0.0), <a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>(1.0), <a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>(1.0), <a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>(1.0), <a class="code" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">fscale</a>(1.0), <a class="code" href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">pscale</a>(1.0), <a class="code" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">gmscale</a>(1.0), <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>(), <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>(), <a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a>(), <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>() {}</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">  767</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">printData</a>(std::ostream&amp; fout) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Galpy parameters, time: &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot; Next update time: &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        fout&lt;&lt;std::endl;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keywordtype">int</span> nset = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nset; k++) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <span class="keyword">auto</span>&amp; pot_set_par_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            fout&lt;&lt;<span class="stringliteral">&quot;Potential set &quot;</span>&lt;&lt;k+1&lt;&lt;<span class="stringliteral">&quot; Mode: &quot;</span>&lt;&lt;pot_set_par_k.mode</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                &lt;&lt;<span class="stringliteral">&quot; GM: &quot;</span>&lt;&lt;pot_set_par_k.gm</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                &lt;&lt;<span class="stringliteral">&quot; Pos: &quot;</span>&lt;&lt;pot_set_par_k.pos[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pot_set_par_k.pos[1]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pot_set_par_k.pos[2]</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                &lt;&lt;<span class="stringliteral">&quot; Vel: &quot;</span>&lt;&lt;pot_set_par_k.vel[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pot_set_par_k.vel[1]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pot_set_par_k.vel[2]</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                &lt;&lt;<span class="stringliteral">&quot; Acc: &quot;</span>&lt;&lt;pot_set_par_k.acc[0]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pot_set_par_k.acc[1]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;pot_set_par_k.acc[2]</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                &lt;&lt;<span class="stringliteral">&quot;\nPotential type indice: &quot;</span>;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k]; i&lt;<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k+1]; i++) </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                fout&lt;&lt;<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            fout&lt;&lt;<span class="stringliteral">&quot;\nPotential arguments: &quot;</span>;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[k]; i&lt;<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[k+1]; i++) </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                fout&lt;&lt;<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            fout&lt;&lt;<span class="stringliteral">&quot;\nChange argument [index mode rate]:&quot;</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[k]; i&lt;<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[k+1]; i++) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                fout&lt;&lt;<span class="stringliteral">&quot;[&quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[i].index</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[i].mode</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                    &lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[i].rate&lt;&lt;<span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            fout&lt;&lt;std::endl;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;MWPotentialEvolve&quot;</span>) </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                fout&lt;&lt;<span class="stringliteral">&quot;Scale factor a: &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        }</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    }        </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordtype">void</span> broadcastDataMPI() {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordtype">int</span> nset;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordtype">int</span> my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) nset = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size();</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        PS::Comm::broadcast(&amp;nset, 1, 0);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="comment">// update potentials</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="keywordflow">if</span> (nset&gt;=0) {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            PS::Comm::broadcast(&amp;<a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>, 1, 0);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.size()==nset+1);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.size()==nset+1);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.size()==nset+1);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.resize(nset);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.resize(nset+1);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.resize(nset+1);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.resize(nset+1);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.data(), <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(), 0);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.data(), <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.size(), 0);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.data(), <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.size(), 0);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.data(), <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.size(), 0);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size()==<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.back());</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size()==<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.back());</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size()==<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.back());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.resize(<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.back());</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.resize(<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.back());</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.resize(<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.back());</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.data(), <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size(), 0);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size()&gt;0) PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.data(), <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size(), 0);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size()&gt;0) PS::Comm::broadcast(<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.data(), <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size(), 0);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        }</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00852"></a><span class="lineno"><a class="line" href="classGalpyManager.html#ac6ce59845e4b863a3fce47c18e09631a">  852</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#ac6ce59845e4b863a3fce47c18e09631a">initial</a>(<span class="keyword">const</span> <a class="code" href="classIOParamsGalpy.html">IOParamsGalpy</a>&amp; _input, <span class="keyword">const</span> <span class="keywordtype">double</span> _time, <span class="keyword">const</span> std::string _conf_name, <span class="keyword">const</span> <span class="keywordtype">bool</span> _restart_flag, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="comment">// unit scale</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a> = _input.<a class="code" href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a> = _input.<a class="code" href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a> = <a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>/<a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <a class="code" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">fscale</a> = <a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>*<a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>/<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <a class="code" href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">pscale</a> = <a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>*<a class="code" href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">vscale</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        <a class="code" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">gmscale</a> = <a class="code" href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">pscale</a>*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="comment">// initial offset</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.push_back(0);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.push_back(0);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.push_back(0);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a> = _input.<a class="code" href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">pre_define_type</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        std::size_t ipar = <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>.find_first_of(<span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordflow">if</span> (ipar!=std::string::npos) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a> = <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>.substr(ipar+1);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a> = <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>.substr(0, ipar);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="comment">// if restart, read the configure file from _conf_name instead of _input.pre_define_type.</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> (_restart_flag) <a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a> = _conf_name;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;MWPotential2014&quot;</span>) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.emplace_back();</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <span class="keyword">auto</span>&amp; pot_set_par_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.back();</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            pot_set_par_k.setOrigin(0);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.insert(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.end(), {15,5,9});</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.push_back(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size());</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="comment">// Bovy unit</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="comment">//double pot_args[8] = {0.0299946, 1.8, 0.2375,  </span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="comment">//                      0.7574802, 0.375, 0.035, </span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <span class="comment">//                      4.85223053, 2.0};</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="comment">// Astro unit</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="comment">// PowerSphericalPotentialwithCutoff bulge </span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="comment">//   rho(r) = (3-a) G*M_g / (4 pi R_g^(3-a)) * (r_1/r)^a * exp ((-r/rc)^2)</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment">//      args(3): (3-a) G*M_g / (4 pi R_g^(3-a)), a, rc (r_1 = 1)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="comment">//      unit: GMscale/rscale^(3-a), 1, rscale</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="comment">// MiyamotoNagai disk</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">//   Phi(R,z) = -G*M_g / sqrt(R^2+(a+sqrt(z^2+b^2))^2)</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <span class="comment">//      args(3): G*M_g, a, b</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <span class="comment">//      unit: GMscale, rscale, rscale</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="comment">// NFW halo</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="comment">//   rho(r) = G*M_g /(4 pi a^3) * 1/((r/a)*(1+r/a)^2)</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <span class="comment">//      args(2): G*M_g, a</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            <span class="comment">//      unit: GMscale, rscale</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.insert(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.end(), {251.63858935563147, 1.8, 1899.9999999999998, </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                             306770418.38588977, 3000.0, 280.0,  </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                             1965095308.192175, 16000.0});</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.push_back(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size());</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; </div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.push_back(0);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="comment">// MWpotentialEvolve should be the first set</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;MWPotentialEvolve&quot;</span>) {</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordflow">if</span> (_restart_flag) </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#a61d78d2224231b9d052d48cdd2d38eaf">readDataFromFile</a>(<a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a>, _time);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#a45a7e51221c2de3937fcb72cd90fd11e">initialFromFile</a>(<a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a>, _time);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <a class="code" href="classGalpyManager.html#a3cf2c36189aa2bd879faf8748e1ef871">updateMWPotentialEvolve</a>(_time, _print_flag, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }        </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="comment">// add pre-defined type-argu groups</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        std::string type_args = _input.<a class="code" href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">type_args</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        <span class="comment">// Update types and arguments from type-args string</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="classGalpyManager.html#a0731140835f4392b060760a608e5e96d">addPotentialFromString</a>(type_args, <span class="keyword">true</span>, _print_flag);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="comment">// add type arguments from configure file if exist</span></div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="keywordflow">if</span> (_input.<a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>!=<span class="stringliteral">&quot;__NONE__&quot;</span>) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            <a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>=<span class="stringliteral">&quot;configure&quot;</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            <span class="keywordtype">int</span> my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.open(_input.<a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>.c_str(), std::ifstream::in);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.is_open()) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Galpy configure file &quot;</span>&lt;&lt;_input.<a class="code" href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">config_filename</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>.c_str()&lt;&lt;<span class="stringliteral">&quot; cannot be open!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                    abort();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Time&quot;</span>);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.eof()) <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.close();</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;<a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            PS::Comm::broadcast(&amp;<a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>, 1, 0);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="comment">// if restart, read configure file at the current time</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="keywordflow">if</span> (_restart_flag) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                <span class="comment">// first escape past time to avoid overwritting restart configure file</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                <a class="code" href="classGalpyManager.html#a912e9c5fc587218525f51a8b71e55735">updatePotentialFromFile</a>(_time, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                <a class="code" href="classGalpyManager.html#a75135e141ff8b0e37237aa2bd540d84a">readDataFromFile</a>(<a class="code" href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">set_parfile</a>, _print_flag);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <a class="code" href="classGalpyManager.html#a7e35973fb12c11ca65ca0d0462c6c4dd">updatePotentialSet</a>();</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">if</span>(_print_flag) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <a class="code" href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">printData</a>(std::cout);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;----- Finish initialize Galpy potential -----\n&quot;</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        }</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a7e35973fb12c11ca65ca0d0462c6c4dd">  969</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a7e35973fb12c11ca65ca0d0462c6c4dd">updatePotentialSet</a>() {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <a class="code" href="classGalpyManager.html#a5bc0d4b2e49875e6706fb03c4a11e9a2">freePotentialArgs</a>();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordtype">int</span> nset = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(); </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.resize(nset);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nset; k++) {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>[k].generatePotentialArgs(<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k+1]-<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k], &amp;(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k]]), &amp;(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[k]]));</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a0731140835f4392b060760a608e5e96d">  986</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classGalpyManager.html#a0731140835f4392b060760a608e5e96d">addPotentialFromString</a>(<span class="keyword">const</span> std::string&amp; _type_args, <span class="keyword">const</span> <span class="keywordtype">bool</span> _reset_flag, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag) {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">if</span> (_type_args!=<span class="stringliteral">&quot;__NONE__&quot;</span>) {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;            </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;            <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.emplace_back();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keyword">auto</span>&amp; pot_set_par_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.back();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            pot_set_par_k.setOrigin(0);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            std::vector&lt;std::string&gt; type_args_pair;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <span class="comment">// split type-arg groups</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            std::size_t istart = 0;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            std::size_t inext = _type_args.find_first_of(<span class="stringliteral">&quot;|&quot;</span>);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            <span class="keywordflow">while</span> (inext!=std::string::npos) {</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                type_args_pair.push_back(_type_args.substr(istart,inext-istart));</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                istart = inext+1;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                inext = _type_args.find_first_of(<span class="stringliteral">&quot;|&quot;</span>,istart);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;            }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordflow">if</span> (istart!=_type_args.size()) type_args_pair.push_back(_type_args.substr(istart));</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Galpy Potential combination list:\n&quot;</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="comment">// loop group</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;type_args_pair.size(); i++) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                <span class="comment">// get types</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                istart = 0;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                inext = type_args_pair[i].find_first_of(<span class="stringliteral">&quot;:&quot;</span>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <span class="keywordflow">if</span> (inext==std::string::npos) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: potential type index delimiter &#39;:&#39; is not found in input string &quot;</span>&lt;&lt;type_args_pair[i]&lt;&lt;std::endl;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    abort();</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                std::string type_str = type_args_pair[i].substr(0,inext);</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                std::string arg_str = type_args_pair[i].substr(inext+1);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                inext = type_str.find_first_of(<span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Type index: &quot;</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <span class="keywordflow">while</span> (inext!=std::string::npos) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                    <span class="keywordtype">int</span> type_i=std::stoi(type_str.substr(istart, inext-istart));</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                    <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.push_back(type_i);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                    <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;type_i&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    istart = inext+1;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                    inext = type_str.find_first_of(<span class="stringliteral">&quot;,&quot;</span>,istart);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                <span class="keywordflow">if</span> (istart!=type_str.size()) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    <span class="keywordtype">int</span> type_i=std::stoi(type_str.substr(istart));</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                    <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.push_back(type_i);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                    <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;type_i&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;args:&quot;</span>;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="comment">// get arguments</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                istart = 0;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                inext = arg_str.find_first_of(<span class="stringliteral">&quot;,&quot;</span>,istart);</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="keywordflow">while</span> (inext!=std::string::npos) {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                    <span class="keywordtype">double</span> arg_i = std::stod(arg_str.substr(istart, inext-istart));</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                    <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.push_back(arg_i);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                    <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;arg_i;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    istart = inext+1;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                    inext = arg_str.find_first_of(<span class="stringliteral">&quot;,&quot;</span>,istart);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                }</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                <span class="keywordflow">if</span>(istart!=arg_str.size()) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                    <span class="keywordtype">double</span> arg_i = std::stod(arg_str.substr(istart));</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                    <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.push_back(arg_i);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;arg_i;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.push_back(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size());</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.push_back(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size());</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.push_back(0);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        }</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    }</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a3cf2c36189aa2bd879faf8748e1ef871"> 1067</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classGalpyManager.html#a3cf2c36189aa2bd879faf8748e1ef871">updateMWPotentialEvolve</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _system_time, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag, <span class="keyword">const</span> <span class="keywordtype">bool</span> _initial_flag) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#a499debe349e3789cd6fbab95bc56dabb">calcMWPotentialParameters</a>(_system_time);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keyword">auto</span>&amp; mwpot = <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">now</a>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordtype">double</span> pot_arg_mw[8] = {mwpot.<a class="code" href="classMWPotentialEvolve.html#a2f837fbca88ad8eb1df5325f12926c11">grho_bulge</a>*<a class="code" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">gmscale</a>, mwpot.alpha_bulge, mwpot.rcut_bulge*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>,</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                            mwpot.gm_disk*<a class="code" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">gmscale</a>, mwpot.ra_disk*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>, mwpot.rb_disk*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>,</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                            mwpot.gm_halo*<a class="code" href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">gmscale</a>, mwpot.rs_halo*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>};</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">if</span> (_initial_flag) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.emplace_back();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keyword">auto</span>&amp; pot_set_par_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.back();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;            pot_set_par_k.setOrigin(0);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;            <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.insert(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.end(), {15,5,9});</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.push_back(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size());</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.insert(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.end(), pot_arg_mw, pot_arg_mw+8);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;            <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.push_back(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size());</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.push_back(0);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            assert(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[0]==15);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            assert(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[1]==5);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            assert(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[2]==9);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[i] = pot_arg_mw[i];</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">if</span> (_print_flag) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            std::cout&lt;&lt;std::setprecision(14)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; Evolve MilkyWay potential: FRW a: &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">a</a></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; NFW Halo: M_vir[Msun]: &quot;</span>&lt;&lt;mwpot.m_vir_halo&lt;&lt;<span class="stringliteral">&quot; R_vir[pc]: &quot;</span>&lt;&lt;mwpot.r_vir_halo&lt;&lt;std::endl;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        }</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160; </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a912e9c5fc587218525f51a8b71e55735"> 1111</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classGalpyManager.html#a912e9c5fc587218525f51a8b71e55735">updatePotentialFromFile</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _system_time, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordtype">double</span> time_scaled= _system_time*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordtype">int</span> nset=-1;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordtype">int</span> my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.is_open())  {</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="keywordflow">if</span> (time_scaled&gt;=<a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a>) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                    <span class="keywordtype">double</span> update_time_next;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                    <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                        labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Task&quot;</span>);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                        std::string task;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;task;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;task&quot;</span>);                                             <span class="keywordtype">int</span> n_set_old = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                        <span class="keywordflow">if</span> (task==<span class="stringliteral">&quot;add&quot;</span>) {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                            labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Nset&quot;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                            <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;nset;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                            eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of new potential sets&quot;</span>);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                            gtZeroCheck(nset, <span class="stringliteral">&quot;number of new potential sets&quot;</span>);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160; </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nset; k++) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                                <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.push_back(<a class="code" href="structPotentialSetPar.html">PotentialSetPar</a>());</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                <span class="keyword">auto</span>&amp; pot_set_par_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.back();</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                                <span class="comment">// set </span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Set&quot;</span>);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                <span class="keywordtype">int</span> set_index;</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;set_index;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;set index&quot;</span>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                <span class="keywordflow">if</span> (set_index!=k) {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: reading set index not match the expected one, should be &quot;</span>&lt;&lt;k&lt;&lt;<span class="stringliteral">&quot; given &quot;</span>&lt;&lt;set_index&lt;&lt;std::endl;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                    abort();</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                                }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                                <span class="comment">// Ntype</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Ntype&quot;</span>);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                                <span class="keywordtype">int</span> n_pot_k=-1;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;n_pot_k;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of potential types&quot;</span>);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                gtZeroCheck(n_pot_k, <span class="stringliteral">&quot;number of potential types&quot;</span>);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                                <span class="comment">// mode</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                                <span class="keywordtype">int</span> mode_k;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;mode_k;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;mode&quot;</span>);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                                <span class="keywordflow">if</span> (mode_k&lt;0 || mode_k&gt;2) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: mode should be 0, 1, 2, given &quot;</span>&lt;&lt;mode_k&lt;&lt;std::endl;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;                                    abort();</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                                }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                                pot_set_par_k.mode = mode_k;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160; </div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                                <span class="comment">// Mass</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;GM&quot;</span>);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;pot_set_par_k.gm;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;g*m&quot;</span>);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                                <span class="comment">// Pos</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Pos&quot;</span>);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) fconf&gt;&gt;pot_set_par_k.pos[j];</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;position&quot;</span>);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                <span class="comment">// Vel</span></div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Vel&quot;</span>);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) fconf&gt;&gt;pot_set_par_k.vel[j];</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                                <span class="comment">// type, arg and change_args are not directly save to potential set because of MPI communication</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                                <span class="comment">// types</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Type&quot;</span>);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_pot_k; i++) {</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                    <span class="keywordtype">int</span> type_i;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                                    <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;type_i;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                                    eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;potential type&quot;</span>);</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                                    <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.push_back(type_i);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.push_back(<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size());</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                <span class="comment">// arguments</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                std::string line;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                std::getline(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, line); <span class="comment">// skip 2nd line</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                                std::getline(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, line);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                std::istringstream fin(line);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                                <span class="keywordtype">double</span> arg_i;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                <span class="keywordtype">int</span> n_arg=0;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                labelCheck(fin, <span class="stringliteral">&quot;Arg&quot;</span>);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                <span class="keywordflow">while</span> (fin&gt;&gt;arg_i) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                    <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.push_back(arg_i);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                                    n_arg++;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.push_back(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size());</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                                <span class="comment">// time-dependent arguments</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Nchange&quot;</span>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                                <span class="keywordtype">int</span> n_change;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;n_change;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of changing arguments&quot;</span>);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                                geZeroCheck(n_change, <span class="stringliteral">&quot;number of changing arguments&quot;</span>);</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                <span class="keywordtype">int</span> offset = <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size();</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                <span class="keywordflow">if</span> (n_change&gt;0) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                                    <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.resize(offset+n_change);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Index&quot;</span>);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_change; i++) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                        <span class="keywordtype">int</span> index_i;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;index_i;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;index of the changing argument&quot;</span>);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                        <span class="keywordflow">if</span> (index_i&lt;-1 || index_i&gt;=n_arg) {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: index of the changing argument should be &gt;=-1 and &lt;&quot;</span>&lt;&lt;n_arg&lt;&lt;<span class="stringliteral">&quot;, given &quot;</span>&lt;&lt;index_i&lt;&lt;std::endl;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                                            abort();</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                                        }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                                        <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[offset+i].index = index_i;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                    }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;ChangeMode&quot;</span>);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_change; i++) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                        <span class="keywordtype">int</span> change_mode_i;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;change_mode_i;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;changing mode&quot;</span>);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                        <span class="keywordflow">if</span> (!(change_mode_i==1||change_mode_i==2)) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: change mode must be 1 or 2, given &quot;</span>&lt;&lt;change_mode_i&lt;&lt;std::endl;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                            abort();</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                        }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                        <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[offset+i].mode = change_mode_i;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                                    }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;ChangeRate&quot;</span>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_change; i++) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                        <span class="keywordtype">double</span> rate_i;</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;rate_i;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;changing rate&quot;</span>);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                        <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[offset+i].rate = rate_i;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                                    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                                }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                                <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.push_back(<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size());</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                            }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                            nset += n_set_old;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                        }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (task==<span class="stringliteral">&quot;update&quot;</span>) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                            labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Nset&quot;</span>);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                            <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;nset;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                            eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of update potential sets&quot;</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                            gtZeroCheck(nset, <span class="stringliteral">&quot;number of update potential sets&quot;</span>);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nset; i++) {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                <span class="comment">// set </span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Set&quot;</span>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                                <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;k;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;set index&quot;</span>);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                                <span class="keywordflow">if</span> (k&lt;0 || k&gt;=n_set_old) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: changing set index incorrect, should be from 0 to &quot;</span>&lt;&lt;n_set_old-1&lt;&lt;<span class="stringliteral">&quot;, given &quot;</span>&lt;&lt;k&lt;&lt;std::endl;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                    abort();</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                                }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                                <span class="keyword">auto</span>&amp; pot_set_par_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k];</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                <span class="comment">// Ntype</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Ntype&quot;</span>);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                                <span class="keywordtype">int</span> n_pot_k=-1;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;n_pot_k;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of potential types&quot;</span>);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                                gtZeroCheck(n_pot_k, <span class="stringliteral">&quot;number of potential types&quot;</span>);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                                <span class="comment">// mode</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Mode&quot;</span>);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                <span class="keywordtype">int</span> mode_k;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;mode_k;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;mode&quot;</span>);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                                <span class="keywordflow">if</span> (mode_k&lt;-2 || mode_k==-1 || mode_k&gt;2) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                                    std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: mode should be 0, 1, 2 or -2, given &quot;</span>&lt;&lt;mode_k&lt;&lt;std::endl;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                    abort();</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                                }</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                <span class="comment">// mass</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;GM&quot;</span>);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;pot_set_par_k.gm;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;gm&quot;</span>);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                <span class="comment">// update position and velocity for mode 2</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                <span class="keywordflow">if</span> (mode_k!=-2) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Pos&quot;</span>);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) fconf&gt;&gt;pot_set_par_k.pos[j];</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                    eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;position&quot;</span>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Vel&quot;</span>);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) fconf&gt;&gt;pot_set_par_k.vel[j];</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                    eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                                }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                    <span class="keywordtype">double</span> dtmp;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Pos&quot;</span>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) fconf&gt;&gt;dtmp;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                    eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;position&quot;</span>);</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Vel&quot;</span>);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;3; j++) fconf&gt;&gt;dtmp;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                    eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                                    mode_k = 2;</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                                }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                pot_set_par_k.mode = mode_k;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                <span class="comment">// types</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                                <span class="comment">// modify array offset if number of pot in the set changes</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                                <span class="keywordtype">int</span> n_pot_diff = n_pot_k - (<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k+1]-<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k]);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                                resizeArray(n_pot_diff, k, <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>, <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                <span class="keywordtype">int</span> offset = <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[k];</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                                </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Type&quot;</span>);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n_pot_k; j++) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                                    <span class="keywordtype">int</span> type_j;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                                    <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;type_j;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                                    eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;potential type&quot;</span>);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                    <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[offset+j] = type_j;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                                }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                                <span class="comment">// arguments</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                                std::string line;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                                std::getline(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, line); <span class="comment">// skip 2nd line</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                                std::getline(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, line);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                                std::istringstream fin(line);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                                labelCheck(fin, <span class="stringliteral">&quot;Arg&quot;</span>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                std::vector&lt;double&gt; arg_k;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                <span class="keywordtype">double</span> arg_tmp;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                <span class="keywordflow">while</span> (fin&gt;&gt;arg_tmp) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                    arg_k.push_back(arg_tmp);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                }</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                <span class="keywordtype">int</span> n_arg_diff = int(arg_k.size()) - (<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[k+1] - <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[k]);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                resizeArray(n_arg_diff, k, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>, <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                offset = <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[k];</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j&lt;arg_k.size(); j++) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                    <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[offset+j] = arg_k[j];</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                                }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                <span class="comment">// time-dependent arguments</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Nchange&quot;</span>);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                <span class="keywordtype">int</span> n_change;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;n_change;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of changing arguments&quot;</span>);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                geZeroCheck(n_change, <span class="stringliteral">&quot;changing arguments&quot;</span>);</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                <span class="keywordtype">int</span> n_change_diff = n_change - (<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[k+1] - <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[k]);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160; </div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                resizeArray(n_change_diff, k, <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>, <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                <span class="keywordflow">if</span> (n_change&gt;0) {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                    offset = <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[k];</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Index&quot;</span>);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n_change; j++) {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                        <span class="keywordtype">int</span> index_j;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;index_j;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;index of the changing argument&quot;</span>);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                                        <span class="keywordflow">if</span> (index_j&lt;-1 || index_j&gt;=<span class="keywordtype">int</span>(arg_k.size())) {</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: index of the changing argument should be &gt;=-1 and &lt;&quot;</span>&lt;&lt;(arg_k.size())&lt;&lt;<span class="stringliteral">&quot;, given &quot;</span>&lt;&lt;index_j&lt;&lt;std::endl;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                            abort();</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                        }</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                        <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[offset+j].index = index_j;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                    }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;ChangeMode&quot;</span>);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n_change; j++) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                        <span class="keywordtype">int</span> change_mode_j;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;change_mode_j;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;changing mode&quot;</span>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                                        <span class="keywordflow">if</span> (!(change_mode_j==1||change_mode_j==2)) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;                                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: change mode must be 1 or 2, given &quot;</span>&lt;&lt;change_mode_j&lt;&lt;std::endl;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;                                            abort();</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                                        }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                                        <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[offset+j].mode = change_mode_j;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                                    }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                                    labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;ChangeRate&quot;</span>);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;n_change; j++) {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                                        <span class="keywordtype">double</span> rate_j;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;rate_j;</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                                        eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;changing rate&quot;</span>);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                                        <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[offset+j].rate = rate_j;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                    }                                    </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                }</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                            }</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                            nset = n_set_old;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                        }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (task==<span class="stringliteral">&quot;remove&quot;</span>) {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                            labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Nset&quot;</span>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                            <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;nset;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                            eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;number of removing potential sets&quot;</span>);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                            gtZeroCheck(nset, <span class="stringliteral">&quot;number of removing potential sets&quot;</span>);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                            labelCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;Index&quot;</span>);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                            std::vector&lt;int&gt; rm_indices;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nset; i++) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                                <span class="keywordtype">int</span> k;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;k;</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                eofCheck(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>, <span class="stringliteral">&quot;removing set index&quot;</span>);</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                rm_indices.push_back(k);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                            }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                            std::sort(rm_indices.begin(), rm_indices.end());</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nset; i++) {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                <span class="keywordtype">int</span> idel = rm_indices[i]-i; <span class="comment">// each time of remove, the following indices reduce by one, total reducing number is i</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                                <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.erase(<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.begin()+idel);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                                eraseArray(idel, <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>, <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                                eraseArray(idel, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>, <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                                eraseArray(idel, <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>, <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                            }</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                            nset = n_set_old - nset;</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                            geZeroCheck(nset, <span class="stringliteral">&quot;number of potential sets after remove&quot;</span>);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                        }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: Task must be add, update or remove, given &quot;</span>&lt;&lt;task&lt;&lt;std::endl;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                            abort();</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                        }</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                        std::string label;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;label;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                        <span class="keywordflow">if</span>(<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.eof()) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                            <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.close();</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                        }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                        <span class="keywordflow">if</span>(label!=<span class="stringliteral">&quot;Time&quot;</span>) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                            std::cerr&lt;&lt;<span class="stringliteral">&quot;Galpy config: reading label error, should be Time given &quot;</span>&lt;&lt;label&lt;&lt;std::endl;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                            abort();</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                        }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                        <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>&gt;&gt;update_time_next;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                        <span class="keywordflow">if</span> (update_time_next&gt;time_scaled) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            <a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a> = update_time_next;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                        }</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                    };</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                }</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        broadcastDataMPI();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        PS::Comm::broadcast(&amp;nset, 1, 0);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="preprocessor">#endif        </span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">return</span> (nset&gt;=0);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a2b9c41229c1b4a6d5c06e18017298357"> 1443</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a2b9c41229c1b4a6d5c06e18017298357">updatePotential</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _system_time, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordtype">int</span> nset = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size();</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.size()==nset+1);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.size()==nset+1);</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.size()==nset+1);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size()==<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.back());</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size()==<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.back());</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        assert((<span class="keywordtype">int</span>)<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size()==<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.back());</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordtype">bool</span> update_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;MWPotentialEvolve&quot;</span>) {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            update_flag = <a class="code" href="classGalpyManager.html#a3cf2c36189aa2bd879faf8748e1ef871">updateMWPotentialEvolve</a>(_system_time, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        }</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;configure&quot;</span>) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            update_flag = <a class="code" href="classGalpyManager.html#a912e9c5fc587218525f51a8b71e55735">updatePotentialFromFile</a>(_system_time, _print_flag);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="comment">// update time-dependent argument</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <span class="keywordtype">bool</span> change_flag = <a class="code" href="classGalpyManager.html#a1b5f2eebb24a0690e4b168c79bada7b8">evolveChangingArguments</a>(_system_time*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="keywordflow">if</span> (update_flag &amp;&amp; _print_flag) <a class="code" href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">printData</a>(std::cout);</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            update_flag = (update_flag || change_flag);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;        <span class="comment">// generate galpy potential argument </span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="keywordflow">if</span> (update_flag) <a class="code" href="classGalpyManager.html#a7e35973fb12c11ca65ca0d0462c6c4dd">updatePotentialSet</a>();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    }</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a84d80784f5da870ff86d61bf29eb98d1"> 1474</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a84d80784f5da870ff86d61bf29eb98d1">writePotentialPars</a>(<span class="keyword">const</span> std::string&amp; _filename, <span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _system_time) {</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;MWPotentialEvolve&quot;</span>) {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;            assert(<a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">frw</a>.<a class="code" href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">time</a>==_system_time);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            <a class="code" href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">mw_evolve</a>.<a class="code" href="classMWPotentialEvolve.html#a92e616d63b989428e6424e0d0180de7c">writeDataToFile</a>(_filename);</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">set_name</a>==<span class="stringliteral">&quot;configure&quot;</span>) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;            assert(<a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a>==_system_time*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <a class="code" href="classGalpyManager.html#aa1e9c6eb40673066e5a7ee87d5a2e641">writeDataToFile</a>(_filename);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    }</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a982ceeab737762887eec4a15035fc594"> 1486</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a982ceeab737762887eec4a15035fc594">printReference</a>(std::ostream &amp; fout, <span class="keyword">const</span> <span class="keywordtype">int</span> offset=4) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;offset; i++) fout&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Galpy: Bovy J., 2015, ApJS, 216, 29&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    }    </div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"><a class="line" href="classGalpyManager.html#accd0a3c5a62b628e4a9e002f8ec10ad4"> 1492</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#accd0a3c5a62b628e4a9e002f8ec10ad4">resetPotAcc</a>() {</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k=0; k&lt;<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(); k++) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordtype">double</span>* acc_pot = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].acc;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            acc_pot[0] = acc_pot[1] = acc_pot[2] = 0.0;</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        }        </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"><a class="line" href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da"> 1503</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da">kickMovePot</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>) {</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="keywordtype">double</span> dt_scale = <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>;</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k=0; k&lt;<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(); k++) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            <span class="keywordtype">int</span> mode_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].mode;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            assert(mode_k&gt;=0||mode_k&lt;=2);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            <span class="keywordflow">if</span> (mode_k==2) {</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                <span class="keywordtype">double</span>* vel_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].vel;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                <span class="keywordtype">double</span>* acc_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].acc;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                vel_k[0] += acc_k[0]*dt_scale;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                vel_k[1] += acc_k[1]*dt_scale;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                vel_k[2] += acc_k[2]*dt_scale;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            }        </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a56875a530c45fac6439a6d6d4f671b3d"> 1522</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a56875a530c45fac6439a6d6d4f671b3d">driftMovePot</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        <span class="keywordtype">double</span> dt_scale = <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k=0; k&lt;<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(); k++) {</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;            <span class="keywordtype">int</span> mode_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].mode;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;            assert(mode_k&gt;=0||mode_k&lt;=2);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;            <span class="keywordflow">if</span> (mode_k==2) {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="keywordtype">double</span>* vel_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].vel;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                <span class="keywordtype">double</span>* pos_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].pos;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                pos_k[0] += vel_k[0]*dt_scale;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                pos_k[1] += vel_k[1]*dt_scale;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                pos_k[2] += vel_k[2]*dt_scale;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            }        </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a60bef4e78023b1dc281e6cb2cffd813e"> 1543</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a60bef4e78023b1dc281e6cb2cffd813e">calcMovePotAccFromPot</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _time, <span class="keyword">const</span> <span class="keywordtype">double</span>* pos_pcm) {</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        assert(<a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.size()==<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size());</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        <span class="keywordtype">double</span> t = _time*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k=0; k&lt;<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(); k++) {</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            <span class="keywordtype">int</span> mode_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].mode;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            assert(mode_k&gt;=0||mode_k&lt;=2);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            <span class="keywordflow">if</span> (mode_k==2) {</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                <span class="keywordtype">double</span>* pos_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].pos; <span class="comment">// galactic frame</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;                <span class="keywordtype">double</span>* acc_pot = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].acc;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j=0; j&lt;<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size(); j++) {</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                    <span class="keywordflow">if</span> (k==j) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;                    <span class="keywordtype">int</span> mode_j = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[j].mode;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;                    <span class="keywordtype">double</span>* pos_j = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[j].pos;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                    <span class="keywordtype">double</span> dx,dy,dz;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                    <span class="keywordflow">if</span> (mode_j==1) {</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                        <span class="comment">// should be consistent in galactic frame</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                        dx = pos_k[0]-pos_j[0]-pos_pcm[0];</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                        dy = pos_k[1]-pos_j[1]-pos_pcm[1];</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                        dz = pos_k[2]-pos_j[2]-pos_pcm[2];</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                    }</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                        dx = pos_k[0]-pos_j[0];</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                        dy = pos_k[1]-pos_j[1];</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                        dz = pos_k[2]-pos_j[2];</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                    }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                    <span class="keywordtype">double</span> rxy= std::sqrt(dx*dx+dy*dy);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;                    <span class="comment">//double phi= std::acos(dx/rxy);</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                    <span class="keywordtype">double</span> phi= std::atan2(dy, dx);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                    <span class="keywordtype">double</span> sinphi = dy/rxy;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                    <span class="keywordtype">double</span> cosphi = dx/rxy;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                    <span class="keyword">auto</span>&amp; <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a> = <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>[j].arguments;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                    <span class="keywordtype">int</span> npot = <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>[j].npot;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                    <span class="keywordtype">double</span> acc_rxy = calcRforce(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                    <span class="keywordtype">double</span> acc_z   = calczforce(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="preprocessor">#if (defined GALPY_VERSION_1_7_9) || (defined GALPY_VERSION_1_7_1)</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                    <span class="keywordtype">double</span> acc_phi = calcPhiforce(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                    <span class="keywordtype">double</span> acc_phi = calcphitorque(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;                    <span class="keywordflow">if</span> (rxy&gt;0.0) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;                        acc_pot[0] += (cosphi*acc_rxy - sinphi*acc_phi/rxy);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;                        acc_pot[1] += (sinphi*acc_rxy + cosphi*acc_phi/rxy);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                        acc_pot[2] += acc_z;</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                    }</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                }</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;            }</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        }</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    }</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"><a class="line" href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824"> 1603</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824">calcAccPot</a>(<span class="keywordtype">double</span>* acc, <span class="keywordtype">double</span>&amp; pot, <span class="keyword">const</span> <span class="keywordtype">double</span> _time, <span class="keyword">const</span> <span class="keywordtype">double</span> gm, <span class="keyword">const</span> <span class="keywordtype">double</span>* pos_g, <span class="keyword">const</span> <span class="keywordtype">double</span>* pos_l) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        assert(<a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.size()==<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size());</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        <span class="keywordtype">int</span> nset = <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.size();</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keywordflow">if</span> (nset&gt;0) {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="keywordtype">double</span> t = _time*<a class="code" href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">tscale</a>;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="comment">// galactic frame and rest frame of particle system</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;            <span class="keywordtype">double</span> x[2] = {pos_g[0]*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>, pos_l[0]*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>};</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="keywordtype">double</span> y[2] = {pos_g[1]*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>, pos_l[1]*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>};</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="keywordtype">double</span> z[2] = {pos_g[2]*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>, pos_l[2]*<a class="code" href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">rscale</a>};</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            pot = 0;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            acc[0] = acc[1] = acc[2] = 0.0;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nset; k++) {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                <span class="keywordtype">int</span> mode_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].mode;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                assert(mode_k&gt;=0||mode_k&lt;=2);</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                <span class="keywordtype">int</span> npot = <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>[k].npot;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                <span class="keywordtype">double</span>* pos_k = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].pos;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                <span class="keywordtype">int</span> i = (mode_k &amp; 1); <span class="comment">// get first bit to select frame (0: galactic; 1: rest)</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                <span class="comment">// frame is consistent </span></div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                <span class="keywordtype">double</span> dx = x[i]-pos_k[0];</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                <span class="keywordtype">double</span> dy = y[i]-pos_k[1];</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                <span class="keywordtype">double</span> dz = z[i]-pos_k[2];</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                <span class="keywordtype">double</span> rxy= std::sqrt(dx*dx+dy*dy);</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                <span class="keywordtype">double</span> phi= std::atan2(dy, dx);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                <span class="keywordtype">double</span> sinphi = dy/rxy;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                <span class="keywordtype">double</span> cosphi = dx/rxy;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                <span class="keyword">auto</span>&amp; <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a> = <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>[k].arguments;</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                <span class="keywordtype">double</span> acc_rxy = calcRforce(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                <span class="keywordtype">double</span> acc_z   = calczforce(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="preprocessor">#if (defined GALPY_VERSION_1_7_9) || (defined GALPY_VERSION_1_7_1)</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                <span class="keywordtype">double</span> acc_phi = calcPhiforce(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                <span class="keywordtype">double</span> acc_phi = calcphitorque(rxy, dz, phi, t, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="comment">//                double pot_i = evaluatePotentials(rxy, dz, phi, t, npot, pot_args);</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                <span class="keywordtype">double</span> pot_i = evaluatePotentials(rxy, dz, npot, <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                <span class="keywordtype">double</span> gm_pot = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].gm;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                <span class="keywordflow">if</span> (rxy&gt;0.0) {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                    assert(!std::isinf(acc_rxy));</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                    assert(!std::isnan(acc_rxy));</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                    assert(!std::isinf(acc_phi));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                    assert(!std::isnan(acc_phi));</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                    assert(!std::isinf(pot));</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                    assert(!std::isnan(pot));</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                    pot += pot_i;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                    <span class="keywordtype">double</span> acc_x = (cosphi*acc_rxy - sinphi*acc_phi/rxy);</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                    <span class="keywordtype">double</span> acc_y = (sinphi*acc_rxy + cosphi*acc_phi/rxy);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                    acc[0] += acc_x;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                    acc[1] += acc_y;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                    acc[2] += acc_z;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;                    <span class="keywordflow">if</span> (mode_k==2) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;                        <span class="keywordtype">double</span>* acc_pot = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[k].acc;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                        acc_pot[0] -= gm*acc_x/gm_pot; <span class="comment">// anti-acceleration to potential set origin</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                        acc_pot[1] -= gm*acc_y/gm_pot;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                        acc_pot[2] -= gm*acc_z/gm_pot;</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                    }</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;            }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            pot /= <a class="code" href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">pscale</a>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;            acc[0] /= <a class="code" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">fscale</a>;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            acc[1] /= <a class="code" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">fscale</a>;</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            acc[2] /= <a class="code" href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">fscale</a>;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="comment">//pot = acc[0]*x+acc[1]*y+acc[2]*z;</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        }</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            acc[0] = acc[1] = acc[2] = pot = 0.0;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        }</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    }</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160; </div>
<div class="line"><a name="l01693"></a><span class="lineno"><a class="line" href="classGalpyManager.html#aa1e9c6eb40673066e5a7ee87d5a2e641"> 1693</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#aa1e9c6eb40673066e5a7ee87d5a2e641">writeDataToFile</a>(<span class="keyword">const</span> std::string&amp; _filename) {</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        std::ofstream fout;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        fout.open(_filename.c_str(), std::ifstream::out);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;        <span class="keywordflow">if</span> (!fout.is_open()) {</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Galpy potential parameter file to write, &quot;</span>&lt;&lt;_filename&lt;&lt;<span class="stringliteral">&quot;, cannot be open!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;            abort();</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        fout&lt;&lt;std::setprecision(14);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160; </div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        std::size_t n_set = <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.size();</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        std::size_t <a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a> = <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.size();</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        std::size_t n_pot_offset = <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.size();</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        std::size_t n_arg = <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.size();</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        std::size_t n_arg_offset = <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.size();</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        std::size_t n_change = <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size();</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;        std::size_t n_change_offset = <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.size();</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        fout&lt;&lt;<a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            &lt;&lt;n_set&lt;&lt;<span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;            &lt;&lt;std::endl;</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_set; i++) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;            <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[i].writeData(fout);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;            fout&lt;&lt;std::endl;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        }</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        fout&lt;&lt;std::endl&lt;&lt;n_pot_offset&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_pot_offset; i++) {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;            fout&lt;&lt;<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        fout&lt;&lt;std::endl&lt;&lt;<a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>; i++) {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;            fout&lt;&lt;<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        }</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        fout&lt;&lt;std::endl&lt;&lt;n_arg_offset&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_arg_offset; i++) {</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            fout&lt;&lt;<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        fout&lt;&lt;std::endl&lt;&lt;n_arg&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_arg; i++) {</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;            fout&lt;&lt;<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        fout&lt;&lt;std::endl&lt;&lt;n_change_offset&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_change_offset; i++) {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            fout&lt;&lt;<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[i]&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        }</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        fout&lt;&lt;std::endl&lt;&lt;n_change&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_change; i++) {</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;            <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[i].writeData(fout);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        }</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        fout&lt;&lt;std::endl;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        fout.close();</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    }</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">      @param[in] _filename: file to save data</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">      @param[in] _print_flag: if true, print reading parameters</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a75135e141ff8b0e37237aa2bd540d84a"> 1750</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a75135e141ff8b0e37237aa2bd540d84a">readDataFromFile</a>(<span class="keyword">const</span> std::string&amp; _filename, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag) {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        std::size_t n_set, <a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>, n_pot_offset, n_arg, n_arg_offset, n_change, n_change_offset;</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keywordtype">int</span> my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160; </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;            std::ifstream fin;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;            fin.open(_filename.c_str(), std::ifstream::in);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;            <span class="keywordflow">if</span> (!fin.is_open()) {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: Galpy configure file for restart &quot;</span>&lt;&lt;_filename.c_str()&lt;&lt;<span class="stringliteral">&quot; cannot be open!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                abort();</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160; </div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            fin&gt;&gt;<a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a>&gt;&gt;n_set;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;time and number of potential sets&quot;</span>);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;            geZeroCheck(n_set, <span class="stringliteral">&quot;number of potential sets&quot;</span>);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>.resize(n_set);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_set; i++) {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;                <a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[i].readData(fin);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                eofCheck(fin, <span class="stringliteral">&quot;potential set parameter&quot;</span>);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            fin&gt;&gt;n_pot_offset;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            assert(n_pot_offset==n_set+1);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            <a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>.resize(n_pot_offset);</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_pot_offset; i++) {</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;                fin&gt;&gt;<a class="code" href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">pot_type_offset</a>[i];</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;potential type array offset&quot;</span>);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            fin&gt;&gt;<a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            geZeroCheck(<a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>, <span class="stringliteral">&quot;number of potential types&quot;</span>);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            <a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>.resize(<a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;<a class="code" href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">n_pot</a>; i++) {</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                fin&gt;&gt;<a class="code" href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">pot_type</a>[i];</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;potential type&quot;</span>);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160; </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            fin&gt;&gt;n_arg_offset;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>.resize(n_arg_offset);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            assert(n_arg_offset==n_set+1);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_arg_offset; i++) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;                fin&gt;&gt;<a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[i];</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;potential argument array offset&quot;</span>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160; </div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            fin&gt;&gt;n_arg;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            geZeroCheck(n_arg, <span class="stringliteral">&quot;number of potential arguments&quot;</span>);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>.resize(n_arg);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_arg; i++) {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;                fin&gt;&gt;<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[i];</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;potential arguments&quot;</span>);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;            fin&gt;&gt;n_change_offset;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.resize(n_change_offset);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            assert(n_change_offset==n_set+1);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_change_offset; i++) {</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                fin&gt;&gt;<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[i];</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;            }</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;changing argument offset&quot;</span>);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160; </div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            fin&gt;&gt;n_change;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            geZeroCheck(n_change, <span class="stringliteral">&quot;number of changing arguments&quot;</span>);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.resize(n_change);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_change; i++) {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[i].readData(fin);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            eofCheck(fin, <span class="stringliteral">&quot;changing arguments&quot;</span>);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            fin.close();</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        }</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; </div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        broadcastDataMPI();</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        <span class="keywordflow">if</span> (_print_flag) <a class="code" href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">printData</a>(std::cout);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160; </div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01843"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a1b5f2eebb24a0690e4b168c79bada7b8"> 1843</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classGalpyManager.html#a1b5f2eebb24a0690e4b168c79bada7b8">evolveChangingArguments</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>&amp; _time, <span class="keyword">const</span> <span class="keywordtype">bool</span> _print_flag) {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>.size()&gt;0) {</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <span class="keywordtype">double</span> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> = _time - <a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a>;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>&gt;0) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Galpy update argument, time [Galpy unit]: &quot;</span>&lt;&lt;_time&lt;&lt;<span class="stringliteral">&quot; dt: &quot;</span>&lt;&lt;<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                std::size_t n_set = <a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>.size()-1;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                <span class="keywordflow">for</span> (std::size_t i=0; i&lt;n_set; i++) {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[i]; k&lt;<a class="code" href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">change_args_offset</a>[i+1]; k++) {</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                        <span class="keywordtype">int</span> index_local = <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].index;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                        <span class="keywordtype">double</span>* change_arg_ptr = NULL;</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                        <span class="keywordflow">if</span> (index_local==-1)  <span class="comment">// change gm instead of arguments</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                            change_arg_ptr = &amp;(<a class="code" href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">pot_set_pars</a>[i].gm);</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                            <span class="keywordtype">int</span> index = index_local + <a class="code" href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">pot_args_offset</a>[i]; <span class="comment">// change args index counting for individual set, need to obtain the global index of pot_args.</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                            change_arg_ptr = &amp;(<a class="code" href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">pot_args</a>[index]);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                        }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].mode==1) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                            *change_arg_ptr += <a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].rate*<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                            <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Set &quot;</span>&lt;&lt;i+1&lt;&lt;<span class="stringliteral">&quot; Index: &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].index&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<span class="stringliteral">&quot; new_argument(linear): &quot;</span>&lt;&lt;*change_arg_ptr;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                        }</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].mode==2) {</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;                            *change_arg_ptr *= std::exp(<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].rate*<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;                            <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Set &quot;</span>&lt;&lt;i+1&lt;&lt;<span class="stringliteral">&quot; Index: &quot;</span>&lt;&lt;<a class="code" href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">change_args</a>[k].index&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;<span class="stringliteral">&quot; new_argument(exp): &quot;</span>&lt;&lt;*change_arg_ptr;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;                        }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;                        <span class="keywordflow">if</span> (_print_flag) std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;                    }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                <a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a> = _time;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;            }</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        }</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <a class="code" href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">time</a> = _time;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    }</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160; </div>
<div class="line"><a name="l01878"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a5bc0d4b2e49875e6706fb03c4a11e9a2"> 1878</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a5bc0d4b2e49875e6706fb03c4a11e9a2">freePotentialArgs</a>() {</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.empty()) {</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i=0; i&lt;<a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.size(); i++) <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>[i].<a class="code" href="classGalpyManager.html#a1b462774660dccb211b5845458c07eca">clear</a>();</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            <a class="code" href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">pot_sets</a>.resize(0);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"><a class="line" href="classGalpyManager.html#a1b462774660dccb211b5845458c07eca"> 1885</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classGalpyManager.html#a1b462774660dccb211b5845458c07eca">clear</a>() {</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <a class="code" href="classGalpyManager.html#a5bc0d4b2e49875e6706fb03c4a11e9a2">freePotentialArgs</a>();</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        <a class="code" href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">update_time</a> = 0;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.is_open()) <a class="code" href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">fconf</a>.close();</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    }</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"><a class="line" href="classGalpyManager.html#abb225b337233061de8ffff35e67a53dc"> 1891</a></span>&#160;    <a class="code" href="classGalpyManager.html#abb225b337233061de8ffff35e67a53dc">~GalpyManager</a>() {</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;        <a class="code" href="classGalpyManager.html#a1b462774660dccb211b5845458c07eca">clear</a>();</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    }</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;};</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructPotentialSetPar_html_ace80f33fd236b5337656fd92418f3c02"><div class="ttname"><a href="structPotentialSetPar.html#ace80f33fd236b5337656fd92418f3c02">PotentialSetPar::gm</a></div><div class="ttdeci">double gm</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:546</div></div>
<div class="ttc" id="astructPotentialSet_html_a7f9399c7c869e6cc0b5d50d121a4fcf9"><div class="ttname"><a href="structPotentialSet.html#a7f9399c7c869e6cc0b5d50d121a4fcf9">PotentialSet::npot</a></div><div class="ttdeci">int npot</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:603</div></div>
<div class="ttc" id="astructStatus_1_1ParticleCM_html_a99d597e173bd2de26a14e081e271003b"><div class="ttname"><a href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">Status::ParticleCM::vel</a></div><div class="ttdeci">PS::F64vec vel</div><div class="ttdef"><b>Definition:</b> status.hpp:21</div></div>
<div class="ttc" id="aclassGalpyManager_html_a2d2e5788c1a26a1d5790ced0b4ffc8e0"><div class="ttname"><a href="classGalpyManager.html#a2d2e5788c1a26a1d5790ced0b4ffc8e0">GalpyManager::pscale</a></div><div class="ttdeci">double pscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:753</div></div>
<div class="ttc" id="aclassFRWModel_html_a23ac3ceb2463ce13eeb101654179f746"><div class="ttname"><a href="classFRWModel.html#a23ac3ceb2463ce13eeb101654179f746">FRWModel::a</a></div><div class="ttdeci">double a</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:185</div></div>
<div class="ttc" id="aclassGalpyManager_html_a13b30c8bea8a66d38c8ec181ec562ac5"><div class="ttname"><a href="classGalpyManager.html#a13b30c8bea8a66d38c8ec181ec562ac5">GalpyManager::set_parfile</a></div><div class="ttdeci">std::string set_parfile</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:758</div></div>
<div class="ttc" id="aclassFileHeader_html_abf680d62b5f42ec965e1038ca3c7c01a"><div class="ttname"><a href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">FileHeader::n_body</a></div><div class="ttdeci">long long int n_body</div><div class="ttdef"><b>Definition:</b> io.hpp:213</div></div>
<div class="ttc" id="aclassGalpyManager_html_a75135e141ff8b0e37237aa2bd540d84a"><div class="ttname"><a href="classGalpyManager.html#a75135e141ff8b0e37237aa2bd540d84a">GalpyManager::readDataFromFile</a></div><div class="ttdeci">void readDataFromFile(const std::string &amp;_filename, const bool _print_flag)</div><div class="ttdoc">read configure data for restart</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1750</div></div>
<div class="ttc" id="aclassStatus_html_ab914306bf82dce98487573a9d4bce1a9"><div class="ttname"><a href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">Status::pcm</a></div><div class="ttdeci">struct Status::ParticleCM pcm</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_a2a02d2171807fc86754fa302c69b8ffa"><div class="ttname"><a href="classFileHeaderNoOffset.html#a2a02d2171807fc86754fa302c69b8ffa">FileHeaderNoOffset::nfile</a></div><div class="ttdeci">long long int nfile</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:47</div></div>
<div class="ttc" id="anamespacegalpy__help_html_ac4954a142666a4e3bd2d9a0736ce7644"><div class="ttname"><a href="namespacegalpy__help.html#ac4954a142666a4e3bd2d9a0736ce7644">galpy_help.n_pot</a></div><div class="ttdeci">n_pot</div><div class="ttdef"><b>Definition:</b> galpy_help.py:306</div></div>
<div class="ttc" id="aclassFPSoft_html"><div class="ttname"><a href="classFPSoft.html">FPSoft</a></div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:26</div></div>
<div class="ttc" id="anamespacegalpy__help_html_ade545cdf48fb2c183b34232c8ee12435"><div class="ttname"><a href="namespacegalpy__help.html#ade545cdf48fb2c183b34232c8ee12435">galpy_help.savePotTypeArg</a></div><div class="ttdeci">def savePotTypeArg(config_filename, n_pot, pot_type, pot_arg)</div><div class="ttdef"><b>Definition:</b> galpy_help.py:45</div></div>
<div class="ttc" id="astructChangeArgument_html_a96868c86c9e431cb1de82db35c097661"><div class="ttname"><a href="structChangeArgument.html#a96868c86c9e431cb1de82db35c097661">ChangeArgument::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:643</div></div>
<div class="ttc" id="aformat__transfer_8cxx_html_a10a10c3512c1f179be30181fdd3bc8b1"><div class="ttname"><a href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a></div><div class="ttdeci">PS::ParticleSystem&lt; FPSoft &gt; SystemSoft</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:8</div></div>
<div class="ttc" id="aclassGalpyManager_html_aaa6e343b822ffdcbfe3a8b6a95f2cfd5"><div class="ttname"><a href="classGalpyManager.html#aaa6e343b822ffdcbfe3a8b6a95f2cfd5">GalpyManager::fscale</a></div><div class="ttdeci">double fscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:752</div></div>
<div class="ttc" id="aformat__transfer_8cxx_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="format__transfer_8cxx.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:92</div></div>
<div class="ttc" id="aclassGalpyManager_html_a982ceeab737762887eec4a15035fc594"><div class="ttname"><a href="classGalpyManager.html#a982ceeab737762887eec4a15035fc594">GalpyManager::printReference</a></div><div class="ttdeci">static void printReference(std::ostream &amp;fout, const int offset=4)</div><div class="ttdoc">print reference to cite</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1486</div></div>
<div class="ttc" id="aclassGalpyManager_html_ac850c53c0b2b205b1d06b910f336cb7a"><div class="ttname"><a href="classGalpyManager.html#ac850c53c0b2b205b1d06b910f336cb7a">GalpyManager::pot_set_pars</a></div><div class="ttdeci">std::vector&lt; PotentialSetPar &gt; pot_set_pars</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:745</div></div>
<div class="ttc" id="astructIOParams_html_a2fa82cf43f6b5395becdfc7ebed1839e"><div class="ttname"><a href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">IOParams::value</a></div><div class="ttdeci">Type value</div><div class="ttdef"><b>Definition:</b> io.hpp:43</div></div>
<div class="ttc" id="astructPotentialSetPar_html_aac32fbd553d79f6e8036db40cb603ad6"><div class="ttname"><a href="structPotentialSetPar.html#aac32fbd553d79f6e8036db40cb603ad6">PotentialSetPar::mode</a></div><div class="ttdeci">int mode</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:545</div></div>
<div class="ttc" id="aclassGalpyManager_html_a84d80784f5da870ff86d61bf29eb98d1"><div class="ttname"><a href="classGalpyManager.html#a84d80784f5da870ff86d61bf29eb98d1">GalpyManager::writePotentialPars</a></div><div class="ttdeci">void writePotentialPars(const std::string &amp;_filename, const double &amp;_system_time)</div><div class="ttdoc">write potential parameters for restart</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1474</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_a04aafb1bdbfda17adef9ded4c6def0ba"><div class="ttname"><a href="classFileHeaderNoOffset.html#a04aafb1bdbfda17adef9ded4c6def0ba">FileHeaderNoOffset::writeAscii</a></div><div class="ttdeci">void writeAscii(FILE *fp) const</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:70</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_ab6fa3afc3853e12c1ae7963de0a1d9ba"><div class="ttname"><a href="classFileHeaderNoOffset.html#ab6fa3afc3853e12c1ae7963de0a1d9ba">FileHeaderNoOffset::FileHeaderNoOffset</a></div><div class="ttdeci">FileHeaderNoOffset(const long long int ni, const long long int n, const double t)</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:54</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_ac0edc3d6108e395caa1577f0b707e404"><div class="ttname"><a href="classMWPotentialEvolve.html#ac0edc3d6108e395caa1577f0b707e404">MWPotentialEvolve::m_vir_halo</a></div><div class="ttdeci">double m_vir_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:299</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a87c5b6b5e1cab0e9125cdf2614d6bcff"><div class="ttname"><a href="namespacegalpy__help.html#a87c5b6b5e1cab0e9125cdf2614d6bcff">galpy_help.listPot</a></div><div class="ttdeci">def listPot()</div><div class="ttdef"><b>Definition:</b> galpy_help.py:140</div></div>
<div class="ttc" id="astructChangeArgument_html"><div class="ttname"><a href="structChangeArgument.html">ChangeArgument</a></div><div class="ttdoc">changing argument parameter</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:641</div></div>
<div class="ttc" id="aclassGalpyManager_html_ae2744681ee872cd102142706394a3f55"><div class="ttname"><a href="classGalpyManager.html#ae2744681ee872cd102142706394a3f55">GalpyManager::GalpyManager</a></div><div class="ttdeci">GalpyManager()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:762</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a1c00ebdf9675f7f32d3427161c7afa8d"><div class="ttname"><a href="classMWPotentialEvolve.html#a1c00ebdf9675f7f32d3427161c7afa8d">MWPotentialEvolve::gm_halo</a></div><div class="ttdeci">double gm_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:313</div></div>
<div class="ttc" id="anamespacegalpy__pot__movie_html_a3fa5f0e5f4c5cacdab86ebbc69420840"><div class="ttname"><a href="namespacegalpy__pot__movie.html#a3fa5f0e5f4c5cacdab86ebbc69420840">galpy_pot_movie.fp</a></div><div class="ttdeci">fp</div><div class="ttdef"><b>Definition:</b> galpy_pot_movie.py:131</div></div>
<div class="ttc" id="asoft__ptcl_8hpp_html"><div class="ttname"><a href="soft__ptcl_8hpp.html">soft_ptcl.hpp</a></div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a7b838de9cd30ec4a8577dd0288619c96"><div class="ttname"><a href="classMWPotentialEvolve.html#a7b838de9cd30ec4a8577dd0288619c96">MWPotentialEvolve::alpha_bulge</a></div><div class="ttdeci">double alpha_bulge</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:306</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a45a7e51221c2de3937fcb72cd90fd11e"><div class="ttname"><a href="classMWPotentialEvolve.html#a45a7e51221c2de3937fcb72cd90fd11e">MWPotentialEvolve::initialFromFile</a></div><div class="ttdeci">void initialFromFile(const std::string &amp;_filename, const double &amp;_time)</div><div class="ttdoc">initial potential parameter from a file</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:343</div></div>
<div class="ttc" id="aclassFileHeader_html_a3b50f979bd6770010875255529015591"><div class="ttname"><a href="classFileHeader.html#a3b50f979bd6770010875255529015591">FileHeader::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> io.hpp:214</div></div>
<div class="ttc" id="aclassGalpyManager_html_a2b9c41229c1b4a6d5c06e18017298357"><div class="ttname"><a href="classGalpyManager.html#a2b9c41229c1b4a6d5c06e18017298357">GalpyManager::updatePotential</a></div><div class="ttdeci">void updatePotential(const double &amp;_system_time, const bool _print_flag)</div><div class="ttdoc">Update Potential types and arguments based on time.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1443</div></div>
<div class="ttc" id="astructPotentialSet_html_ad6c62996c0f166b5b19c6108bf5ae69c"><div class="ttname"><a href="structPotentialSet.html#ad6c62996c0f166b5b19c6108bf5ae69c">PotentialSet::~PotentialSet</a></div><div class="ttdeci">~PotentialSet()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:635</div></div>
<div class="ttc" id="aclassIOParamsContainer_html_a972926da32b4043d06456ab6d35d7752"><div class="ttname"><a href="classIOParamsContainer.html#a972926da32b4043d06456ab6d35d7752">IOParamsContainer::readAscii</a></div><div class="ttdeci">void readAscii(FILE *_fin)</div><div class="ttdef"><b>Definition:</b> io.hpp:112</div></div>
<div class="ttc" id="anamespacegalpy__help_html_aae3e56868e3a407ace4f17255fecb7cd"><div class="ttname"><a href="namespacegalpy__help.html#aae3e56868e3a407ace4f17255fecb7cd">galpy_help.printCPot</a></div><div class="ttdeci">def printCPot(pot_name)</div><div class="ttdef"><b>Definition:</b> galpy_help.py:217</div></div>
<div class="ttc" id="aclassFPSoftWriteArtificial_html"><div class="ttname"><a href="classFPSoftWriteArtificial.html">FPSoftWriteArtificial</a></div><div class="ttdoc">redefine readAscii to read group data format, write in I64 format</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:11</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a395b8e04d50246d4455a00fd41c1d3c9"><div class="ttname"><a href="classIOParamsGalpy.html#a395b8e04d50246d4455a00fd41c1d3c9">IOParamsGalpy::rscale</a></div><div class="ttdeci">IOParams&lt; double &gt; rscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:22</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a55ae279b09c94f7e9a135b18eb42e949"><div class="ttname"><a href="namespacegalpy__help.html#a55ae279b09c94f7e9a135b18eb42e949">galpy_help.printPotTypeArg</a></div><div class="ttdeci">def printPotTypeArg(pot_name, pot_module, pot_instance, print_front_offset=0, print_long_list=False)</div><div class="ttdef"><b>Definition:</b> galpy_help.py:70</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a83d7b952576ff8e9e5e4fbfaf3fc0523"><div class="ttname"><a href="namespacegalpy__help.html#a83d7b952576ff8e9e5e4fbfaf3fc0523">galpy_help.getPotInstance</a></div><div class="ttdeci">def getPotInstance(pot_name)</div><div class="ttdef"><b>Definition:</b> galpy_help.py:7</div></div>
<div class="ttc" id="aclassIOParamsContainer_html_a8bdebaa655392813c07b0dd4ae6469c2"><div class="ttname"><a href="classIOParamsContainer.html#a8bdebaa655392813c07b0dd4ae6469c2">IOParamsContainer::printHelp</a></div><div class="ttdeci">void printHelp(std::ostream &amp;os, const int _offset_short_key=2, const int _offset_long_key=1, const int _width_key=23) const</div><div class="ttdef"><b>Definition:</b> io.hpp:198</div></div>
<div class="ttc" id="aclassFRWModel_html_a9661e2af5caa70fa42e5a7bb37a1df48"><div class="ttname"><a href="classFRWModel.html#a9661e2af5caa70fa42e5a7bb37a1df48">FRWModel::dt_max</a></div><div class="ttdeci">double dt_max</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:184</div></div>
<div class="ttc" id="aclassFRWModel_html_a361381626bcc60640134c25e6c7357bb"><div class="ttname"><a href="classFRWModel.html#a361381626bcc60640134c25e6c7357bb">FRWModel::getDensity</a></div><div class="ttdeci">double getDensity(const double _a) const</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:209</div></div>
<div class="ttc" id="anamespacegalpy__pot__movie_html_af6d8a3f703079e7b353b7af8c136e946"><div class="ttname"><a href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">galpy_pot_movie.dt</a></div><div class="ttdeci">dt</div><div class="ttdef"><b>Definition:</b> galpy_pot_movie.py:134</div></div>
<div class="ttc" id="aclassGalpyManager_html_a7d919be67c48a3a511dd5c8d6d70547c"><div class="ttname"><a href="classGalpyManager.html#a7d919be67c48a3a511dd5c8d6d70547c">GalpyManager::pot_type_offset</a></div><div class="ttdeci">std::vector&lt; int &gt; pot_type_offset</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:737</div></div>
<div class="ttc" id="aclassFRWModel_html_aeff6f0844ba6b7c731086b23569480bc"><div class="ttname"><a href="classFRWModel.html#aeff6f0844ba6b7c731086b23569480bc">FRWModel::omega_radiation</a></div><div class="ttdeci">double omega_radiation</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:189</div></div>
<div class="ttc" id="aclassFRWModel_html"><div class="ttname"><a href="classFRWModel.html">FRWModel</a></div><div class="ttdoc">FRW cosmological model for calculating scale factor (redshift)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:181</div></div>
<div class="ttc" id="aclassGalpyManager_html_ac6ce59845e4b863a3fce47c18e09631a"><div class="ttname"><a href="classGalpyManager.html#ac6ce59845e4b863a3fce47c18e09631a">GalpyManager::initial</a></div><div class="ttdeci">void initial(const IOParamsGalpy &amp;_input, const double _time, const std::string _conf_name, const bool _restart_flag, const bool _print_flag=false)</div><div class="ttdoc">initialization function</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:852</div></div>
<div class="ttc" id="aclassFRWModel_html_a904c7a9d484ab006a8bbbc3f557f6e45"><div class="ttname"><a href="classFRWModel.html#a904c7a9d484ab006a8bbbc3f557f6e45">FRWModel::updateAwithDtmin</a></div><div class="ttdeci">void updateAwithDtmin(const double _dt)</div><div class="ttdoc">update scale factor with maximum time step dt_max (first order Euler method)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:247</div></div>
<div class="ttc" id="aclassFRWModel_html_a747610082f8b89bc7494512925f3d28a"><div class="ttname"><a href="classFRWModel.html#a747610082f8b89bc7494512925f3d28a">FRWModel::getEnergyDensity</a></div><div class="ttdeci">double getEnergyDensity(const double _a) const</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:201</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_a217cf0212d588453748d5a7752c53374"><div class="ttname"><a href="classFileHeaderNoOffset.html#a217cf0212d588453748d5a7752c53374">FileHeaderNoOffset::n_body</a></div><div class="ttdeci">long long int n_body</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:48</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a288f772a110797a259b380fe6f193871"><div class="ttname"><a href="classMWPotentialEvolve.html#a288f772a110797a259b380fe6f193871">MWPotentialEvolve::c_halo</a></div><div class="ttdeci">double c_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:300</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a5c406e33431608da37fcd54b3d691995"><div class="ttname"><a href="classMWPotentialEvolve.html#a5c406e33431608da37fcd54b3d691995">MWPotentialEvolve::init</a></div><div class="ttdeci">struct MWPotentialEvolve::@6 init</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a1925f51dc676783c5ff9736fd8e1fcc0"><div class="ttname"><a href="namespacegalpy__help.html#a1925f51dc676783c5ff9736fd8e1fcc0">galpy_help.printPotTitle</a></div><div class="ttdeci">def printPotTitle()</div><div class="ttdef"><b>Definition:</b> galpy_help.py:133</div></div>
<div class="ttc" id="aclassFRWModel_html_a4e998f4739ff1df966beca89c1e393ed"><div class="ttname"><a href="classFRWModel.html#a4e998f4739ff1df966beca89c1e393ed">FRWModel::getMatterDensity</a></div><div class="ttdeci">double getMatterDensity(const double _a) const</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:193</div></div>
<div class="ttc" id="aclassGalpyManager_html_a3cf2c36189aa2bd879faf8748e1ef871"><div class="ttname"><a href="classGalpyManager.html#a3cf2c36189aa2bd879faf8748e1ef871">GalpyManager::updateMWPotentialEvolve</a></div><div class="ttdeci">bool updateMWPotentialEvolve(const double &amp;_system_time, const bool _print_flag, const bool _initial_flag)</div><div class="ttdoc">Update MWpotential evolve (Gomez et al. 2010)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1067</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a8c48aed3b62e12e8d2c2f0c3b83f3ecc"><div class="ttname"><a href="classMWPotentialEvolve.html#a8c48aed3b62e12e8d2c2f0c3b83f3ecc">MWPotentialEvolve::rho_c_halo</a></div><div class="ttdeci">double rho_c_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:312</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_ab12d579132641e66fa995ec0e25bf6ad"><div class="ttname"><a href="classMWPotentialEvolve.html#ab12d579132641e66fa995ec0e25bf6ad">MWPotentialEvolve::frw</a></div><div class="ttdeci">FRWModel frw</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:297</div></div>
<div class="ttc" id="astructPotentialSet_html_aef723f031ca6b2b31137dade6031a184"><div class="ttname"><a href="structPotentialSet.html#aef723f031ca6b2b31137dade6031a184">PotentialSet::arguments</a></div><div class="ttdeci">struct potentialArg * arguments</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:604</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a2342aa0fad95c171b854d5048dfd9198"><div class="ttname"><a href="structPotentialSetPar.html#a2342aa0fad95c171b854d5048dfd9198">PotentialSetPar::writeData</a></div><div class="ttdeci">void writeData(std::ostream &amp;fout)</div><div class="ttdoc">print data in one line</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:554</div></div>
<div class="ttc" id="aclassGalpyManager_html_ab6b486c9d6318238f363a6656ffc7824"><div class="ttname"><a href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824">GalpyManager::calcAccPot</a></div><div class="ttdeci">void calcAccPot(double *acc, double &amp;pot, const double _time, const double gm, const double *pos_g, const double *pos_l)</div><div class="ttdoc">calculate acceleration and potential at give position</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1603</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a14974639e8eaafae8caa85967ef4ecf1"><div class="ttname"><a href="namespacegalpy__help.html#a14974639e8eaafae8caa85967ef4ecf1">galpy_help.listCPot</a></div><div class="ttdeci">def listCPot()</div><div class="ttdef"><b>Definition:</b> galpy_help.py:239</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a7466fadc59b145f79299db9a77b8e632"><div class="ttname"><a href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">IOParamsGalpy::print_flag</a></div><div class="ttdeci">bool print_flag</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:28</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a952d1651faafee6aab25200c327c578a"><div class="ttname"><a href="structPotentialSetPar.html#a952d1651faafee6aab25200c327c578a">PotentialSetPar::pos</a></div><div class="ttdeci">double pos[3]</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:547</div></div>
<div class="ttc" id="astructIOParams_html_a14f008160ee20f31bee6973eb7d5416d"><div class="ttname"><a href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">IOParams::print</a></div><div class="ttdeci">void print(std::ostream &amp;os) const</div><div class="ttdef"><b>Definition:</b> io.hpp:54</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html"><div class="ttname"><a href="classFileHeaderNoOffset.html">FileHeaderNoOffset</a></div><div class="ttdoc">old version without c.m. pos and vel offset</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:45</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a06882b124341988f3c0d9dc473864755"><div class="ttname"><a href="classMWPotentialEvolve.html#a06882b124341988f3c0d9dc473864755">MWPotentialEvolve::ac_halo</a></div><div class="ttdeci">double ac_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:301</div></div>
<div class="ttc" id="aclassGalpyManager_html_acce39be5c07a685b73a888b4298fd0da"><div class="ttname"><a href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da">GalpyManager::kickMovePot</a></div><div class="ttdeci">void kickMovePot(const double dt)</div><div class="ttdoc">kick velocity of moving potential (mode 2)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1503</div></div>
<div class="ttc" id="aclassBSEManager_html_a569c067ad29e6fd5f665c7fd83e3386d"><div class="ttname"><a href="classBSEManager.html#a569c067ad29e6fd5f665c7fd83e3386d">BSEManager::getBSEName</a></div><div class="ttdeci">static std::string getBSEName()</div><div class="ttdef"><b>Definition:</b> bse_interface.h:1198</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_ae5644de290af1c1c3c9f7dd66a85373d"><div class="ttname"><a href="classMWPotentialEvolve.html#ae5644de290af1c1c3c9f7dd66a85373d">MWPotentialEvolve::now</a></div><div class="ttdeci">struct MWPotentialEvolve::@7 now</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a54683ec55d970c28048bd13b62364a36"><div class="ttname"><a href="namespacegalpy__help.html#a54683ec55d970c28048bd13b62364a36">galpy_help.usage</a></div><div class="ttdeci">def usage()</div><div class="ttdef"><b>Definition:</b> galpy_help.py:271</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a6a7ff92430a30fe693b3600967e77bc3"><div class="ttname"><a href="classMWPotentialEvolve.html#a6a7ff92430a30fe693b3600967e77bc3">MWPotentialEvolve::ra_disk</a></div><div class="ttdeci">double ra_disk</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:303</div></div>
<div class="ttc" id="aclassGalpyManager_html"><div class="ttname"><a href="classGalpyManager.html">GalpyManager</a></div><div class="ttdoc">A class to manager the API to Galpy.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:658</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a499debe349e3789cd6fbab95bc56dabb"><div class="ttname"><a href="classMWPotentialEvolve.html#a499debe349e3789cd6fbab95bc56dabb">MWPotentialEvolve::calcMWPotentialParameters</a></div><div class="ttdeci">void calcMWPotentialParameters(const double &amp;_time)</div><div class="ttdoc">calculate MW potential based on the input time</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:498</div></div>
<div class="ttc" id="aclassFileHeader_html_a7c05dcc8f6a9d15d561de85f8ee43de9"><div class="ttname"><a href="classFileHeader.html#a7c05dcc8f6a9d15d561de85f8ee43de9">FileHeader::readBinary</a></div><div class="ttdeci">int readBinary(FILE *fp)</div><div class="ttdef"><b>Definition:</b> io.hpp:269</div></div>
<div class="ttc" id="aclassStatus_html"><div class="ttname"><a href="classStatus.html">Status</a></div><div class="ttdoc">class for measure the status of the system</div><div class="ttdef"><b>Definition:</b> status.hpp:7</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_afd0dfcfcdab7d35e492d8a76314b45cb"><div class="ttname"><a href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">IOParamsGalpy::input_par_store</a></div><div class="ttdeci">IOParamsContainer input_par_store</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:17</div></div>
<div class="ttc" id="anamespacePIKG_html_ac0a6edfa4881b63ce80ce9a92b899265"><div class="ttname"><a href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PIKG::S64</a></div><div class="ttdeci">int64_t S64</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:23</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a0a7f19d8a97ece60815793bd2756af82"><div class="ttname"><a href="structPotentialSetPar.html#a0a7f19d8a97ece60815793bd2756af82">PotentialSetPar::vel</a></div><div class="ttdeci">double vel[3]</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:548</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_aeec36a599f33df13050485a81d2714f3"><div class="ttname"><a href="classMWPotentialEvolve.html#aeec36a599f33df13050485a81d2714f3">MWPotentialEvolve::gm_disk</a></div><div class="ttdeci">double gm_disk</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:315</div></div>
<div class="ttc" id="astructIOParams_html_a8bcd5a17ce843559b07a968a70c482dc"><div class="ttname"><a href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">IOParams::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> io.hpp:44</div></div>
<div class="ttc" id="aclassFileHeader_html_a3c26fb2ffe2cbd526493a7f71fa9ab86"><div class="ttname"><a href="classFileHeader.html#a3c26fb2ffe2cbd526493a7f71fa9ab86">FileHeader::writeAscii</a></div><div class="ttdeci">void writeAscii(FILE *fp) const</div><div class="ttdef"><b>Definition:</b> io.hpp:265</div></div>
<div class="ttc" id="aclassGalpyManager_html_a93dbb25582316d2279fca8f40635fd5d"><div class="ttname"><a href="classGalpyManager.html#a93dbb25582316d2279fca8f40635fd5d">GalpyManager::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:741</div></div>
<div class="ttc" id="aclassFPSoft_html_a234b9ee456887b70ff9f31c7cc960b50"><div class="ttname"><a href="classFPSoft.html#a234b9ee456887b70ff9f31c7cc960b50">FPSoft::acc</a></div><div class="ttdeci">PS::F64vec acc</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:28</div></div>
<div class="ttc" id="aio_8hpp_html"><div class="ttname"><a href="io_8hpp.html">io.hpp</a></div></div>
<div class="ttc" id="aclassGalpyManager_html_a88b404da59c1a5d91624bfcc24f3800b"><div class="ttname"><a href="classGalpyManager.html#a88b404da59c1a5d91624bfcc24f3800b">GalpyManager::mw_evolve</a></div><div class="ttdeci">MWPotentialEvolve mw_evolve</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:760</div></div>
<div class="ttc" id="aclassGalpyManager_html_aca2f48de54b5f54ea585e6b21d6a12a9"><div class="ttname"><a href="classGalpyManager.html#aca2f48de54b5f54ea585e6b21d6a12a9">GalpyManager::update_time</a></div><div class="ttdeci">double update_time</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:747</div></div>
<div class="ttc" id="aclassGalpyManager_html_aa1e9c6eb40673066e5a7ee87d5a2e641"><div class="ttname"><a href="classGalpyManager.html#aa1e9c6eb40673066e5a7ee87d5a2e641">GalpyManager::writeDataToFile</a></div><div class="ttdeci">void writeDataToFile(const std::string &amp;_filename)</div><div class="ttdoc">write data for restart</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1693</div></div>
<div class="ttc" id="aclassFRWModel_html_ad0aeadcca3d03e3eaa0a24fcf16c79b3"><div class="ttname"><a href="classFRWModel.html#ad0aeadcca3d03e3eaa0a24fcf16c79b3">FRWModel::omega_matter</a></div><div class="ttdeci">double omega_matter</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:190</div></div>
<div class="ttc" id="aclassGalpyManager_html_a5bc0d4b2e49875e6706fb03c4a11e9a2"><div class="ttname"><a href="classGalpyManager.html#a5bc0d4b2e49875e6706fb03c4a11e9a2">GalpyManager::freePotentialArgs</a></div><div class="ttdeci">void freePotentialArgs()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1878</div></div>
<div class="ttc" id="astructPotentialSet_html_a505ba6bec47bb211e3efed6d0ceeec43"><div class="ttname"><a href="structPotentialSet.html#a505ba6bec47bb211e3efed6d0ceeec43">PotentialSet::generatePotentialArgs</a></div><div class="ttdeci">void generatePotentialArgs(const int _npot, int *_type, double *_arg)</div><div class="ttdoc">generate Galpy potential arguments</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:614</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html"><div class="ttname"><a href="classMWPotentialEvolve.html">MWPotentialEvolve</a></div><div class="ttdoc">data for MWPotential evolve</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:277</div></div>
<div class="ttc" id="astructPotentialSet_html_ad38eef44f08ca8a8709a607cf156f6af"><div class="ttname"><a href="structPotentialSet.html#ad38eef44f08ca8a8709a607cf156f6af">PotentialSet::PotentialSet</a></div><div class="ttdeci">PotentialSet()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:606</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a301ef58f6a6cfdd6622adfc8ec504416"><div class="ttname"><a href="structPotentialSetPar.html#a301ef58f6a6cfdd6622adfc8ec504416">PotentialSetPar::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:591</div></div>
<div class="ttc" id="aclassGalpyManager_html_a8aebb589a95e4f322c638ee740fbb9f3"><div class="ttname"><a href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">GalpyManager::printData</a></div><div class="ttdeci">void printData(std::ostream &amp;fout)</div><div class="ttdoc">print current potential data</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:767</div></div>
<div class="ttc" id="anamespacegalpy__help_html_ae38c21dae1cc4e1b1e0e3df9629a6175"><div class="ttname"><a href="namespacegalpy__help.html#ae38c21dae1cc4e1b1e0e3df9629a6175">galpy_help.printSpliter</a></div><div class="ttdeci">def printSpliter()</div><div class="ttdef"><b>Definition:</b> galpy_help.py:137</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_ab8159cd92b6b63eef4b2b8ef1228a863"><div class="ttname"><a href="classFileHeaderNoOffset.html#ab8159cd92b6b63eef4b2b8ef1228a863">FileHeaderNoOffset::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *fp) const</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:84</div></div>
<div class="ttc" id="aclassFRWModel_html_ac4f5f4794291e8b170de871da84a2a8a"><div class="ttname"><a href="classFRWModel.html#ac4f5f4794291e8b170de871da84a2a8a">FRWModel::dt_scale</a></div><div class="ttdeci">double dt_scale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:191</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a92e616d63b989428e6424e0d0180de7c"><div class="ttname"><a href="classMWPotentialEvolve.html#a92e616d63b989428e6424e0d0180de7c">MWPotentialEvolve::writeDataToFile</a></div><div class="ttdeci">void writeDataToFile(const std::string &amp;_filename)</div><div class="ttdoc">write data for restart</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:466</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a1942c7fd5832585b77186e543acc640d"><div class="ttname"><a href="classIOParamsGalpy.html#a1942c7fd5832585b77186e543acc640d">IOParamsGalpy::setBovyUnit</a></div><div class="ttdeci">void setBovyUnit(const bool print_flag=true)</div><div class="ttdoc">set Bovy unit scale factor (solar distance and velocityr referring to the Galactic center) converge f...</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:156</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a2294a6e2c93d5bf3359543a0cb74d0fb"><div class="ttname"><a href="classMWPotentialEvolve.html#a2294a6e2c93d5bf3359543a0cb74d0fb">MWPotentialEvolve::rcut_bulge</a></div><div class="ttdeci">double rcut_bulge</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:307</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_ac7fb4a57c60825d958efe35f49ba427e"><div class="ttname"><a href="classFileHeaderNoOffset.html#ac7fb4a57c60825d958efe35f49ba427e">FileHeaderNoOffset::FileHeaderNoOffset</a></div><div class="ttdeci">FileHeaderNoOffset()</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:50</div></div>
<div class="ttc" id="aclassFRWModel_html_a6b44a07286ac021527bc2ab73b71abb4"><div class="ttname"><a href="classFRWModel.html#a6b44a07286ac021527bc2ab73b71abb4">FRWModel::omega_energy</a></div><div class="ttdeci">double omega_energy</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:188</div></div>
<div class="ttc" id="aclassGalpyManager_html_a1b462774660dccb211b5845458c07eca"><div class="ttname"><a href="classGalpyManager.html#a1b462774660dccb211b5845458c07eca">GalpyManager::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1885</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a703845f35324fdc51dd04e12a1103869"><div class="ttname"><a href="classMWPotentialEvolve.html#a703845f35324fdc51dd04e12a1103869">MWPotentialEvolve::rho_bulge</a></div><div class="ttdeci">double rho_bulge</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:305</div></div>
<div class="ttc" id="aclassGalpyManager_html_abcb9a7057b013d9e922e249d95acef5c"><div class="ttname"><a href="classGalpyManager.html#abcb9a7057b013d9e922e249d95acef5c">GalpyManager::pot_type</a></div><div class="ttdeci">std::vector&lt; int &gt; pot_type</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:738</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a6f30a2731c45df06b67778ccfecd7367"><div class="ttname"><a href="structPotentialSetPar.html#a6f30a2731c45df06b67778ccfecd7367">PotentialSetPar::acc</a></div><div class="ttdeci">double acc[3]</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:549</div></div>
<div class="ttc" id="aclassPtcl_html_a490f938b2d41c0a5def50990dac1f65c"><div class="ttname"><a href="classPtcl.html#a490f938b2d41c0a5def50990dac1f65c">Ptcl::r_search</a></div><div class="ttdeci">PS::F64 r_search</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:38</div></div>
<div class="ttc" id="aclassGalpyManager_html_a81154de8cec300ccefb7ef9acba8e592"><div class="ttname"><a href="classGalpyManager.html#a81154de8cec300ccefb7ef9acba8e592">GalpyManager::rscale</a></div><div class="ttdeci">double rscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:749</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a53bb0027fa3c56b0057224d5a812e8b6"><div class="ttname"><a href="classMWPotentialEvolve.html#a53bb0027fa3c56b0057224d5a812e8b6">MWPotentialEvolve::m_disk</a></div><div class="ttdeci">double m_disk</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:302</div></div>
<div class="ttc" id="aclassPtcl_html_a95511774767b9f27da8983aca8cabb9e"><div class="ttname"><a href="classPtcl.html#a95511774767b9f27da8983aca8cabb9e">Ptcl::changeover</a></div><div class="ttdeci">ChangeOver changeover</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:41</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_ac3a86812131cd86a17dd06e04e0c743f"><div class="ttname"><a href="classIOParamsGalpy.html#ac3a86812131cd86a17dd06e04e0c743f">IOParamsGalpy::config_filename</a></div><div class="ttdeci">IOParams&lt; std::string &gt; config_filename</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:20</div></div>
<div class="ttc" id="aclassGalpyManager_html_a3e7b79940f2c525fd57407e9c7cd02fa"><div class="ttname"><a href="classGalpyManager.html#a3e7b79940f2c525fd57407e9c7cd02fa">GalpyManager::change_args</a></div><div class="ttdeci">std::vector&lt; ChangeArgument &gt; change_args</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:742</div></div>
<div class="ttc" id="astatus_8hpp_html"><div class="ttname"><a href="status_8hpp.html">status.hpp</a></div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a2a62324b191d80d5bb0f89d24a275a2f"><div class="ttname"><a href="classMWPotentialEvolve.html#a2a62324b191d80d5bb0f89d24a275a2f">MWPotentialEvolve::rs_halo</a></div><div class="ttdeci">double rs_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:314</div></div>
<div class="ttc" id="aclassFRWModel_html_aed682fc0d41e7c4263e2512c36cab14c"><div class="ttname"><a href="classFRWModel.html#aed682fc0d41e7c4263e2512c36cab14c">FRWModel::calcH0Myr</a></div><div class="ttdeci">void calcH0Myr()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:213</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a2f837fbca88ad8eb1df5325f12926c11"><div class="ttname"><a href="classMWPotentialEvolve.html#a2f837fbca88ad8eb1df5325f12926c11">MWPotentialEvolve::grho_bulge</a></div><div class="ttdeci">double grho_bulge</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:318</div></div>
<div class="ttc" id="astructStatus_1_1ParticleCM_html_a420cd069d45deba870bc7013fb050a88"><div class="ttname"><a href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">Status::ParticleCM::pos</a></div><div class="ttdeci">PS::F64vec pos</div><div class="ttdef"><b>Definition:</b> status.hpp:20</div></div>
<div class="ttc" id="astructPotentialSet_html_ab5df10085ca7311029cb112acc07591d"><div class="ttname"><a href="structPotentialSet.html#ab5df10085ca7311029cb112acc07591d">PotentialSet::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:625</div></div>
<div class="ttc" id="astructChangeArgument_html_afbe443c6700173c8963c49d179624535"><div class="ttname"><a href="structChangeArgument.html#afbe443c6700173c8963c49d179624535">ChangeArgument::rate</a></div><div class="ttdeci">double rate</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:644</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_abd0745ae2a561cd7675afb98c72f0538"><div class="ttname"><a href="classFileHeaderNoOffset.html#abd0745ae2a561cd7675afb98c72f0538">FileHeaderNoOffset::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:49</div></div>
<div class="ttc" id="aclassGalpyManager_html_abb225b337233061de8ffff35e67a53dc"><div class="ttname"><a href="classGalpyManager.html#abb225b337233061de8ffff35e67a53dc">GalpyManager::~GalpyManager</a></div><div class="ttdeci">~GalpyManager()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1891</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_a518e9dbbb6ca192199416ac0415b3a7f"><div class="ttname"><a href="classFileHeaderNoOffset.html#a518e9dbbb6ca192199416ac0415b3a7f">FileHeaderNoOffset::readAscii</a></div><div class="ttdeci">int readAscii(FILE *fp)</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:60</div></div>
<div class="ttc" id="astructChangeArgument_html_a0e70284724e4d9cd487e9c95bffbc1ee"><div class="ttname"><a href="structChangeArgument.html#a0e70284724e4d9cd487e9c95bffbc1ee">ChangeArgument::index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:642</div></div>
<div class="ttc" id="astructIOParams_html"><div class="ttname"><a href="structIOParams.html">IOParams&lt; std::string &gt;</a></div></div>
<div class="ttc" id="aclassGalpyManager_html_a19b099354f7018e7413a234bbc37b14e"><div class="ttname"><a href="classGalpyManager.html#a19b099354f7018e7413a234bbc37b14e">GalpyManager::pot_sets</a></div><div class="ttdeci">std::vector&lt; PotentialSet &gt; pot_sets</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:746</div></div>
<div class="ttc" id="aclassStatus_html_a1c95aee88a7a5568b46d2c700198a139"><div class="ttname"><a href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">Status::calcAndShiftCenterOfMass</a></div><div class="ttdeci">void calcAndShiftCenterOfMass(Tsoft *_tsys, const PS::S64 _n, const int _mode=3, const bool initial_flag=false)</div><div class="ttdoc">calculate the center of system and shift particle systems to center frame</div><div class="ttdef"><b>Definition:</b> status.hpp:228</div></div>
<div class="ttc" id="aclassFRWModel_html_a274ccc0053de35e759f314a9c5b9e8ca"><div class="ttname"><a href="classFRWModel.html#a274ccc0053de35e759f314a9c5b9e8ca">FRWModel::H0_myr</a></div><div class="ttdeci">double H0_myr</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:187</div></div>
<div class="ttc" id="aclassFPSoftWriteArtificial_html_ad58f4f4a5f291e6535e0501db231b6da"><div class="ttname"><a href="classFPSoftWriteArtificial.html#ad58f4f4a5f291e6535e0501db231b6da">FPSoftWriteArtificial::readAscii</a></div><div class="ttdeci">void readAscii(FILE *_fin)</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:24</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a7525714c40a2cc23a672b9f2498dcc3d"><div class="ttname"><a href="classIOParamsGalpy.html#a7525714c40a2cc23a672b9f2498dcc3d">IOParamsGalpy::read</a></div><div class="ttdeci">int read(int argc, char *argv[], const int opt_used_pre=0)</div><div class="ttdoc">reading parameters from GNU option API</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:49</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html"><div class="ttname"><a href="classIOParamsGalpy.html">IOParamsGalpy</a></div><div class="ttdoc">IO parameters for Galpy manager.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:15</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a9a91ee11637ca25e1529bd6d64cbc713"><div class="ttname"><a href="classIOParamsGalpy.html#a9a91ee11637ca25e1529bd6d64cbc713">IOParamsGalpy::type_args</a></div><div class="ttdeci">IOParams&lt; std::string &gt; type_args</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:18</div></div>
<div class="ttc" id="astructChangeArgument_html_a2cbdb96f16114b3627e35af740ac9da2"><div class="ttname"><a href="structChangeArgument.html#a2cbdb96f16114b3627e35af740ac9da2">ChangeArgument::readData</a></div><div class="ttdeci">void readData(std::ifstream &amp;fin)</div><div class="ttdoc">print data in one line</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:652</div></div>
<div class="ttc" id="aclassFileHeader_html_a815f6011d37a3cae9dced9652c3b592a"><div class="ttname"><a href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">FileHeader::nfile</a></div><div class="ttdeci">long long int nfile</div><div class="ttdef"><b>Definition:</b> io.hpp:212</div></div>
<div class="ttc" id="aclassArtificialParticleInformation_html_ab55e8cb9e7c06e8724bf280455f9207f"><div class="ttname"><a href="classArtificialParticleInformation.html#ab55e8cb9e7c06e8724bf280455f9207f">ArtificialParticleInformation::readAscii</a></div><div class="ttdeci">void readAscii(FILE *_fin)</div><div class="ttdoc">read class data with ASCII format</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:203</div></div>
<div class="ttc" id="anamespacegalpy__help_html_a4d619a4735e453bf01115301394b7e94"><div class="ttname"><a href="namespacegalpy__help.html#a4d619a4735e453bf01115301394b7e94">galpy_help.pot_module</a></div><div class="ttdeci">pot_module</div><div class="ttdef"><b>Definition:</b> galpy_help.py:303</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a05d844f0513480aab99e32f1ae24c9a5"><div class="ttname"><a href="classIOParamsGalpy.html#a05d844f0513480aab99e32f1ae24c9a5">IOParamsGalpy::pre_define_type</a></div><div class="ttdeci">IOParams&lt; std::string &gt; pre_define_type</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:19</div></div>
<div class="ttc" id="aclassFRWModel_html_a80544a319035cb9fe253f2dee3d63d52"><div class="ttname"><a href="classFRWModel.html#a80544a319035cb9fe253f2dee3d63d52">FRWModel::getRadiationDensity</a></div><div class="ttdeci">double getRadiationDensity(const double _a) const</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:197</div></div>
<div class="ttc" id="aunionGroupDataDeliver_html_a795d43703c4f19f8c8dc0982e8373ac2"><div class="ttname"><a href="unionGroupDataDeliver.html#a795d43703c4f19f8c8dc0982e8373ac2">GroupDataDeliver::artificial</a></div><div class="ttdeci">ArtificialParticleInformation artificial</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:18</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a9183f2e1c26b6480684a561e3a170b5b"><div class="ttname"><a href="classIOParamsGalpy.html#a9183f2e1c26b6480684a561e3a170b5b">IOParamsGalpy::IOParamsGalpy</a></div><div class="ttdeci">IOParamsGalpy()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:30</div></div>
<div class="ttc" id="aclassGalpyManager_html_a7e35973fb12c11ca65ca0d0462c6c4dd"><div class="ttname"><a href="classGalpyManager.html#a7e35973fb12c11ca65ca0d0462c6c4dd">GalpyManager::updatePotentialSet</a></div><div class="ttdeci">void updatePotentialSet()</div><div class="ttdoc">generate potentail args</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:969</div></div>
<div class="ttc" id="aclassFRWModel_html_a348b0ad06e5e83855a039ab5179806bc"><div class="ttname"><a href="classFRWModel.html#a348b0ad06e5e83855a039ab5179806bc">FRWModel::updateA</a></div><div class="ttdeci">void updateA(const double _dt)</div><div class="ttdoc">update scale factor by time step _dt (first order Euler method)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:231</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a40943161fcb025e7633e78145e94a8ab"><div class="ttname"><a href="classMWPotentialEvolve.html#a40943161fcb025e7633e78145e94a8ab">MWPotentialEvolve::r_vir_halo</a></div><div class="ttdeci">double r_vir_halo</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:311</div></div>
<div class="ttc" id="aclassGalpyManager_html_a8277cbb6fe9d9f7c926f95ffbbe7e582"><div class="ttname"><a href="classGalpyManager.html#a8277cbb6fe9d9f7c926f95ffbbe7e582">GalpyManager::fconf</a></div><div class="ttdeci">std::ifstream fconf</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:756</div></div>
<div class="ttc" id="aclassGalpyManager_html_a251e44bc3eaf99cc2ce681fceb08b433"><div class="ttname"><a href="classGalpyManager.html#a251e44bc3eaf99cc2ce681fceb08b433">GalpyManager::set_name</a></div><div class="ttdeci">std::string set_name</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:757</div></div>
<div class="ttc" id="aclassGalpyManager_html_a6ed970dba7e92f37d8306f33cc9b979c"><div class="ttname"><a href="classGalpyManager.html#a6ed970dba7e92f37d8306f33cc9b979c">GalpyManager::pot_args_offset</a></div><div class="ttdeci">std::vector&lt; int &gt; pot_args_offset</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:739</div></div>
<div class="ttc" id="aformat__transfer_8cxx_html_abb8c695c59de918bd3075902d07156f6"><div class="ttname"><a href="format__transfer_8cxx.html#abb8c695c59de918bd3075902d07156f6">SystemSoftWriteArtificial</a></div><div class="ttdeci">PS::ParticleSystem&lt; FPSoftWriteArtificial &gt; SystemSoftWriteArtificial</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:90</div></div>
<div class="ttc" id="aclassGalpyManager_html_ab62c12445528d34451bff6f6d24a54d0"><div class="ttname"><a href="classGalpyManager.html#ab62c12445528d34451bff6f6d24a54d0">GalpyManager::gmscale</a></div><div class="ttdeci">double gmscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:754</div></div>
<div class="ttc" id="anamespacegalpy__pot__movie_html_ae50af7118b493b53e207df8685051903"><div class="ttname"><a href="namespacegalpy__pot__movie.html#ae50af7118b493b53e207df8685051903">galpy_pot_movie.nstep</a></div><div class="ttdeci">nstep</div><div class="ttdef"><b>Definition:</b> galpy_pot_movie.py:134</div></div>
<div class="ttc" id="aclassChangeOver_html_a4ab816f7e59edaf68f7223b8ca5bcd7b"><div class="ttname"><a href="classChangeOver.html#a4ab816f7e59edaf68f7223b8ca5bcd7b">ChangeOver::readAscii</a></div><div class="ttdeci">void readAscii(FILE *_fin)</div><div class="ttdoc">read class data to file with binary format</div><div class="ttdef"><b>Definition:</b> changeover.hpp:168</div></div>
<div class="ttc" id="aclassFRWModel_html_abb7a4dcaa3256b6365ef1cc5e9f5dba4"><div class="ttname"><a href="classFRWModel.html#abb7a4dcaa3256b6365ef1cc5e9f5dba4">FRWModel::calcAdot</a></div><div class="ttdeci">double calcAdot(const double _a) const</div><div class="ttdoc">calculate da/dt</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:223</div></div>
<div class="ttc" id="aclassFileHeaderNoOffset_html_a5dadcc98ae6c4b235417aa134d31435a"><div class="ttname"><a href="classFileHeaderNoOffset.html#a5dadcc98ae6c4b235417aa134d31435a">FileHeaderNoOffset::readBinary</a></div><div class="ttdeci">int readBinary(FILE *fp)</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:74</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a043c498a70f8cbed2f3a83b2c6ccee03"><div class="ttname"><a href="structPotentialSetPar.html#a043c498a70f8cbed2f3a83b2c6ccee03">PotentialSetPar::setOrigin</a></div><div class="ttdeci">void setOrigin(const int _mode, const double _gm=0, const double *_pos=NULL, const double *_vel=NULL, const double *_acc=NULL)</div><div class="ttdoc">set position, velocity and acceleration</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:570</div></div>
<div class="ttc" id="aclassGalpyManager_html_a56875a530c45fac6439a6d6d4f671b3d"><div class="ttname"><a href="classGalpyManager.html#a56875a530c45fac6439a6d6d4f671b3d">GalpyManager::driftMovePot</a></div><div class="ttdeci">void driftMovePot(const double dt)</div><div class="ttdoc">drift position of moving potential (mode 2)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1522</div></div>
<div class="ttc" id="aclassFRWModel_html_a262a19eeb8300f0a59c8555e052cbc27"><div class="ttname"><a href="classFRWModel.html#a262a19eeb8300f0a59c8555e052cbc27">FRWModel::getH</a></div><div class="ttdeci">double getH() const</div><div class="ttdoc">get Hubble constant at current a</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:267</div></div>
<div class="ttc" id="astructPotentialSet_html"><div class="ttname"><a href="structPotentialSet.html">PotentialSet</a></div><div class="ttdoc">set of Galpy potentials sharing the same position and velocity of the origin</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:602</div></div>
<div class="ttc" id="astructPotentialSetPar_html"><div class="ttname"><a href="structPotentialSetPar.html">PotentialSetPar</a></div><div class="ttdoc">mode, position, velocity and acceleration for set of Galpy potentials</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:544</div></div>
<div class="ttc" id="aclassGalpyManager_html_accd0a3c5a62b628e4a9e002f8ec10ad4"><div class="ttname"><a href="classGalpyManager.html#accd0a3c5a62b628e4a9e002f8ec10ad4">GalpyManager::resetPotAcc</a></div><div class="ttdeci">void resetPotAcc()</div><div class="ttdoc">reset acceleraltion of potential</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1492</div></div>
<div class="ttc" id="aclassFRWModel_html_ac639a14eba5f454ecd905f1e907c8ee4"><div class="ttname"><a href="classFRWModel.html#ac639a14eba5f454ecd905f1e907c8ee4">FRWModel::getCurvatureDensity</a></div><div class="ttdeci">double getCurvatureDensity() const</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:205</div></div>
<div class="ttc" id="aclassFRWModel_html_a4ad7b8203c54739af126607f0c987efc"><div class="ttname"><a href="classFRWModel.html#a4ad7b8203c54739af126607f0c987efc">FRWModel::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:183</div></div>
<div class="ttc" id="aclassGalpyManager_html_a912e9c5fc587218525f51a8b71e55735"><div class="ttname"><a href="classGalpyManager.html#a912e9c5fc587218525f51a8b71e55735">GalpyManager::updatePotentialFromFile</a></div><div class="ttdeci">bool updatePotentialFromFile(const double &amp;_system_time, const bool _print_flag)</div><div class="ttdoc">Update types and arguments from configure file if update_time &lt;= particle system time.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1111</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a38386e616009bd027d31459b2acb5df8"><div class="ttname"><a href="classIOParamsGalpy.html#a38386e616009bd027d31459b2acb5df8">IOParamsGalpy::vscale</a></div><div class="ttdeci">IOParams&lt; double &gt; vscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:24</div></div>
<div class="ttc" id="aclassFileHeader_html"><div class="ttname"><a href="classFileHeader.html">FileHeader</a></div><div class="ttdef"><b>Definition:</b> io.hpp:210</div></div>
<div class="ttc" id="aclassGalpyManager_html_aa3dae1cb65b66097ce9f98bb17f4f518"><div class="ttname"><a href="classGalpyManager.html#aa3dae1cb65b66097ce9f98bb17f4f518">GalpyManager::vscale</a></div><div class="ttdeci">double vscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:750</div></div>
<div class="ttc" id="aclassGalpyManager_html_a23c4eea8e55af4a49fe22b9564b1d5f6"><div class="ttname"><a href="classGalpyManager.html#a23c4eea8e55af4a49fe22b9564b1d5f6">GalpyManager::change_args_offset</a></div><div class="ttdeci">std::vector&lt; int &gt; change_args_offset</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:743</div></div>
<div class="ttc" id="aclassGalpyManager_html_a0731140835f4392b060760a608e5e96d"><div class="ttname"><a href="classGalpyManager.html#a0731140835f4392b060760a608e5e96d">GalpyManager::addPotentialFromString</a></div><div class="ttdeci">bool addPotentialFromString(const std::string &amp;_type_args, const bool _reset_flag, const bool _print_flag)</div><div class="ttdoc">Update types and arguments from type-args string.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:986</div></div>
<div class="ttc" id="aclassIOParamsContainer_html"><div class="ttname"><a href="classIOParamsContainer.html">IOParamsContainer</a></div><div class="ttdoc">IO Params container.</div><div class="ttdef"><b>Definition:</b> io.hpp:82</div></div>
<div class="ttc" id="aclassPtcl_html_ad716134f1408c3f34ce7900363e2d62c"><div class="ttname"><a href="classPtcl.html#ad716134f1408c3f34ce7900363e2d62c">Ptcl::group_data</a></div><div class="ttdeci">GroupDataDeliver group_data</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:40</div></div>
<div class="ttc" id="aclassGalpyManager_html_adaf966854f08d01f32948d56205d4d64"><div class="ttname"><a href="classGalpyManager.html#adaf966854f08d01f32948d56205d4d64">GalpyManager::pot_args</a></div><div class="ttdeci">std::vector&lt; double &gt; pot_args</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:740</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_a61d78d2224231b9d052d48cdd2d38eaf"><div class="ttname"><a href="classMWPotentialEvolve.html#a61d78d2224231b9d052d48cdd2d38eaf">MWPotentialEvolve::readDataFromFile</a></div><div class="ttdeci">void readDataFromFile(const std::string &amp;_filename, const double &amp;_time)</div><div class="ttdoc">read potential parameter from a file</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:408</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a25bedcd1c113e5bbd80dc59c2b99c4af"><div class="ttname"><a href="structPotentialSetPar.html#a25bedcd1c113e5bbd80dc59c2b99c4af">PotentialSetPar::PotentialSetPar</a></div><div class="ttdeci">PotentialSetPar()</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:551</div></div>
<div class="ttc" id="astructChangeArgument_html_a21aa76b0b704069895de4d0f6d2e49dc"><div class="ttname"><a href="structChangeArgument.html#a21aa76b0b704069895de4d0f6d2e49dc">ChangeArgument::writeData</a></div><div class="ttdeci">void writeData(std::ostream &amp;fout)</div><div class="ttdoc">print data in one line</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:647</div></div>
<div class="ttc" id="aclassGalpyManager_html_a60bef4e78023b1dc281e6cb2cffd813e"><div class="ttname"><a href="classGalpyManager.html#a60bef4e78023b1dc281e6cb2cffd813e">GalpyManager::calcMovePotAccFromPot</a></div><div class="ttdeci">void calcMovePotAccFromPot(const double _time, const double *pos_pcm)</div><div class="ttdoc">calculate acceleration for moving potentials from other potentials</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1543</div></div>
<div class="ttc" id="aclassParticleBase_html_a37300f78eeb60423fb3e750685331e8d"><div class="ttname"><a href="classParticleBase.html#a37300f78eeb60423fb3e750685331e8d">ParticleBase::readAscii</a></div><div class="ttdeci">void readAscii(FILE *fp)</div><div class="ttdoc">read class data with ASCII format</div><div class="ttdef"><b>Definition:</b> particle_base.hpp:161</div></div>
<div class="ttc" id="aclassGalpyManager_html_a1b5f2eebb24a0690e4b168c79bada7b8"><div class="ttname"><a href="classGalpyManager.html#a1b5f2eebb24a0690e4b168c79bada7b8">GalpyManager::evolveChangingArguments</a></div><div class="ttdeci">bool evolveChangingArguments(const double &amp;_time, const bool _print_flag)</div><div class="ttdoc">calculate new arguments for changing potentials</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1843</div></div>
<div class="ttc" id="astructPotentialSetPar_html_a0440188b3ff1ea16d0a2ecea399e0c67"><div class="ttname"><a href="structPotentialSetPar.html#a0440188b3ff1ea16d0a2ecea399e0c67">PotentialSetPar::readData</a></div><div class="ttdeci">void readData(std::ifstream &amp;fin)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:562</div></div>
<div class="ttc" id="aclassFRWModel_html_a4c286e64b2020ebb3a5e4921af79e7d3"><div class="ttname"><a href="classFRWModel.html#a4c286e64b2020ebb3a5e4921af79e7d3">FRWModel::H0</a></div><div class="ttdeci">double H0</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:186</div></div>
<div class="ttc" id="aclassMWPotentialEvolve_html_aec26e403ae40bb15c8374bf2d1fce712"><div class="ttname"><a href="classMWPotentialEvolve.html#aec26e403ae40bb15c8374bf2d1fce712">MWPotentialEvolve::rb_disk</a></div><div class="ttdeci">double rb_disk</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:304</div></div>
<div class="ttc" id="aclassGalpyManager_html_afb09a3d7a8191c4faf86bb65e7bfb891"><div class="ttname"><a href="classGalpyManager.html#afb09a3d7a8191c4faf86bb65e7bfb891">GalpyManager::tscale</a></div><div class="ttdeci">double tscale</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:751</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_7715dae821e4b0455a6633cbfbf949c2.html">galpy-interface</a></li><li class="navelem"><a class="el" href="galpy__interface_8h.html">galpy_interface.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
