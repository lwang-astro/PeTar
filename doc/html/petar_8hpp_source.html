<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeTar: petar.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PeTar
   </div>
   <div id="projectbrief">N-body code for collisional gravitational systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('petar_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">petar.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="petar_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#pragma once</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#ifdef P3T_64BIT</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#define CALC_EP_64bit</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#define CALC_SP_64bit</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#define RSQRT_NR_EPJ_X4</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#define RSQRT_NR_SPJ_X4</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#elif P3T_MIXBIT</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#define CALC_EP_64bit</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#define RSQRT_NR_EPJ_X4</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00013"></a><span class="lineno"><a class="line" href="petar_8hpp.html#aeeeb57db68d0ced937416067cbdcad46">   13</a></span>&#160;<span class="preprocessor">#define RSQRT_NR_EPJ_X2</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//#define RSQRT_NR_SPJ_X2</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#if defined(INTRINSIC_K) || defined(INTRINSIC_X86)</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#define INTRINSIC</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include&lt;iostream&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include&lt;iomanip&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include&lt;fstream&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include&lt;string&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include&lt;sstream&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//#include&lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include&lt;getopt.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#ifdef MPI_DEBUG</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Send recv debug</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keywordtype">int</span> MPI_Isend(<span class="keywordtype">void</span>* buffer, <span class="keywordtype">int</span> count, MPI_Datatype datatype, <span class="keywordtype">int</span> dest, <span class="keywordtype">int</span> tag, MPI_Comm comm, MPI_Request* req)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <span class="keywordtype">int</span> size;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   MPI_Type_size(datatype, &amp;size);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   std::cerr&lt;&lt;<span class="stringliteral">&quot;MPI_ISend count &quot;</span>&lt;&lt;count&lt;&lt;<span class="stringliteral">&quot; dest &quot;</span>&lt;&lt;dest&lt;&lt;<span class="stringliteral">&quot; datatype &quot;</span>&lt;&lt;size&lt;&lt;<span class="stringliteral">&quot; tag &quot;</span>&lt;&lt;tag&lt;&lt;std::endl;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   ret = PMPI_Isend(buffer, count, datatype, dest, tag, comm, req);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">// Debug</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">int</span> MPI_Irecv(<span class="keywordtype">void</span>* buffer, <span class="keywordtype">int</span> count, MPI_Datatype datatype, <span class="keywordtype">int</span> dest, <span class="keywordtype">int</span> tag, MPI_Comm comm, MPI_Request* req)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   <span class="keywordtype">int</span> size;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   MPI_Type_size(datatype, &amp;size);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   std::cerr&lt;&lt;<span class="stringliteral">&quot;MPI_IRecv count &quot;</span>&lt;&lt;count&lt;&lt;<span class="stringliteral">&quot; dest &quot;</span>&lt;&lt;dest&lt;&lt;<span class="stringliteral">&quot; datatype &quot;</span>&lt;&lt;size&lt;&lt;<span class="stringliteral">&quot; tag &quot;</span>&lt;&lt;tag&lt;&lt;std::endl;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   ret = PMPI_Irecv(buffer, count, datatype, dest, tag, comm, req);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   <span class="keywordflow">return</span> ret;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include&lt;<a class="code" href="get__version_8hpp.html">get_version.hpp</a>&gt;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include&lt;particle_simulator.hpp&gt;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="hard__assert_8hpp.html">hard_assert.hpp</a>&quot;</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="soft__ptcl_8hpp.html">soft_ptcl.hpp</a>&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="soft__force_8hpp.html">soft_force.hpp</a>&quot;</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="force__gpu__cuda_8hpp.html">force_gpu_cuda.hpp</a>&quot;</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#ifdef USE_FUGAKU</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="force__fugaku_8hpp.html">force_fugaku.hpp</a>&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="energy_8hpp.html">energy.hpp</a>&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="hard_8hpp.html">hard.hpp</a>&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="io_8hpp.html">io.hpp</a>&quot;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="status_8hpp.html">status.hpp</a>&quot;</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="particle__distribution__generator_8hpp.html">particle_distribution_generator.hpp</a>&quot;</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="domain_8hpp.html">domain.hpp</a>&quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="cluster__list_8hpp.html">cluster_list.hpp</a>&quot;</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="kickdriftstep_8hpp.html">kickdriftstep.hpp</a>&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="profile_8hpp.html">profile.hpp</a>&quot;</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="static__variables_8hpp.html">static_variables.hpp</a>&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="escaper_8hpp.html">escaper.hpp</a>&quot;</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#include&quot;<a class="code" href="galpy__interface_8h.html">galpy_interface.h</a>&quot;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html">   89</a></span>&#160;<span class="keyword">class </span><a class="code" href="classIOParamsPeTar.html">IOParamsPeTar</a>{</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// IO parameters</span></div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">   92</a></span>&#160;    <a class="code" href="classIOParamsContainer.html">IOParamsContainer</a> <a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">   93</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">   94</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">   95</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">   96</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">   97</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">   98</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#ifdef ORBIT_SAMPLING</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> n_split;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">  102</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">  103</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>;</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">  104</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">  105</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">  106</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>;</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">  107</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">unit_set</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">  108</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">  109</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">id_offset</a>;</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">  110</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">  111</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">  112</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">nstep_dt_soft_kepler</a>;</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">  113</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">  114</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">  115</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">  116</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//IOParams&lt;PS::S64&gt; dt_min_ar_index;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//IOParams&lt;PS::F64&gt; dt_err_pert;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//IOParams&lt;PS::F64&gt; dt_err_soft;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">  120</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> e_err_hard;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">  124</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">step_limit_ar</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">  125</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">  126</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">  127</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//    IOParams&lt;PS::F64&gt; r_search_max;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">  129</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">r_search_min</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">  130</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">  131</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::F64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>;</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">  132</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">  133</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> stellar_evolution_option;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">  137</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#ifdef ADJUST_GROUP_PRINT</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> adjust_group_write_option;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">  141</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;PS::S64&gt;</a> <a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">  142</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;std::string&gt;</a> <a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">  143</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;std::string&gt;</a> <a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">  144</a></span>&#160;    <a class="code" href="structIOParams.html">IOParams&lt;std::string&gt;</a> <a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// flag</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">  147</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>; </div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">  148</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">update_changeover_flag</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">  149</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a6ee1912c7448cb38242a4c0bd06fefb3">  151</a></span>&#160;    <a class="code" href="classIOParamsPeTar.html#a6ee1912c7448cb38242a4c0bd06fefb3">IOParamsPeTar</a>(): <a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>(), </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>      (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.1,  <span class="stringliteral">&quot;r-ratio&quot;</span>, <span class="stringliteral">&quot;r_in / r_out&quot;</span>),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>            (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.3,  <span class="stringliteral">&quot;T&quot;</span>,  <span class="stringliteral">&quot;Particle-tree opening angle theta&quot;</span>),</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>     (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 20,   <span class="stringliteral">&quot;number-leaf-limit&quot;</span>, <span class="stringliteral">&quot;Particle-tree leaf number limit&quot;</span>, <span class="stringliteral">&quot;Optimal value should be slightly &gt;= 11 + N_bin_sample (20)&quot;</span>),</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;#ifdef USE__AVX512</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>    (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1024, <span class="stringliteral">&quot;number-group-limit&quot;</span>, <span class="stringliteral">&quot;Particle-tree group number limit&quot;</span>, <span class="stringliteral">&quot;Optimized for x86-AVX512 (1024)&quot;</span>),    </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;#else</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>    (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 512,  <span class="stringliteral">&quot;number-group-limit&quot;</span>, <span class="stringliteral">&quot;Particle-tree group number limit&quot;</span>, <span class="stringliteral">&quot;Optimized for x86-AVX2 (512)&quot;</span>),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;#endif</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 128,  <span class="stringliteral">&quot;number-interrupt-limit&quot;</span>, <span class="stringliteral">&quot;Interrupted hard integrator limit&quot;</span>),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>        (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 100,  <span class="stringliteral">&quot;number-sample-average&quot;</span>, <span class="stringliteral">&quot;Average target number of sample particles per process&quot;</span>),</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;#ifdef ORBIT_SAMPLING</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                     n_split          (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 4,    <span class="stringliteral">&quot;number-split&quot;</span>, <span class="stringliteral">&quot;Number of binary sample points for tree perturbation force&quot;</span>),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;#endif</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>            (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0,    <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;Number of primordial binaries for initialization (assuming the binaries&#39; IDs are 1,2*n_bin)&quot;</span>),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a> (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 8,    <span class="stringliteral">&quot;number-step-tt&quot;</span>, <span class="stringliteral">&quot;Number of steps per slow-down binary orbits (binary period/tree timestep) for isolated binaries; also the maximum criterion for activating tidal tensor method&quot;</span>),</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>         (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 10.0, <span class="stringliteral">&quot;t&quot;</span>, <span class="stringliteral">&quot;End time of simulation&quot;</span>),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>              (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.1,  <span class="stringliteral">&quot;hermite-eta&quot;</span>, <span class="stringliteral">&quot;Hermite timestep coefficient eta&quot;</span>),</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1.0, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;Gravitational constant&quot;</span>),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">unit_set</a>         (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0,    <span class="stringliteral">&quot;u&quot;</span>, <span class="stringliteral">&quot;Input data unit, 0: unknown, referring to G; 1: mass:Msun, length:pc, time:Myr, velocity:pc/Myr&quot;</span>),</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>            (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 100000, <span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;Total number of particles, used only for a test with the internal equal-mass Plummer model generator (assuming G=1 and the input data filename is __Plummer)&quot;</span>),</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">id_offset</a>        (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, -1,   <span class="stringliteral">&quot;id-offset&quot;</span>, <span class="stringliteral">&quot;Starting ID for artificial particles, total number of real particles must always be smaller than this&quot;</span>,<span class="stringliteral">&quot;n_glb+1&quot;</span>),</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>          (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.0,  <span class="stringliteral">&quot;s&quot;</span>, <span class="stringliteral">&quot;Tree timestep (dt_soft), if the value is zero (default) and --nstep-dt-soft-kepler is not used, then dt_soft = 0.1*r_out/sigma_1D&quot;</span>),</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>          (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1.0,  <span class="stringliteral">&quot;o&quot;</span>, <span class="stringliteral">&quot;Output time interval for particle dataset snapshots&quot;</span>),</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">nstep_dt_soft_kepler</a> (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.0, <span class="stringliteral">&quot;nstep-dt-soft-kepler&quot;</span>, <span class="stringliteral">&quot;Determines the tree timestep by P(r_in)/nstep, where P(r_in) is the binary period with the semi-major axis of r_in, nstep is the argument of this option (e.g., 32.0)&quot;</span>, <span class="stringliteral">&quot;not used&quot;</span>),</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 3.0,  <span class="stringliteral">&quot;search-vel-factor&quot;</span>, <span class="stringliteral">&quot;Neighbor search coefficient for velocity check (v*dt)&quot;</span>),</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>  (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1.5, <span class="stringliteral">&quot;search-peri-factor&quot;</span>, <span class="stringliteral">&quot;Neighbor search coefficient for periapsis check&quot;</span>),</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 4.0, <span class="stringliteral">&quot;dt-max-factor&quot;</span>, <span class="stringliteral">&quot;Limit of tree timestep/hard timestep&quot;</span>),</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 40,  <span class="stringliteral">&quot;dt-min-hermite&quot;</span>,  <span class="stringliteral">&quot;Power index n for the smallest timestep (0.5^n) allowed in the Hermite integrator&quot;</span>),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                     <span class="comment">//dt_min_ar_index     (input_par_store, 64,  &quot;dt-min-ar&quot;,  &quot;Power index n for the smallest timestep (0.5^n) allowed in the ARC integrator, suppressed&quot;),</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                     <span class="comment">//dt_err_pert  (input_par_store, 1e-6, &quot;dt-error-pert&quot;, &quot;Maximum time synchronization error (relative) for perturbed ARC integrator, suppressed&quot;),</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                     <span class="comment">//dt_err_soft  (input_par_store, 1e-3, &quot;dt-error-iso&quot;, &quot;Maximum time synchronization error (relative) for no-perturber (only soft perturbation) ARC integrator, suppressed&quot;),</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>     (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1e-8, <span class="stringliteral">&quot;energy-err-ar&quot;</span>, <span class="stringliteral">&quot;Maximum energy error allowed for the ARC integrator&quot;</span>),</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;#ifdef HARD_CHECK_ENERGY</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                     e_err_hard   (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1e-4, <span class="stringliteral">&quot;energy-err-hard&quot;</span>, <span class="stringliteral">&quot;Maximum energy error allowed for the hard integrator&quot;</span>),</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;#endif</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">step_limit_ar</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1000000, <span class="stringliteral">&quot;step-limit-ar&quot;</span>, <span class="stringliteral">&quot;Maximum step allowed for the ARC sym integrator&quot;</span>),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>          (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.0,  <span class="stringliteral">&quot;soft-eps&quot;</span>, <span class="stringliteral">&quot;Softening epsilon&quot;</span>),</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>        (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.0,  <span class="stringliteral">&quot;r&quot;</span>, <span class="stringliteral">&quot;Outer boundary radius for the changeover function (r_out), if value is zero and -s is not used, use 0.1 GM/[N^(1/3) sigma_3D^2]; if -s is given, calculate r_out from dt_soft&quot;</span>),</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>        (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.0,  <span class="stringliteral">&quot;r-bin&quot;</span>, <span class="stringliteral">&quot;Tidal tensor box size and the radial criterion for detecting multiple systems (binaries, triples, etc.), if value is zero, use 0.8*r_in&quot;</span>),</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">//                     r_search_max (input_par_store, 0.0,  &quot;Maximum search radius criterion&quot;, &quot;5*r_out&quot;),</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">r_search_min</a> (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0.0,  <span class="stringliteral">&quot;r-search-min&quot;</span>, <span class="stringliteral">&quot;Minimum neighbor search radius for hard clusters&quot;</span>,<span class="stringliteral">&quot;auto&quot;</span>),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>     (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, PS::LARGE_FLOAT,  <span class="stringliteral">&quot;r-escape&quot;</span>, <span class="stringliteral">&quot;Escape radius criterion, 0: no escaper removal; &lt;0: remove particles when r&gt;-r_escape; &gt;0: remove particles when r&gt;r_escape and energy&gt;0&quot;</span>),</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>    (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1e-4, <span class="stringliteral">&quot;slowdown-factor&quot;</span>, <span class="stringliteral">&quot;Slowdown perturbation criterion&quot;</span>),</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>  (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1,    <span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;Data read(r)/write(w) format BINARY(B)/ASCII(A): r-B/w-A (3), r-A/w-B (2), rw-A (1), rw-B (0)&quot;</span>),</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>  (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1,    <span class="stringliteral">&quot;w&quot;</span>, <span class="stringliteral">&quot;File writing style: 0, no output; 1. write snapshots, status, and profile separately; 2. write snapshot and status in one line per step (no MPI support); 3. write only status and profile&quot;</span>),</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;#ifdef STELLAR_EVOLUTION</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;#ifdef BSE_BASE</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                     stellar_evolution_option  (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1, <span class="stringliteral">&quot;stellar-evolution&quot;</span>, <span class="stringliteral">&quot;Stellar evolution of stars in Hermite+SDAR: 0: off; &gt;=1: using SSE/BSE based codes; ==2: activate dynamical tide and hyperbolic gravitational wave radiation&quot;</span>),</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1, <span class="stringliteral">&quot;detect-interrupt&quot;</span>, <span class="stringliteral">&quot;Stellar evolution of binaries in SDAR: 0: off; 1: using BSE based code (if &#39;--stellar-evolution != 0)&quot;</span>),</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;#else</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                     stellar_evolution_option  (<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0, <span class="stringliteral">&quot;stellar-evolution&quot;</span>, <span class="stringliteral">&quot;Not implemented&quot;</span>),</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0, <span class="stringliteral">&quot;detect-interrupt&quot;</span>, <span class="stringliteral">&quot;Interrupt integration in SDAR: 0: turn off; 1: merge two particles if their surfaces overlap; 2. merge two particles and also interrupt the hard integration&quot;</span>),</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;#endif</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;#else</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 0, <span class="stringliteral">&quot;detect-interrupt&quot;</span>, <span class="stringliteral">&quot;Modify orbits of AR groups based on the interruption function: 0: turn off; 1: modify inside AR integration and accumulate energy change; 2. modify and also interrupt the hard drift&quot;</span>),</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;#endif</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;#ifdef ADJUST_GROUP_PRINT</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                     adjust_group_write_option(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1, <span class="stringliteral">&quot;write-group-info&quot;</span>, <span class="stringliteral">&quot;Print new and end of groups: 0: no print; 1: print to file [data filename prefix].group.[MPI rank] if -w &gt;0&quot;</span>),</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;#endif</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, 1, <span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;Data output style: 0 - create new output files and overwrite existing ones except snapshots; 1 - append new data to existing files&quot;</span>),</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, <span class="stringliteral">&quot;data&quot;</span>, <span class="stringliteral">&quot;f&quot;</span>, <span class="stringliteral">&quot;Prefix of filenames for output data: [prefix].**&quot;</span>),</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, <span class="stringliteral">&quot;input.par&quot;</span>, <span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;Input parameter file (this option should be used first before any other options)&quot;</span>),</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>(<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>, <span class="stringliteral">&quot;__NONE__&quot;</span>, <span class="stringliteral">&quot;snap-filename&quot;</span>, <span class="stringliteral">&quot;Input data file&quot;</span>, NULL, false),</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                     <a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>(false), <a class="code" href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">update_changeover_flag</a>(false), <a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a>(false) {}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#aa428da858ec3e53058edeb77b9412075">  225</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classIOParamsPeTar.html#aa428da858ec3e53058edeb77b9412075">read</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[], <span class="keyword">const</span> <span class="keywordtype">int</span> opt_used_pre=0) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">static</span> <span class="keywordtype">int</span> petar_flag=-1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keyword">static</span> <span class="keyword">struct </span>option long_options[] = {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#ifdef ORBIT_SAMPLING</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            {n_split.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,              required_argument, &amp;petar_flag, 0},        </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,    required_argument, &amp;petar_flag, 1},  </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>, required_argument, &amp;petar_flag, 2},  </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>, required_argument, &amp;petar_flag, 3}, </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,        required_argument, &amp;petar_flag, 4},</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,         required_argument, &amp;petar_flag, 5},</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,            required_argument, &amp;petar_flag, 6},</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,             required_argument, &amp;petar_flag, 7}, </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,                  required_argument, &amp;petar_flag, 8},       </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,            required_argument, &amp;petar_flag, 9},</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,          required_argument, &amp;petar_flag, 10},</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,                required_argument, &amp;petar_flag, 11},       </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,   required_argument, &amp;petar_flag, 12}, </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,                  required_argument, &amp;petar_flag, 13}, </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            {e_err_hard.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,           required_argument, &amp;petar_flag, 14},  </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">step_limit_ar</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,        required_argument, &amp;petar_flag, 15},   </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            {<span class="stringliteral">&quot;disable-print-info&quot;</span>,     no_argument,       &amp;petar_flag, 16},</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,    required_argument, &amp;petar_flag, 17},</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,  required_argument, &amp;petar_flag, 18},</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,     required_argument, &amp;petar_flag, 19},</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            {stellar_evolution_option.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,    required_argument, &amp;petar_flag, 20},</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,             required_argument, &amp;petar_flag, 21},</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">r_search_min</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,         required_argument, &amp;petar_flag, 22},</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">id_offset</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,            required_argument, &amp;petar_flag, 23},</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#ifdef ADJUST_GROUP_PRINT</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            {adjust_group_write_option.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,   required_argument, &amp;petar_flag, 24},</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif            </span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            {<a class="code" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">nstep_dt_soft_kepler</a>.<a class="code" href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">key</a>,  required_argument, &amp;petar_flag, 25},</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            {<span class="stringliteral">&quot;help&quot;</span>,                  no_argument, 0, <span class="charliteral">&#39;h&#39;</span>},        </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            {0,0,0,0}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        };</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordtype">int</span> opt_used = opt_used_pre;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keywordtype">int</span> copt;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordtype">int</span> option_index;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        optind = 0; <span class="comment">// reset getopt</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">while</span> ((copt = getopt_long(argc, argv, <span class="stringliteral">&quot;-i:a:t:s:o:r:b:n:G:u:T:f:p:w:h&quot;</span>, long_options, &amp;option_index)) != -1) </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">switch</span> (copt) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <span class="keywordflow">switch</span> (petar_flag) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="preprocessor">#ifdef ORBIT_SAMPLING</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    n_split.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) n_split.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                    assert(n_split.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> &gt; 0.0);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> &gt; 0);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> &gt; 0.0);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <span class="keywordflow">case</span> 9:</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="keywordflow">case</span> 10:</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">update_changeover_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;1.0);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                <span class="keywordflow">case</span> 11:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordflow">case</span> 12:</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=1.0);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordflow">case</span> 13:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordflow">case</span> 14:</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    e_err_hard.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) e_err_hard.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                <span class="keywordflow">case</span> 15:</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">step_limit_ar</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">step_limit_ar</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                <span class="keywordflow">case</span> 16:</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    opt_used ++;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <span class="keywordflow">case</span> 17:</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">case</span> 18:</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">case</span> 19:</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    assert(<a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=1.0);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                <span class="keywordflow">case</span> 20:</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    stellar_evolution_option.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) stellar_evolution_option.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="keywordflow">case</span> 21:</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                <span class="keywordflow">case</span> 22:</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">r_search_min</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">r_search_min</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="keywordflow">case</span> 23:</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">id_offset</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">id_offset</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#ifdef ADJUST_GROUP_PRINT</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                <span class="keywordflow">case</span> 24:</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    adjust_group_write_option.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) adjust_group_write_option.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <span class="keywordflow">case</span> 25:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">nstep_dt_soft_kepler</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">nstep_dt_soft_kepler</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                    opt_used += 2;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;i&#39;</span>:</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0&amp;&amp;<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;=3);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>=atoi(optarg);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0&amp;&amp;<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;=1);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">update_changeover_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atol(optarg);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;G&#39;</span>:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                <a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;u&#39;</span>:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                <a class="code" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">unit_set</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">unit_set</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">unit_set</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;T&#39;</span>:</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atof(optarg);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                assert(<a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;f&#39;</span>:</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = optarg;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span>:</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = optarg;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                    FILE* fpar_in;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    <span class="keywordflow">if</span>( (fpar_in = fopen(<a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>.c_str(),<span class="stringliteral">&quot;r&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                        fprintf(stderr,<span class="stringliteral">&quot;Error: Cannot open file %s.\n&quot;</span>, <a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>.c_str());</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                        abort();</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a972926da32b4043d06456ab6d35d7752">readAscii</a>(fpar_in);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                    fclose(fpar_in);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>.mpi_broadcast();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;w&#39;</span>:</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = atoi(optarg);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) <a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">print</a>(std::cout);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                opt_used += 2;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span>:</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>){</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;Usage: petar [option] filename&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;       filename: initial or restart data (snapshot) filename\n&quot;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;       Data file content:\n&quot;</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;            First line: \n&quot;</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;             1. File_ID: 0 for initialization, else for restarting\n&quot;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;             2. N_particle \n&quot;</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;             3. Time\n&quot;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;             4-6: offset of system centeral position (assuming galactic center is the coordiante origin in the case of Galpy)\n&quot;</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;             7-9: offset of system centeral velocity\n&quot;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;            Following lines:\n&quot;</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                    <a class="code" href="classFPSoft.html#aca3236af1ccb822b51a0cb4acb2ab678">FPSoft::printTitleWithMeaning</a>(std::cout,0,13);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;          PS: (*) show initialization values which should be used together with FILE_ID = 0&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;              [formatted] indicates that the value is only for save, cannot be directly read&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;Options:\n&quot;</span>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    <a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a8bdebaa655392813c07b0dd4ae6469c2">printHelp</a>(std::cout, 2, 10, 23);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;        --disable-print-info:  &quot;</span>&lt;&lt;<span class="stringliteral">&quot;Do not print information&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;        --disable-write-info:  &quot;</span>&lt;&lt;<span class="stringliteral">&quot;Do not write information&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;  -h(--help):               print help&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    std::cout&lt;&lt;<span class="stringliteral">&quot;*** PS: dt_soft: tree time step\n&quot;</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;        r_in : transit function inner boundary radius\n&quot;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;        r_out: transit function outer boundary radius\n&quot;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;        sigma: half-mass radius velocity dispersion\n&quot;</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;        n_bin: number of primordial binaries\n&quot;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                             &lt;&lt;<span class="stringliteral">&quot;        &lt;m&gt;  : averaged mass&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;?&#39;</span>:</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                opt_used +=2;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="comment">// count used options</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        opt_used ++;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">//std::cout&lt;&lt;&quot;Opt used:&quot;&lt;&lt;opt_used&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">if</span> (opt_used&lt;argc) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> =argv[argc-1];</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) std::cout&lt;&lt;<span class="stringliteral">&quot;Reading data file name: &quot;</span>&lt;&lt;<a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) std::cout&lt;&lt;<span class="stringliteral">&quot;----- Finish reading input options of PeTar -----\n&quot;</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">return</span> opt_used-1;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="classIOParamsPeTar.html#a6126c51ce250b208260fbe6ca073f1ac">  583</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classIOParamsPeTar.html#a6126c51ce250b208260fbe6ca073f1ac">checkParams</a>() {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">#ifdef ORBIT_SAMPLING</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        assert(n_split.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> &gt; 0.0);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> &gt; 0);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> &gt; 0.0);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0 &amp;&amp; <a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;=<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>); <span class="comment">// avoid incorrect self-potential correction after tree force, when eps&gt;r_out, self-potential is G m /r_eps instead of G m/r_cut;</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;1.0);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=1.0);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0||<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;=3);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0.0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        assert(<a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0.0);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;};</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="keyword">class </span>PeTar {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">#ifdef USE_QUAD</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keyword">typedef</span> PS::TreeForForceLong&lt;ForceSoft, EPISoft, EPJSoft&gt;::QuadrupoleWithSymmetrySearch TreeForce; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keyword">typedef</span> PS::TreeForForceLong&lt;ForceSoft, EPISoft, EPJSoft&gt;::MonopoleWithSymmetrySearch TreeForce;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keyword">typedef</span> PS::ParticleSystem&lt;FPSoft&gt; <a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="comment">// For neighbor searching</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keyword">typedef</span> PS::TreeForForceShort&lt;ForceSoft, EPISoft, EPJSoft&gt;::Symmetry TreeNB;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// IO</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="classIOParamsPeTar.html">IOParamsPeTar</a> input_parameters;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="classIOParamsBSE.html">IOParamsBSE</a> bse_parameters;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    std::string fbse_par_suffix = <a class="code" href="classBSEManager.html#a52d9f47da0278671ab0aa05281801446">BSEManager::getBSEOutputFilenameSuffix</a>();</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    std::string fsse_par_suffix = <a class="code" href="classBSEManager.html#a69d7169d4261241df2459d3ea3b96492">BSEManager::getSSEOutputFilenameSuffix</a>();</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="preprocessor">#endif // BSE_BASE</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="classIOParamsGalpy.html">IOParamsGalpy</a> galpy_parameters;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> dn_loop;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classSysProfile.html">SysProfile</a> profile;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="classSysCounts.html">SysCounts</a>  n_count;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classSysCounts.html">SysCounts</a>  n_count_sum;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classFDPSProfile.html">FDPSProfile</a>  tree_soft_profile;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <a class="code" href="classFDPSProfile.html">FDPSProfile</a>  tree_nb_profile;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    std::ofstream fprofile;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="classStatus.html">Status</a> stat;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    std::ofstream fstatus;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> time_kick;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// escaper</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <a class="code" href="classEscaper.html">Escaper</a> escaper;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    std::ofstream fesc;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">// file system</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="classFileHeader.html">FileHeader</a> file_header;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a> system_soft;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// particle index map</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    std::map&lt;PS::S64, PS::S32&gt; id_adr_map;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="comment">// domain</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loop; <span class="comment">// count for domain decomposition</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> domain_decompose_weight;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    PS::DomainInfo dinfo;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    PS::F64ort * pos_domain;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="preprocessor">#ifdef FDPS_COMM</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    PS::CommInfo comm_info; <span class="comment">// MPI communicator</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// tree time step manager</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="classKickDriftStep.html">KickDriftStep</a> dt_manager;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// tree</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    TreeNB tree_nb;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    TreeForce tree_soft;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classGalpyManager.html">GalpyManager</a> galpy_manager;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="comment">// hard integrator</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="classHardManager.html">HardManager</a> hard_manager;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="classSystemHard.html">SystemHard</a> system_hard_one_cluster;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="classSystemHard.html">SystemHard</a> system_hard_isolated;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="classSystemHard.html">SystemHard</a> system_hard_connected;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordtype">int</span> n_interrupt_glb;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">// mass change particle list</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    PS::ReallocatableArray&lt;PS::S32&gt; mass_modify_list;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">// remove list</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    PS::ReallocatableArray&lt;PS::S32&gt; remove_list;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    PS::ReallocatableArray&lt;PS::S64&gt; remove_id_record;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_remove;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="comment">// search cluster</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="classSearchCluster.html">SearchCluster</a> search_cluster;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// safety check flag</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">bool</span> read_parameters_flag;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">bool</span> read_data_flag;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordtype">bool</span> initial_parameters_flag;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">bool</span> initial_step_flag;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="comment">// MPI </span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> my_rank;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_proc;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// FPDS flag</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> initial_fdps_flag;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    PeTar(): </div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        input_parameters(),</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;#ifdef BSE_BASE</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        bse_parameters(),</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;#endif</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;#ifdef GALPY</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        galpy_parameters(),</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;#endif</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;#ifdef PROFILE</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="comment">// profile</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        dn_loop(0), profile(), n_count(), n_count_sum(), tree_soft_profile(), fprofile(), </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;#endif</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        stat(), fstatus(), time_kick(0.0),</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        escaper(), fesc(),</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        file_header(), system_soft(), id_adr_map(),</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        n_loop(0), domain_decompose_weight(1.0), dinfo(), pos_domain(NULL), </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        dt_manager(),</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        tree_nb(), tree_soft(), </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;#ifdef GALPY</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        galpy_manager(),</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;#endif</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        hard_manager(), system_hard_one_cluster(), system_hard_isolated(), </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        system_hard_connected(), </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;#endif</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        n_interrupt_glb(0),</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        mass_modify_list(), remove_list(), remove_id_record(),</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        search_cluster(),</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        read_parameters_flag(false), read_data_flag(false), initial_parameters_flag(false), initial_step_flag(false) {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        assert(initial_fdps_flag);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        my_rank = PS::Comm::getRank();</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        n_proc = PS::Comm::getNumberOfProc();</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;     }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> regularTimeStep(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="comment">// regularize dt_tree</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> = 1.0;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordflow">if</span> (_dt&lt;1) <span class="keywordflow">while</span> (<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>&gt;_dt) <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> *= 0.5;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            <span class="keywordflow">while</span> (<a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>&lt;=_dt) <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> *= 2.0;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a> *= 0.5;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordtype">void</span> treeNeighborSearch() {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        profile.<a class="code" href="classSysProfile.html#a08359fc357df49d8df1ccd539b95e195">tree_nb</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        tree_nb.clearNumberOfInteraction();</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        tree_nb.clearTimeProfile();</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="preprocessor">#ifdef USE_SIMD</span></div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        tree_nb.calcForceAllAndWriteBack(SearchNeighborEpEpSimd(), system_soft, dinfo);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#elif USE_FUGAKU</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        tree_nb.calcForceAllAndWriteBack(SearchNeighborEpEpFugaku(), system_soft, dinfo);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        tree_nb.calcForceAllAndWriteBack(<a class="code" href="structSearchNeighborEpEpNoSimd.html">SearchNeighborEpEpNoSimd</a>(), system_soft, dinfo);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        tree_nb_profile += tree_nb.getTimeProfile();</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="comment">//profile.tree_nb.barrier();</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        <span class="comment">//PS::Comm::barrier();</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        profile.<a class="code" href="classSysProfile.html#a08359fc357df49d8df1ccd539b95e195">tree_nb</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        profile.<a class="code" href="classSysProfile.html#a08359fc357df49d8df1ccd539b95e195">tree_nb</a>.<a class="code" href="structTprofile.html#ae076178b36b67a001dcb3519b729b5db">tbar</a> = profile.<a class="code" href="classSysProfile.html#a08359fc357df49d8df1ccd539b95e195">tree_nb</a>.<a class="code" href="structTprofile.html#a08637a9e011800923ded7647915c5487">time</a> - tree_nb_profile.getTotalTime();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordtype">void</span> searchCluster() {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">search_cluster</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// &gt;2.1 search clusters ----------------------------------------</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        search_cluster.<a class="code" href="classSearchCluster.html#a4eed744c2ec88e42a522c2aea48adb14">searchNeighborOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, TreeNB, <a class="code" href="classEPJSoft.html">EPJSoft</a>&gt;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            (system_soft, tree_nb, pos_domain, 1.0, input_parameters.<a class="code" href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">search_peri_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        search_cluster.<a class="code" href="classSearchCluster.html#a41fc2645bb9d6f7feb188d6de0526df4">searchClusterLocal</a>();</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        search_cluster.<a class="code" href="classSearchCluster.html#a7f630465ce2f8ef5d5339c0383600f0e">setIdClusterLocal</a>();</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="comment">// &gt;2.2 Send/receive connect cluster</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        search_cluster.connectNodes(pos_domain,tree_nb);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        search_cluster.setIdClusterGlobalIteration();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        search_cluster.sendAndRecvCluster(system_soft);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">search_cluster</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">search_cluster</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="preprocessor">#endif    </span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordtype">void</span> createGroup(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_tree) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        profile.<a class="code" href="classSysProfile.html#af82213cefaced581c81bb57bf9d6c5f9">create_group</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="comment">// &gt;2.3 Find ARC groups and create artificial particles</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="comment">// Set local ptcl_hard for isolated  clusters</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#aa18476d87a9f3647939b7429899e13bb">setPtclForIsolatedMultiClusterOMP</a>(system_soft, search_cluster.<a class="code" href="classSearchCluster.html#aaa328193a00abba83aec52fa41066843">adr_sys_multi_cluster_isolated_</a>, search_cluster.<a class="code" href="classSearchCluster.html#ae89195308010bf7c79d95e672ed4e793">n_ptcl_in_multi_cluster_isolated_</a>);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">//#ifdef CLUSTER_DEBUG</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">//        for (PS::S32 i=0; i&lt;n_loc; i++) system_soft[i].status = -1000000;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <span class="comment">// Find groups and add artificial particles to global particle system</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#aac43bb3f43f7b3ea6f04efcc40bf11bd">findGroupsAndCreateArtificialParticlesOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, <a class="code" href="classFPSoft.html">FPSoft</a>&gt;(system_soft, _dt_tree);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">//#ifdef CLUSTER_DEBUG</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">//        not correct check, isolated clusters are not reset above</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">//        for (PS::S32 i=0; i&lt;n_loc; i++) {</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">//            if (system_soft[i].status ==-1000000) {</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">//                std::cerr&lt;&lt;&quot;Find un initialized status i=&quot;&lt;&lt;i&lt;&lt;&quot; status=&quot;&lt;&lt;system_soft[i].status&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// update n_loc_iso, n_glb_iso for isolated clusters</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="comment">//PS::S64 n_loc_iso = system_soft.getNumberOfParticleLocal();</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <span class="comment">//PS::S64 n_glb_iso = system_soft.getNumberOfParticleGlobal();</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="comment">// For connected clusters</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a97c75b84d56fedcc0f9a1a3995839ce8">setPtclForConnectedCluster</a>(system_soft, search_cluster.<a class="code" href="classSearchCluster.html#ab4db2590e66759a8cce93e2acd2892fd">mediator_sorted_id_cluster_</a>, search_cluster.<a class="code" href="classSearchCluster.html#a7ec681af7a9dd3a5d464d9efc3c8e8f7">ptcl_recv_</a>);</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#aac43bb3f43f7b3ea6f04efcc40bf11bd">findGroupsAndCreateArtificialParticlesOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, <a class="code" href="classFPSoft.html">FPSoft</a>&gt;(system_soft, _dt_tree);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="comment">// send updated particle back to original (set zero mass particle to origin)</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        search_cluster.writeAndSendBackPtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), mass_modify_list);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        mass_modify_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a0aefe9e642d174f1d8ab04825a3bce3c">updateTimeWriteBack</a>();</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <span class="comment">// update total particle number including artificial particles</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a> = system_soft.getNumberOfParticleLocal();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        stat.<a class="code" href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">n_all_glb</a> = system_soft.getNumberOfParticleGlobal();</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="comment">// &gt;2.4 set adr/rank for artificial particles in GPS</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i&lt;stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a>; i++){</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            system_soft[i].rank_org = my_rank;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;            system_soft[i].adr = i;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            assert(system_soft[i].group_data.artificial.isArtificial());</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="comment">// &gt;3 Tree for force ----------------------------------------</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        profile.<a class="code" href="classSysProfile.html#af82213cefaced581c81bb57bf9d6c5f9">create_group</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        profile.<a class="code" href="classSysProfile.html#af82213cefaced581c81bb57bf9d6c5f9">create_group</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordtype">void</span> treeSoftForce() {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        tree_soft.clearNumberOfInteraction();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        tree_soft.clearTimeProfile();</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_walk_limit = 200;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> tag_max = 1;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> eps2 = <a class="code" href="classEPISoft.html#a1aa7e04f972b62365f20272e926ecbdc">EPISoft::eps</a>*<a class="code" href="classEPISoft.html#a1aa7e04f972b62365f20272e926ecbdc">EPISoft::eps</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> rout2 = <a class="code" href="classEPISoft.html#ad680f261dc954c1771bd1446d3289e4b">EPISoft::r_out</a>*<a class="code" href="classEPISoft.html#ad680f261dc954c1771bd1446d3289e4b">EPISoft::r_out</a>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> G= <a class="code" href="classForceSoft.html#acbd19675019ce01e03779282bf9d2d5d">ForceSoft::grav_const</a>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_GPU_MULIT_WALK_INDEX</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        tree_soft.calcForceAllAndWriteBackMultiWalkIndex(CalcForceWithLinearCutoffCUDAMultiWalk(my_rank, eps2, rout2, G),</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                                         <a class="code" href="force__gpu__cuda_8hpp.html#aedbe85337286f7c675e64a36cb78d099">RetrieveForceCUDA</a>,</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                                                         tag_max,</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                                                         system_soft,</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                                                         dinfo,</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                                                         n_walk_limit);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">#else // no multi-walk index</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        tree_soft.calcForceAllAndWriteBackMultiWalk(<a class="code" href="structCalcForceWithLinearCutoffCUDA.html">CalcForceWithLinearCutoffCUDA</a>(my_rank, eps2, rout2, G),</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                                    <a class="code" href="force__gpu__cuda_8hpp.html#aedbe85337286f7c675e64a36cb78d099">RetrieveForceCUDA</a>,</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                                    tag_max,</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                                    system_soft,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                                    dinfo,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                                    n_walk_limit);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">#endif // multi-walk index</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#elif USE_FUGAKU</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> eps2 = <a class="code" href="classEPISoft.html#a1aa7e04f972b62365f20272e926ecbdc">EPISoft::eps</a>*<a class="code" href="classEPISoft.html#a1aa7e04f972b62365f20272e926ecbdc">EPISoft::eps</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> rout2 = <a class="code" href="classEPISoft.html#ad680f261dc954c1771bd1446d3289e4b">EPISoft::r_out</a>*<a class="code" href="classEPISoft.html#ad680f261dc954c1771bd1446d3289e4b">EPISoft::r_out</a>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> G= <a class="code" href="classForceSoft.html#acbd19675019ce01e03779282bf9d2d5d">ForceSoft::grav_const</a>;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        tree_soft.calcForceAllAndWriteBack(CalcForceEpEpWithLinearCutoffFugaku(eps2, rout2, G),</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;#ifdef USE_QUAD</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                           CalcForceEpSpQuadFugaku(eps2, G),</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;#<span class="keywordflow">else</span> <span class="comment">// no quad</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                                           CalcForceEpSpMonoFugaku(eps2, G),</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;#endif <span class="comment">// end quad</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                                           system_soft,</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                                           dinfo);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="preprocessor">#elif USE_SIMD // end use_gpu</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        tree_soft.calcForceAllAndWriteBack(CalcForceEpEpWithLinearCutoffSimd(),</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;#ifdef USE_QUAD</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                           CalcForceEpSpQuadSimd(),</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;#<span class="keywordflow">else</span> <span class="comment">// no quad</span></div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                           CalcForceEpSpMonoSimd(),</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;#endif <span class="comment">// end quad</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                                           system_soft,</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                                           dinfo);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="preprocessor">#else // end use_simd</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        tree_soft.calcForceAllAndWriteBack(<a class="code" href="structCalcForceEpEpWithLinearCutoffNoSimd.html">CalcForceEpEpWithLinearCutoffNoSimd</a>(),</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;#ifdef USE_QUAD</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                                           <a class="code" href="structCalcForceEpSpQuadNoSimd.html">CalcForceEpSpQuadNoSimd</a>(),</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                           <a class="code" href="structCalcForceEpSpMonoNoSimd.html">CalcForceEpSpMonoNoSimd</a>(),</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;#endif</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                                           system_soft,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                                           dinfo);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="preprocessor">#endif // end else</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        n_count.<a class="code" href="classSysCounts.html#ab1502b63dd0b38cfe55826932eb410b2">ep_ep_interact</a>     += tree_soft.getNumberOfInteractionEPEPLocal();</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#ab1502b63dd0b38cfe55826932eb410b2">ep_ep_interact</a> += tree_soft.getNumberOfInteractionEPEPGlobal();</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a9b18829f0e2260f853f82d4353a26140">ep_sp_interact</a>     += tree_soft.getNumberOfInteractionEPSPLocal();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a9b18829f0e2260f853f82d4353a26140">ep_sp_interact</a> += tree_soft.getNumberOfInteractionEPSPGlobal(); </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        tree_soft_profile += tree_soft.getTimeProfile();</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        domain_decompose_weight = tree_soft_profile.calc_force;</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="comment">//profile.tree_soft.barrier();</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="comment">//PS::Comm::barrier();</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#ae076178b36b67a001dcb3519b729b5db">tbar</a> = profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#a08637a9e011800923ded7647915c5487">time</a> - tree_soft_profile.getTotalTime();</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordtype">void</span> treeForceCorrectChangeoverTreeNeighbor() {</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <span class="comment">// all particles</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        SystemHard::correctForceWithCutoffTreeNeighborOMP&lt;SystemSoft, FPSoft, TreeForce, EPJSoft&gt;(system_soft, tree_soft, system_soft.getNumberOfParticleLocal(), hard_manager.<a class="code" href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">ap_manager</a>);        </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordtype">void</span> treeForceCorrectChangeover() {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="preprocessor">#ifdef CORRECT_FORCE_DEBUG</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="comment">// backup particle data</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc_all = system_soft.getNumberOfParticleLocal();</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="classFPSoft.html">FPSoft</a> psys_bk[n_loc_all];</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_loc_all; i++) </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            psys_bk[i] = system_soft[i];</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="comment">// single </span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#ad15b5a9f60e73df248ce6e68512e791d">correctPotWithCutoffOMP</a>(system_soft, search_cluster.<a class="code" href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">getAdrSysOneCluster</a>());</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="comment">// Isolated clusters</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#a014acbefdcaa7a3db1cf6d043b7b519c">correctForceWithCutoffClusterOMP</a>(system_soft);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="comment">// Connected clusters</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a4f4cc338a1ecb9b1e2530a9a0ec0f68b">correctForceWithCutoffTreeNeighborAndClusterOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, <a class="code" href="classFPSoft.html">FPSoft</a>, TreeForce, <a class="code" href="classEPJSoft.html">EPJSoft</a>&gt;(system_soft, tree_soft, search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>());</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="preprocessor">#ifdef CORRECT_FORCE_DEBUG</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="comment">// switch backup and sys particle data</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_loc_all; i++) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <a class="code" href="classFPSoft.html">FPSoft</a> ptmp = psys_bk[i];</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            psys_bk[i] = system_soft[i];</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            system_soft[i] = ptmp;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="comment">// all particles</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        SystemHard::correctForceWithCutoffTreeNeighborOMP&lt;SystemSoft, FPSoft, TreeForce, EPJSoft&gt;(system_soft, tree_soft, n_loc, hard_manager.<a class="code" href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">ap_manager</a>);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="comment">// single </span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="comment">//system_hard_one_cluster.correctPotWithCutoffOMP(system_soft, search_cluster.getAdrSysOneCluster());</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        <span class="comment">// Isolated clusters</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="comment">//system_hard_isolated.correctForceWithCutoffTreeNeighborOMP&lt;SystemSoft, FPSoft, TreeForce, EPJSoft&gt;(system_soft, tree_soft, n_loc);</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">//#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">//        // Connected clusters</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">//        system_hard_connected.correctForceWithCutoffTreeNeighborOMP&lt;SystemSoft, FPSoft, TreeForce, EPJSoft&gt;(system_soft, tree_soft, n_loc_all);</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_loc_all; i++) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> dacci=psys_bk[i].<a class="code" href="classFPSoft.html#a234b9ee456887b70ff9f31c7cc960b50">acc</a>- system_soft[i].acc;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dpoti = psys_bk[i].<a class="code" href="classFPSoft.html#a68e7765addbb0746733c24c373c15075">pot_tot</a>- system_soft[i].pot_tot;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">if</span>(dacci*dacci/(system_soft[i].acc*system_soft[i].acc)&gt;1e-8) {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Corrected Acc diff &gt;1e-8: i &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; acc(tree): &quot;</span>&lt;&lt;system_soft[i].acc&lt;&lt;<span class="stringliteral">&quot; acc(cluster): &quot;</span>&lt;&lt;psys_bk[i].<a class="code" href="classFPSoft.html#a234b9ee456887b70ff9f31c7cc960b50">acc</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                abort();</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="comment">// Notice, the cluster members can include particles are not in the tree neighbor searching. If the extra neighbors in clusters are group members. The correct from clusters will be more accurate than tree neighbor correction. Since the potential is calculated from the real members instead of artificial particles. This can result in different potential</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordflow">if</span>(abs(dpoti/system_soft[i].pot_tot)&gt;1e-6) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Corrected pot diff &gt;1e-6: i &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; pot(tree): &quot;</span>&lt;&lt;system_soft[i].pot_tot&lt;&lt;<span class="stringliteral">&quot; pot(cluster): &quot;</span>&lt;&lt;psys_bk[i].<a class="code" href="classFPSoft.html#a68e7765addbb0746733c24c373c15075">pot_tot</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                abort();</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    }</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordtype">void</span> externalForce() {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="comment">// external force and potential</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;        <span class="comment">// update the types and arguments </span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#a2b9c41229c1b4a6d5c06e18017298357">updatePotential</a>(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#accd0a3c5a62b628e4a9e002f8ec10ad4">resetPotAcc</a>();</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#a60bef4e78023b1dc281e6cb2cffd813e">calcMovePotAccFromPot</a>(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, &amp;stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>[0]);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc_all = system_soft.getNumberOfParticleLocal();</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_loc_all; i++) {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keyword">auto</span>&amp; pi = system_soft[i];</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            <span class="keywordtype">double</span> acc[3], pot;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> pos_correct=pi.pos + stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            galpy_manager.<a class="code" href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824">calcAccPot</a>(acc, pot, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>*pi.mass, &amp;pos_correct[0], &amp;pi.pos[0]);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;            <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> pos_center=pi.pos - stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;            galpy_manager.<a class="code" href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824">calcAccPot</a>(acc, pot, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>*pi.mass, &amp;pi.pos[0], &amp;pos_center[0]);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            assert(!std::isinf(acc[0]));</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;            assert(!std::isnan(acc[0]));</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            assert(!std::isinf(pot));</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            assert(!std::isnan(pot));</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            pi.acc[0] += acc[0]; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            pi.acc[1] += acc[1]; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            pi.acc[2] += acc[2]; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            pi.pot_tot += pot;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;            pi.pot_soft += pot;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor">#ifdef EXTERNAL_POT_IN_PTCL</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            pi.pot_ext = pot;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="preprocessor">#endif //GALPY</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="comment">// correct c.m. vel due to external potential to avoid large rsearch </span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">void</span> correctPtclVelCM(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; _dt) {</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> dv=<a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a>(0.0);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> acc;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> pot;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="comment">// evaluate center of mass acceleration</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> pos_zero=<a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a>(0.0);</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="comment">// set zero mass to avoid duplicate anti force to potential set</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824">calcAccPot</a>(&amp;acc[0], pot, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, 0, &amp;stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>[0], &amp;pos_zero[0]);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        dv = acc*_dt;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="preprocessor">#endif        </span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a> += dv;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a>; i++) system_soft[i].vel -= dv;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">//auto&amp; adr = search_cluster.getAdrSysOneCluster();</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="comment">//for (int i=0; i&lt;adr.size(); i++) system_soft[adr[i]].vel -= dv;</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keyword">auto</span>&amp; ptcl_iso=system_hard_isolated.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>();</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ptcl_iso.size(); i++) ptcl_iso[i].vel -= dv;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="comment">//const PS::S64 n_tot= system_soft.getNumberOfParticleLocal();</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="comment">//const PS::S32 n_artifical_per_group = hard_manager.ap_manager.getArtificialParticleN();</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="comment">//for(PS::S32 i=stat.n_real_loc; i&lt;n_tot; i+= n_artifical_per_group) {</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="comment">//    auto* pcm = hard_manager.ap_manager.getCMParticles(&amp;(system_soft[i]));</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="comment">//    pcm-&gt;vel -= dv;</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="comment">//}        </span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keyword">auto</span>&amp; ptcl_con=system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>();</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;ptcl_con.size(); i++) ptcl_con[i].vel -= dv;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="comment">//Ptcl::vel_cm += dv;</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">//#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">//        if (my_rank==0) std::cerr&lt;&lt;&quot;Ptcl::vel_cm: &quot;&lt;&lt;Ptcl::vel_cm&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordtype">void</span> GradientKick() {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        tree_soft.clearNumberOfInteraction();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        tree_soft.clearTimeProfile();</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">// correction calculation</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="comment">//tree_soft.setParticaleLocalTree(system_soft, false);</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        </div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        tree_soft.calcForceAllAndWriteBack(CalcCorrectEpEpWithLinearCutoffNoSimd(),</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;#ifdef USE_QUAD</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                                           <a class="code" href="structCalcForceEpSpQuadNoSimd.html">CalcForceEpSpQuadNoSimd</a>(),</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;#<span class="keywordflow">else</span></div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                                           <a class="code" href="structCalcForceEpSpMonoNoSimd.html">CalcForceEpSpMonoNoSimd</a>(),</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;#endif</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                           system_soft,</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                           dinfo);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        n_count.<a class="code" href="classSysCounts.html#ab1502b63dd0b38cfe55826932eb410b2">ep_ep_interact</a>     += tree_soft.getNumberOfInteractionEPEPLocal();</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#ab1502b63dd0b38cfe55826932eb410b2">ep_ep_interact</a> += tree_soft.getNumberOfInteractionEPEPGlobal();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a9b18829f0e2260f853f82d4353a26140">ep_sp_interact</a>     += tree_soft.getNumberOfInteractionEPSPLocal();</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a9b18829f0e2260f853f82d4353a26140">ep_sp_interact</a> += tree_soft.getNumberOfInteractionEPSPGlobal(); </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160; </div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        tree_soft_profile += tree_soft.getTimeProfile();</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        domain_decompose_weight += tree_soft_profile.calc_force;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160; </div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        profile.<a class="code" href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">tree_soft</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="comment">// Isolated clusters</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#a014acbefdcaa7a3db1cf6d043b7b519c">correctForceWithCutoffClusterOMP</a>(system_soft, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="comment">// Connected clusters</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a4f4cc338a1ecb9b1e2530a9a0ec0f68b">correctForceWithCutoffTreeNeighborAndClusterOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, <a class="code" href="classFPSoft.html">FPSoft</a>, TreeForce, <a class="code" href="classEPJSoft.html">EPJSoft</a>&gt;(system_soft, tree_soft, search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160; </div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="comment">//        if (true) {</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160; </div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="comment">// for debug</span></div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="comment">//            FILE* fdump;</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">//            if ( (fdump = fopen(&quot;acorr.dump&quot;,&quot;w&quot;)) == NULL) {</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">//                fprintf(stderr,&quot;Error: Cannot open file acorr.dump\n&quot;);</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">//                abort();</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">//            for (int i=0; i&lt;n_loc; i++) {</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="comment">//                fprintf(fdump, &quot;%d %.12g %.12g %.12g %.12g %.12g %.12g\n&quot;, i, system_soft[i].acc[0], system_soft[i].acc[1], system_soft[i].acc[2], system_soft[i].acorr[0], system_soft[i].acorr[1], system_soft[i].acorr[2]);</span></div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="comment">//            fclose(fdump);</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="comment">//            abort();</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="comment">// debug</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="comment">//            }</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    <span class="comment">/* modify the velocity of particle in global system</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="comment">       reset particle type to single</span></div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="comment">       @param[in,out] _sys: particle system</span></div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="comment">       @param[in]: _dt: tree step</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="comment">       @param[in]; _adr: address for single particles</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordtype">void</span> kickOne(<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a> &amp; _sys, </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                 <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt, </div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                 <span class="keyword">const</span> PS::ReallocatableArray&lt;PS::S32&gt;&amp; _adr) {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n= _adr.size();</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n; i++){</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> k=_adr[i];</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            _sys[k].vel  += _dt*(_sys[k].acc + 9.0/192.0*_dt*_dt*_sys[k].acorr); </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            _sys[k].vel  += _sys[k].acc * _dt;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;            _sys[k].group_data.artificial.setParticleTypeToSingle();</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> Tptcl&gt;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordtype">void</span> kickClusterAndRecoverGroupMemberMass(<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>&amp; _sys,</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                                              PS::ReallocatableArray&lt;Tptcl&gt;&amp; _ptcl,</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt) {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        assert(<a class="code" href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a> == <a class="code" href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da13fd1a10d5921e99bd06b81590017ed6">GroupDataMode::artificial</a>);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n= _ptcl.size();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n; i++) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;            <span class="keyword">auto</span>&amp; pi_artificial = _ptcl[i].group_data.artificial;</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            <span class="comment">// if is group member, recover mass and kick due to c.m. force</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="keywordflow">if</span> (pi_artificial.isMember()) {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> cm_adr = _ptcl[i].getParticleCMAddress(); </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                <span class="keywordflow">if</span> (cm_adr&gt;0) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                    assert(pi_artificial.getMassBackup()&gt;0); </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    assert(cm_adr&lt;stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a>);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    _ptcl[i].mass = pi_artificial.getMassBackup();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                    _ptcl[i].vel  += _dt*(_sys[cm_adr].acc + 9.0/192.0*_dt*_dt*_sys[cm_adr].acorr); </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="preprocessor">#ifdef NAN_CHECK_DEBUG</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                    assert(!std::isnan(_sys[cm_adr].acc[0]));</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                    assert(!std::isnan(_sys[cm_adr].acc[1]));</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                    assert(!std::isnan(_sys[cm_adr].acc[2]));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                    _ptcl[i].vel += _sys[cm_adr].acc * _dt;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;            <span class="comment">// non-member particle</span></div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_adr =_ptcl[i].adr_org;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            <span class="keywordflow">if</span>(i_adr&gt;=0) {</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                <span class="comment">// not remote particles</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                assert(pi_artificial.getStatus()==_sys[i_adr].group_data.artificial.getStatus());</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                _ptcl[i].vel  += _dt*(_sys[i_adr].acc + 9.0/192.0*_dt*_dt*_sys[i_adr].acorr); </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                _ptcl[i].vel += _sys[i_adr].acc * _dt;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        }</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordtype">void</span> kickSend(<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>&amp; _sys,</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                  <span class="keyword">const</span> PS::ReallocatableArray&lt;PS::S32&gt;&amp; _adr_ptcl_send,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        assert(<a class="code" href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a> == <a class="code" href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da13fd1a10d5921e99bd06b81590017ed6">GroupDataMode::artificial</a>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n= _adr_ptcl_send.size();</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n; i++) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> adr = _adr_ptcl_send[i];</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="comment">// if it is group member with artificial particles, should not do kick since the required c.m. forces is on remote nodes;</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            <span class="comment">// if it is group member without artificial particles, also kick</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <span class="keywordflow">if</span>(_sys[adr].group_data.artificial.isSingle() || (_sys[adr].group_data.artificial.isMember() &amp;&amp; _sys[adr].getParticleCMAddress()&lt;0)) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                _sys[adr].vel += _sys[adr].acc * _dt;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                _sys[adr].vel += _dt*_dt* _sys[adr].acorr /48; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keywordflow">if</span>(_sys[adr].group_data.artificial.isSingle()) assert(_sys[adr].mass&gt;0);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="keywordflow">else</span> assert(_sys[adr].group_data.artificial.getMassBackup()&gt;0);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordtype">void</span> kickCM(<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>&amp; _sys,</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> _adr_artificial_start,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                <a class="code" href="classArtificialParticleManager.html">ArtificialParticleManager</a>&amp; _ap_manager,</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt) {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_tot= _sys.getNumberOfParticleLocal();</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_artifical_per_group = _ap_manager.<a class="code" href="classArtificialParticleManager.html#aef4de2cdc22768a36abee8243f0db707">getArtificialParticleN</a>();</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=_adr_artificial_start; i&lt;n_tot; i+= n_artifical_per_group) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keyword">auto</span>* pcm = _ap_manager.<a class="code" href="classArtificialParticleManager.html#ac3c6685d320c92bc37b697d6cd791db0">getCMParticles</a>(&amp;(_sys[i]));</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            pcm-&gt;vel += pcm-&gt;acc * _dt;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            pcm-&gt;vel += _dt*_dt* pcm-&gt;acorr /48; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            assert(pcm-&gt;group_data.artificial.isCM());</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        }</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    }</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <span class="keywordtype">void</span> driftSingle(<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a> &amp; system,</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                     <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>){</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n = system.getNumberOfParticleLocal();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n; i++){</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            <span class="keywordflow">if</span>(system[i].n_ngb &lt;= 0){</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                system[i].pos  += system[i].vel * <a class="code" href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">dt</a>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">//#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="comment">// shift time interrupt in order to get consistent time for stellar evolution in the next drift</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="comment">//system[i].time_record    -= dt;</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;                <span class="comment">//system[i].time_interrupt -= dt;</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            }</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    }</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    <span class="keywordtype">void</span> kick(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_kick) {</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae6945bf42298b0c257b745921f4dcd4b">kick</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="comment">// single and reset particle type to single (due to binary disruption)</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        kickOne(system_soft, _dt_kick, search_cluster.<a class="code" href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">getAdrSysOneCluster</a>());</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        <span class="comment">// isolated</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        kickClusterAndRecoverGroupMemberMass(system_soft, system_hard_isolated.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), _dt_kick);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="comment">// c.m. artificial</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        kickCM(system_soft, stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>, hard_manager.<a class="code" href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">ap_manager</a>, _dt_kick);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        <span class="comment">// connected</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        kickClusterAndRecoverGroupMemberMass(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), _dt_kick);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="comment">// sending list for connected clusters</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        kickSend(system_soft, search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>(), _dt_kick);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="comment">// send kicked particle from sending list, and receive remote single particle</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        search_cluster.SendSinglePtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>());</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da">kickMovePot</a>(_dt_kick);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160; </div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="comment">// correct Ptcl:vel_cm</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        correctPtclVelCM(_dt_kick);</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160; </div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        time_kick += _dt_kick;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> kick_regist[stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>];</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) kick_regist[i] = 0;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;search_cluster.<a class="code" href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">getAdrSysOneCluster</a>().size(); i++) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            kick_regist[search_cluster.<a class="code" href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">getAdrSysOneCluster</a>()[i]]++;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;system_hard_isolated.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>().size(); i++) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> adr= system_hard_isolated.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>()[i].adr_org;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            assert(adr&gt;=0);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            kick_regist[adr]++;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        }</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>().size(); i++) {</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;            <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> adr= system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>()[i].adr_org;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            <span class="keywordflow">if</span>(adr&gt;=0) kick_regist[adr]++;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>().size(); i++) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> adr= search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>()[i];</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            kick_regist[adr]++;</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            assert(kick_regist[i]==1);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        }</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae6945bf42298b0c257b745921f4dcd4b">kick</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae6945bf42298b0c257b745921f4dcd4b">kick</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    }</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> drift(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_drift) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        <span class="comment">//system_hard_one_cluster.setTimeOrigin(stat.time);</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="comment">//system_hard_isolated.setTimeOrigin(stat.time);</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="comment">//system_hard_connected.setTimeOrigin(stat.time);</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        profile.<a class="code" href="classSysProfile.html#a5d93b0ea4c88be1d3e320b7dc9fd6002">hard_single</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#a8baaff00777996341313a1ca786a0e31">initializeForOneCluster</a>(search_cluster.<a class="code" href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">getAdrSysOneCluster</a>().size());</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#af79104a101a84b34ddfa0d87694fcb3b">setPtclForOneClusterOMP</a>(system_soft, search_cluster.<a class="code" href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">getAdrSysOneCluster</a>());</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#a988c41fbd9c555adbaa705d01be4fd86">driveForOneClusterOMP</a>(_dt_drift);</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="comment">//system_hard_one_cluster.writeBackPtclForOneClusterOMP(system_soft, search_cluster.getAdrSysOneCluster());</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#a7c2326950585e3ca686ac07faff7f246">writeBackPtclForOneClusterOMP</a>(system_soft, mass_modify_list);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        profile.<a class="code" href="classSysProfile.html#a5d93b0ea4c88be1d3e320b7dc9fd6002">hard_single</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        profile.<a class="code" href="classSysProfile.html#a5d93b0ea4c88be1d3e320b7dc9fd6002">hard_single</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        profile.<a class="code" href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">hard_isolated</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="comment">// reset slowdown energy correction</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        system_hard_isolated.energy.resetEnergyCorrection();</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">// integrate multi cluster A</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#a54fe61854b07e077f41c55e52af4035c">driveForMultiClusterOMP</a>(_dt_drift, &amp;(system_soft[0]));</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="comment">//system_hard_isolated.writeBackPtclForMultiCluster(system_soft, search_cluster.adr_sys_multi_cluster_isolated_,remove_list);</span></div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_interrupt_isolated = system_hard_isolated.<a class="code" href="classSystemHard.html#ad981cab6e696a124b003289878094386">getNumberOfInterruptClusters</a>();</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">if</span>(n_interrupt_isolated==0) system_hard_isolated.<a class="code" href="classSystemHard.html#aa4aebe7d712e02085a411e85618d6f12">writeBackPtclForMultiCluster</a>(system_soft, mass_modify_list);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;        <span class="comment">// integrate multi cluster A</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_isolated;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        profile.<a class="code" href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">hard_isolated</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        n_interrupt_glb = PS::Comm::getSum(n_interrupt_isolated);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor">#else </span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        n_interrupt_glb = n_interrupt_isolated;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_glb;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        profile.<a class="code" href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">hard_isolated</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        <span class="comment">// reset slowdown energy correction</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        system_hard_connected.energy.resetEnergyCorrection();</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        <span class="comment">// integrate multi cluster B</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a54fe61854b07e077f41c55e52af4035c">driveForMultiClusterOMP</a>(_dt_drift, &amp;(system_soft[0]));</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_interrupt_connected = system_hard_connected.<a class="code" href="classSystemHard.html#ad981cab6e696a124b003289878094386">getNumberOfInterruptClusters</a>();</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_connected;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_interrupt_connected_glb = PS::Comm::getSum(n_interrupt_connected);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_connected_glb;</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_connected_glb==0) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            search_cluster.writeAndSendBackPtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), mass_modify_list);</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            system_hard_connected.<a class="code" href="classSystemHard.html#a0aefe9e642d174f1d8ab04825a3bce3c">updateTimeWriteBack</a>();</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        <span class="comment">// integrate multi cluster B</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        n_interrupt_glb += n_interrupt_connected_glb;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        <span class="comment">// drift cm</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a> += stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>*_dt_drift;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160; </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#a56875a530c45fac6439a6d6d4f671b3d">driftMovePot</a>(_dt_drift);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_glb==0) <a class="code" href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a> = <a class="code" href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da820eb5b696ea2a657c0db1e258dc7d81">GroupDataMode::cm</a>;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">return</span> n_interrupt_glb;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> finishInterruptDrift() {</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        profile.<a class="code" href="classSysProfile.html#a13f67d41005470f18b697de432c5ea58">hard_interrupt</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        profile.<a class="code" href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">hard_isolated</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="comment">// finish interrupt clusters first</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        <span class="comment">// isolated clusters</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_interrupt_isolated = 0;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="keywordflow">if</span> (system_hard_isolated.<a class="code" href="classSystemHard.html#ad981cab6e696a124b003289878094386">getNumberOfInterruptClusters</a>()&gt;0) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            system_hard_isolated.<a class="code" href="classSystemHard.html#a2d86414801edb526081bb7441b6a0da4">finishIntegrateInterruptClustersOMP</a>();</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            n_interrupt_isolated = system_hard_isolated.<a class="code" href="classSystemHard.html#ad981cab6e696a124b003289878094386">getNumberOfInterruptClusters</a>();</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">if</span>(n_interrupt_isolated==0) system_hard_isolated.<a class="code" href="classSystemHard.html#aa4aebe7d712e02085a411e85618d6f12">writeBackPtclForMultiCluster</a>(system_soft, mass_modify_list);</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        }</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_isolated;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        profile.<a class="code" href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">hard_isolated</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160; </div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        n_interrupt_glb = PS::Comm::getSum(n_interrupt_isolated);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;        n_interrupt_glb = n_interrupt_isolated;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160; </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_glb;</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        profile.<a class="code" href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">hard_isolated</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <span class="comment">// connected clusters</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_interrupt_connected = 0;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        <span class="keywordflow">if</span> (system_hard_connected.<a class="code" href="classSystemHard.html#ad981cab6e696a124b003289878094386">getNumberOfInterruptClusters</a>()&gt;0) {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;            system_hard_connected.<a class="code" href="classSystemHard.html#a2d86414801edb526081bb7441b6a0da4">finishIntegrateInterruptClustersOMP</a>();</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            n_interrupt_connected = system_hard_connected.<a class="code" href="classSystemHard.html#ad981cab6e696a124b003289878094386">getNumberOfInterruptClusters</a>();</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_connected;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_interrupt_connected_glb = PS::Comm::getSum(n_interrupt_connected);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160; </div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">hard_interrupt</a> += n_interrupt_connected_glb;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160; </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_connected_glb==0) {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            PS::ReallocatableArray&lt;PS::S32&gt; mass_modify_list;</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;            search_cluster.writeAndSendBackPtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), mass_modify_list);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            system_hard_connected.<a class="code" href="classSystemHard.html#a0aefe9e642d174f1d8ab04825a3bce3c">updateTimeWriteBack</a>();</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160; </div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        n_interrupt_glb += n_interrupt_connected_glb;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        profile.<a class="code" href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">hard_connected</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="preprocessor">#ifdef HARD_INTERRUPT_PRINT</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_glb&gt;0)  {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Interrupt detected, number: &quot;</span>&lt;&lt;n_interrupt_glb&lt;&lt;std::endl;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        profile.<a class="code" href="classSysProfile.html#a13f67d41005470f18b697de432c5ea58">hard_interrupt</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        profile.<a class="code" href="classSysProfile.html#a13f67d41005470f18b697de432c5ea58">hard_interrupt</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160; </div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_glb==0) <a class="code" href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a> = <a class="code" href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da820eb5b696ea2a657c0db1e258dc7d81">GroupDataMode::cm</a>;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="comment">// if interrupt cluster still exist, return the number immediately without new integration.</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        <span class="keywordflow">return</span> n_interrupt_glb;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    }</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keyword">inline</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> calcDtLimit(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _time,</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                               <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_max,</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                               <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_min){</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="comment">// for first step, the maximum time step is OK</span></div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">if</span>(_time==0.0) <span class="keywordflow">return</span> _dt_max;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            <span class="comment">// the binary tree for current time position in block step </span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;            <a class="code" href="namespacePIKG.html#ab282ca14d7ee5e3f671ceba5ceff036f">PS::U64</a> bitmap = _time/_dt_min;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="comment">//#ifdef __GNUC__ </span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">//        PS::S64 dts = __builtin_ctz(bitmap) ;</span></div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="comment">//        PS::U64 c = (1&lt;&lt;dts);</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="comment"></span><span class="comment">//#else</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            <span class="comment">// block step multiply factor </span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;            <a class="code" href="namespacePIKG.html#ab282ca14d7ee5e3f671ceba5ceff036f">PS::U64</a> c=1;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;            <span class="comment">// find the last zero in the binary tree to obtain the current block step level</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            <span class="keywordflow">while</span>((bitmap&amp;1)==0) {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                bitmap = (bitmap&gt;&gt;1);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                c = (c&lt;&lt;1);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;            }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;            <span class="comment">// return the maximum step allown</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">std::min</a>(c*_dt_min,_dt_max);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;        }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordtype">bool</span> checkTimeConsistence() {</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;        <span class="keywordflow">if</span> (abs(time_kick-stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>)&gt;1e-13) {</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: kick time (&quot;</span>&lt;&lt;time_kick&lt;&lt;<span class="stringliteral">&quot;) and system time (&quot;</span>&lt;&lt;stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>&lt;&lt;<span class="stringliteral">&quot;) are inconsistent!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;            abort();</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        }</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        time_kick = stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>; <span class="comment">// escape the problem of round-off error</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>&gt;1) {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;            assert(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> == system_hard_one_cluster.<a class="code" href="classSystemHard.html#aaa3225b5e3f3fdeef1626258addcae12">getTimeOrigin</a>());</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            assert(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> == system_hard_isolated.<a class="code" href="classSystemHard.html#aaa3225b5e3f3fdeef1626258addcae12">getTimeOrigin</a>());</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            assert(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> == system_hard_connected.<a class="code" href="classSystemHard.html#aaa3225b5e3f3fdeef1626258addcae12">getTimeOrigin</a>());</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordtype">void</span> writeBackHardParticles() {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        profile.<a class="code" href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">output</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#aa4aebe7d712e02085a411e85618d6f12">writeBackPtclForMultiCluster</a>(system_soft, mass_modify_list);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="comment">// update gloabl particle system and send receive remote particles</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        search_cluster.writeAndSendBackPtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), mass_modify_list);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a0aefe9e642d174f1d8ab04825a3bce3c">updateTimeWriteBack</a>();</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="preprocessor">#endif        </span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        mass_modify_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160; </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;        profile.<a class="code" href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">output</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        profile.<a class="code" href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">output</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="comment">// update group_data.cm to pcm data for search cluster after restart</span></div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordtype">void</span> setParticleGroupDataToCMData() {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">search_cluster</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="preprocessor">#ifdef CLUSTER_VELOCITY</span></div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        <span class="comment">// update status and mass_bk to pcm data for search cluster after restart</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        system_hard_one_cluster.resetParticleGroupData(system_soft);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        system_hard_isolated.setParticleGroupDataToCMData(system_soft);</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        system_hard_connected.setParticleGroupDataToCMData(system_soft);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        search_cluster.writeAndSendBackPtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), mass_modify_list);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a0aefe9e642d174f1d8ab04825a3bce3c">updateTimeWriteBack</a>();</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;        mass_modify_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">search_cluster</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        profile.<a class="code" href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">search_cluster</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="preprocessor">#endif    </span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordtype">void</span> correctForceChangeOverUpdate() {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        <span class="comment">// correct changeover for first step</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="comment">// Isolated clusters</span></div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#a948046ca0f81181a45882201c86cca56">correctForceForChangeOverUpdateOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, TreeForce, <a class="code" href="classEPJSoft.html">EPJSoft</a>&gt;(system_soft, tree_soft);</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="comment">// Connected clusters</span></div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keyword">auto</span>&amp; adr_send = search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>();</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a948046ca0f81181a45882201c86cca56">correctForceForChangeOverUpdateOMP</a>&lt;<a class="code" href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a>, TreeForce, <a class="code" href="classEPJSoft.html">EPJSoft</a>&gt;(system_soft, tree_soft, adr_send.getPointer(), adr_send.size());</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">force_correct</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="keywordtype">void</span> domainDecompose(<span class="keyword">const</span> <span class="keywordtype">bool</span> _enforce=<span class="keyword">false</span>) {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        <span class="comment">// &gt; 6. Domain decomposition</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        profile.<a class="code" href="classSysProfile.html#a35d2315ca023213014a7c9878deea268">domain</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <span class="comment">// Domain decomposition, parrticle exchange and force calculation</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">if</span>(n_loop % 16 == 0 || _enforce) {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            dinfo.decomposeDomainAll(system_soft,domain_decompose_weight);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;            <span class="comment">//std::cout&lt;&lt;&quot;rank: &quot;&lt;&lt;my_rank&lt;&lt;&quot; weight: &quot;&lt;&lt;domain_decompose_weight&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        }</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        profile.<a class="code" href="classSysProfile.html#a35d2315ca023213014a7c9878deea268">domain</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        profile.<a class="code" href="classSysProfile.html#a35d2315ca023213014a7c9878deea268">domain</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    }</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordtype">bool</span> adjustDtTreeReduce(<a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; _dt_reduce_factor, <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_tree_base, <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _dt_tree_now) {</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        <span class="keywordtype">bool</span> dt_mod_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_tree_new = _dt_tree_base / _dt_reduce_factor;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">if</span>(_dt_tree_now!= dt_tree_new) {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;            <span class="comment">// in increasing case, need to make sure the time is consistent with block step time/dt_tree</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;            <span class="keywordflow">if</span>(_dt_tree_now&lt;dt_tree_new) {</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_tree_max = calcDtLimit(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, _dt_tree_base, _dt_tree_now);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                <span class="keywordflow">if</span> (dt_tree_max == _dt_tree_now) {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                    <span class="comment">// no modificatoin, recover original reduce factor</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                    _dt_reduce_factor= _dt_tree_base/_dt_tree_now;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                    dt_mod_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                    <span class="comment">// limit dt_reduce_factor to the maximum block step allown</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                    _dt_reduce_factor = <a class="code" href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">std::min</a>(_dt_tree_base/dt_tree_max, _dt_reduce_factor);</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                }</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            }</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            <span class="keywordflow">else</span> dt_mod_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        }</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="keywordflow">return</span> dt_mod_flag;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordtype">void</span> updateStatus(<span class="keyword">const</span> <span class="keywordtype">bool</span> _initial_flag) {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        profile.<a class="code" href="classSysProfile.html#a080ab81ebdc56f733efb7d544b2ca80a">status</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;<span class="comment">//        stat.shiftToOriginFrame(&amp;system_soft[0], stat.n_real_loc);</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordflow">if</span> (_initial_flag) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            <span class="comment">// calculate initial energy</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#af3f3f5838916c54dbcbe983098f26d09">clear</a>();</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#aeabb3c5236a13b3db49cb64a9148dbf7">calc</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>, <span class="keyword">true</span>, &amp;(stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>), &amp;(stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>));</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#aeabb3c5236a13b3db49cb64a9148dbf7">calc</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#ab05745baa09b2424652f395d3780ee57">getSumMultiNodes</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.ekin_sd = stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a8eda14e2b591d14c43672977cc4e57b8">ekin</a>;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.epot_sd = stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a74c80ca54c9d50ef10556756fda83a1c">epot</a>;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;<span class="preprocessor">#ifndef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            stat.<a class="code" href="classStatus.html#a95226a9e5aceeea5c44e89b8a3bccb0c">calcCenterOfMass</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="comment">//Ptcl::vel_cm = stat.pcm.vel;</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            <span class="comment">// reset sd energy reference to no slowdown case</span></div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> energy_old = stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a8eda14e2b591d14c43672977cc4e57b8">ekin</a> + stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a74c80ca54c9d50ef10556756fda83a1c">epot</a>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.etot_sd_ref -= stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.ekin_sd + stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.epot_sd - energy_old;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#aeabb3c5236a13b3db49cb64a9148dbf7">calc</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>,<span class="keyword">false</span>, &amp;(stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>), &amp;(stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>));</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#aeabb3c5236a13b3db49cb64a9148dbf7">calc</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#ab05745baa09b2424652f395d3780ee57">getSumMultiNodes</a>();</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160; </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;            <a class="code" href="structHardEnergy.html">HardEnergy</a> energy_local = system_hard_one_cluster.energy;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            energy_local += system_hard_isolated.energy;</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            energy_local += system_hard_connected.energy;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;            <span class="comment">// hard energy error</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.error_hard_cum += PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a84c5a7638e18d922d9d666dcc7d1186e">de</a>);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.error_hard_sd_cum += PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#aa0e750a49bdaed986677db718f671215">de_sd</a>);</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            <span class="comment">// energy correction due to slowdown </span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> ekin_sd_correction = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a594c445cbea3b6d0d36a064d1192ba78">ekin_sd_correction</a>);</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.ekin_sd = stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a8eda14e2b591d14c43672977cc4e57b8">ekin</a> + ekin_sd_correction;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> epot_sd_correction = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a3314977f280a8ab3cd5fc55a12bc25d4">epot_sd_correction</a>);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.epot_sd = stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a74c80ca54c9d50ef10556756fda83a1c">epot</a> + epot_sd_correction;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> etot_sd_correction = ekin_sd_correction + epot_sd_correction;</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_change_cum = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#ad179469610bd9c46eee79e3efd90c66c">de_change_cum</a>);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_change_binary_interrupt = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#ac30efb096db77bccecc795941b14dac4">de_change_binary_interrupt</a>);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_change_modify_single = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a85e9efe1ce7511c36d142f0fc5cc92a2">de_change_modify_single</a>);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a01d39d5cf22000b7af75f3d14217374f">etot_ref</a> += de_change_cum;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_cum += de_change_cum;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_binary_interrupt += de_change_binary_interrupt;</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_modify_single += de_change_modify_single;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;            <span class="comment">// for total energy reference, first add the cumulative change due to slowdown change in the integration (referring to no slowdown case), then add slowdown energy correction from current time</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_sd_change_cum  = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a302ae473aba079cf68af9fcdf2634a2e">de_sd_change_cum</a>) + etot_sd_correction;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_sd_change_binary_interrupt = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a67a00aa59d17ef75f04bc02433377d84">de_sd_change_binary_interrupt</a>);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_sd_change_modify_single = PS::Comm::getSum(energy_local.<a class="code" href="structHardEnergy.html#a8a1ec16791c1470f637f1d7f2646e605">de_sd_change_modify_single</a>);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.etot_sd_ref += de_sd_change_cum; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_cum += de_sd_change_cum;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_binary_interrupt += de_sd_change_binary_interrupt;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_modify_single += de_sd_change_modify_single;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;            system_hard_one_cluster.energy.clear();</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;            system_hard_isolated.energy.clear();</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;            system_hard_connected.energy.clear();</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="preprocessor">#ifndef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;            stat.<a class="code" href="classStatus.html#a95226a9e5aceeea5c44e89b8a3bccb0c">calcCenterOfMass</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;            <span class="comment">//Ptcl::vel_cm = stat.pcm.vel;</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="comment">//stat.shiftToCenterOfMassFrame(&amp;system_soft[0], stat.n_real_loc);</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        profile.<a class="code" href="classSysProfile.html#a080ab81ebdc56f733efb7d544b2ca80a">status</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        profile.<a class="code" href="classSysProfile.html#a080ab81ebdc56f733efb7d544b2ca80a">status</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160; </div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    <span class="keywordtype">void</span> output() {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        profile.<a class="code" href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">output</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordtype">bool</span> print_flag = input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        <span class="keywordtype">int</span> write_style = input_parameters.<a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        std::cout&lt;&lt;std::setprecision(<a class="code" href="io_8hpp.html#a38caeb67950bf01a29a5dd4c937ca236">PRINT_PRECISION</a>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160; </div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <span class="comment">// print status</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="keywordflow">if</span>(print_flag) {</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            stat.<a class="code" href="classStatus.html#ae97a62d35d7fdb083be8d441fc3b2270">print</a>(std::cout);</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="keywordflow">if</span> (print_flag) galpy_manager.<a class="code" href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">printData</a>(std::cout);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="comment">// write status, output to separate snapshots</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keywordflow">if</span>(write_style==1) {</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;            <span class="comment">// data output</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            file_header.<a class="code" href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">n_body</a> = stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;            file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a> = stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>;</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a>++;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            file_header.pos_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            file_header.vel_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; </div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;            std::string fname = input_parameters.<a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>+<span class="stringliteral">&quot;.&quot;</span>+std::to_string(file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a>);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="preprocessor">#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;            assert(system_soft.getNumberOfParticleLocal()== stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a>);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;            system_soft.setNumberOfParticleLocal(stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;            <span class="keywordflow">if</span> (input_parameters.<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1||input_parameters.<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==3)</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                system_soft.writeParticleAscii(fname.c_str(), file_header);</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==0||input_parameters.<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==2)</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;                system_soft.writeParticleBinary(fname.c_str(), file_header);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;            system_soft.setNumberOfParticleLocal(stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a>);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160; </div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;            <span class="keywordflow">if</span>(my_rank==0) {</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;                <span class="comment">// status output</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;                stat.<a class="code" href="classStatus.html#a86a02e9495c972470f963cec6d9e5523">printColumn</a>(fstatus, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;                fstatus&lt;&lt;std::endl;</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160; </div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;                <span class="comment">// for External potential</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;                galpy_manager.<a class="code" href="classGalpyManager.html#a84d80784f5da870ff86d61bf29eb98d1">writePotentialPars</a>(fname+<span class="stringliteral">&quot;.galpy&quot;</span>, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            }</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        }</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        <span class="comment">// write all information in to fstatus</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(write_style==2&amp;&amp;my_rank==0) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            <span class="comment">// write snapshot with one line</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;            stat.<a class="code" href="classStatus.html#a86a02e9495c972470f963cec6d9e5523">printColumn</a>(fstatus, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;                system_soft[i].printColumnWithOffset(stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>, fstatus, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;                system_soft[i].printColumn(fstatus, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            fstatus&lt;&lt;std::endl;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="comment">// write status only</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(write_style==3&amp;&amp;my_rank==0) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            stat.<a class="code" href="classStatus.html#a86a02e9495c972470f963cec6d9e5523">printColumn</a>(fstatus, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;            fstatus&lt;&lt;std::endl;</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        }</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <span class="comment">// save current error</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a1aed44f1fd6443ded7eb940b696c0beb">saveEnergyError</a>();</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        profile.<a class="code" href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">output</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        profile.<a class="code" href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">output</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    }</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keywordtype">void</span> calcProfile() {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        </div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="comment">// profile analysis</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160; </div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_hard_single     = system_hard_one_cluster.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>().size();</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_hard_isolated   = system_hard_isolated.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>().size();</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160; </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        n_count.<a class="code" href="classSysCounts.html#ad95a1ce759efcb258f8faf632cb8f5e2">hard_single</a>      += n_hard_single;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a12fd2d6d24adf423f07981ce005228a0">hard_isolated</a>    += n_hard_isolated;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#ad95a1ce759efcb258f8faf632cb8f5e2">hard_single</a>      += PS::Comm::getSum(n_hard_single);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a12fd2d6d24adf423f07981ce005228a0">hard_isolated</a>    += PS::Comm::getSum(n_hard_isolated);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> ARC_substep_sum   = system_hard_isolated.ARC_substep_sum;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> ARC_tsyn_step_sum   = system_hard_isolated.ARC_tsyn_step_sum;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> ARC_n_groups      = system_hard_isolated.ARC_n_groups;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> ARC_n_groups_iso  = system_hard_isolated.ARC_n_groups_iso;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> H4_step_sum       = system_hard_isolated.H4_step_sum;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_neighbor_zero   = system_hard_isolated.n_neighbor_zero;</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_hard_connected  = system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>().size();</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a5954fd75177dbbf517c6fae9409a67b9">hard_connected</a>   += n_hard_connected;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a5954fd75177dbbf517c6fae9409a67b9">hard_connected</a> += PS::Comm::getSum(n_hard_connected);</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        ARC_substep_sum += system_hard_connected.ARC_substep_sum;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        ARC_tsyn_step_sum += system_hard_connected.ARC_tsyn_step_sum;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        ARC_n_groups += system_hard_connected.ARC_n_groups;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        ARC_n_groups_iso += system_hard_connected.ARC_n_groups_iso;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        H4_step_sum +=  system_hard_connected.H4_step_sum;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        n_neighbor_zero+= system_hard_connected.n_neighbor_zero;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                                           </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a02aaf494a19a1017204c0e4b6336eaf4">ARC_substep_sum</a>  += ARC_substep_sum;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a198f671859c262e76600266a55a2c94d">ARC_tsyn_step_sum</a>+= ARC_tsyn_step_sum;</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a3e957552c42bd1e0aca5ce6c61eece2d">ARC_n_groups</a>     += ARC_n_groups;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        n_count.<a class="code" href="classSysCounts.html#aacf09fcd49268cae7a3c264e9e0ddf14">ARC_n_groups_iso</a> += ARC_n_groups_iso;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a34b0e1f4a51d345a1860fb290378c7ed">H4_step_sum</a>      += H4_step_sum;</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a7d89305dbd6bc59e3fbb81a3a7cce180">n_neighbor_zero</a>  += n_neighbor_zero;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; </div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a02aaf494a19a1017204c0e4b6336eaf4">ARC_substep_sum</a>  += PS::Comm::getSum(ARC_substep_sum);</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a198f671859c262e76600266a55a2c94d">ARC_tsyn_step_sum</a>+= PS::Comm::getSum(ARC_tsyn_step_sum);</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a3e957552c42bd1e0aca5ce6c61eece2d">ARC_n_groups</a>     += PS::Comm::getSum(ARC_n_groups);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#aacf09fcd49268cae7a3c264e9e0ddf14">ARC_n_groups_iso</a>     += PS::Comm::getSum(ARC_n_groups_iso);</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a34b0e1f4a51d345a1860fb290378c7ed">H4_step_sum</a>      += PS::Comm::getSum(H4_step_sum);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a7d89305dbd6bc59e3fbb81a3a7cce180">n_neighbor_zero</a>  += PS::Comm::getSum(n_neighbor_zero);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        system_hard_isolated.ARC_substep_sum = 0;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        system_hard_isolated.ARC_tsyn_step_sum=0;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        system_hard_isolated.ARC_n_groups = 0;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        system_hard_isolated.ARC_n_groups_iso = 0;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        system_hard_isolated.H4_step_sum = 0;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        system_hard_isolated.n_neighbor_zero = 0;</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        system_hard_connected.ARC_substep_sum = 0;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        system_hard_connected.ARC_tsyn_step_sum=0;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        system_hard_connected.ARC_n_groups = 0;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;        system_hard_connected.ARC_n_groups_iso = 0;</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        system_hard_connected.H4_step_sum = 0;</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        system_hard_connected.n_neighbor_zero = 0;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        </div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        n_count.<a class="code" href="classSysCounts.html#ae736859dafde342d60a11464140a785b">clearClusterCount</a>();</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        n_count.<a class="code" href="classSysCounts.html#ad03923dd131a830d4bc1124947b77589">clusterCount</a>(1, n_hard_single);</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160; </div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a>  n_isolated_cluster = system_hard_isolated.<a class="code" href="classSystemHard.html#a6c7b5d7db23cc30a8886f5cda356afe5">getNumberOfClusters</a>();</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a531348a4cbf7ec59b68bf58e521b1bef">cluster_isolated</a> += n_isolated_cluster;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a531348a4cbf7ec59b68bf58e521b1bef">cluster_isolated</a> += PS::Comm::getSum(n_isolated_cluster);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; </div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a>* isolated_cluster_n_list = system_hard_isolated.<a class="code" href="classSystemHard.html#a7a93c9f2f0da92ca0eb63989a8ab2191">getClusterNumberOfMemberList</a>();</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_isolated_cluster; i++) n_count.<a class="code" href="classSysCounts.html#ad03923dd131a830d4bc1124947b77589">clusterCount</a>(isolated_cluster_n_list[i]);</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a>  n_connected_cluster = system_hard_connected.<a class="code" href="classSystemHard.html#a6c7b5d7db23cc30a8886f5cda356afe5">getNumberOfClusters</a>();</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        n_count.<a class="code" href="classSysCounts.html#ac3d58a6d8e0e757af3c1054ebe50a770">cluster_connected</a> += n_connected_cluster;</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#ac3d58a6d8e0e757af3c1054ebe50a770">cluster_connected</a> += PS::Comm::getSum(n_connected_cluster);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a>* connected_cluster_n_list = system_hard_connected.<a class="code" href="classSystemHard.html#a7a93c9f2f0da92ca0eb63989a8ab2191">getClusterNumberOfMemberList</a>();</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_connected_cluster; i++) n_count.<a class="code" href="classSysCounts.html#ad03923dd131a830d4bc1124947b77589">clusterCount</a>(connected_cluster_n_list[i]);</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> cluster_hist_size_loc = n_count.<a class="code" href="classSysCounts.html#a22d0dbe1a3576c71534fd4fc7ea7ae9f">n_cluster</a>.size();</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_member_in_cluster_loc[cluster_hist_size_loc];</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_cluster_loc[cluster_hist_size_loc];</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a82e5d98b06ad5f01bdca7f90a7dd59c2">getherClusterCount</a>(n_member_in_cluster_loc, n_cluster_loc, cluster_hist_size_loc);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> cluster_hist_size_recv[n_proc];</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> cluster_hist_size_disp[n_proc+1];</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;        PS::Comm::allGather(&amp;cluster_hist_size_loc, 1, cluster_hist_size_recv);</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        cluster_hist_size_disp[0] = 0;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_proc; i++){</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;            cluster_hist_size_disp[i+1] = cluster_hist_size_recv[i] + cluster_hist_size_disp[i];</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;        }</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> cluster_hist_size_total = cluster_hist_size_disp[n_proc];</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_member_in_cluster_recv[cluster_hist_size_total];</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_cluster_recv[cluster_hist_size_total];</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        PS::Comm::allGatherV(n_member_in_cluster_loc, cluster_hist_size_loc, </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;                             n_member_in_cluster_recv, cluster_hist_size_recv, cluster_hist_size_disp);</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        PS::Comm::allGatherV(n_cluster_loc, cluster_hist_size_loc, </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                             n_cluster_recv, cluster_hist_size_recv, cluster_hist_size_disp);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;cluster_hist_size_total; i++) {</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;            n_count_sum.<a class="code" href="classSysCounts.html#ad03923dd131a830d4bc1124947b77589">clusterCount</a>(n_member_in_cluster_recv[i], n_cluster_recv[i]);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a9cf5f8b421b99e3442dc2d40c6221052">addClusterCount</a>(n_count);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        dn_loop++;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    }</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    <span class="keywordtype">void</span> clearProfile() {</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        profile.<a class="code" href="classSysProfile.html#ab2e64f3792e3cbeb6c94ca2c993b7df1">clear</a>();</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        tree_soft_profile.clear();</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        tree_nb_profile.clear();</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">#if defined(USE_GPU) &amp;&amp; defined(GPU_PROFILE)</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        gpu_profile.clear();</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        gpu_counter.clear();</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        n_count.<a class="code" href="classSysCounts.html#a8f9e6d193f0a554e2accd2d68b8b5c65">clear</a>();</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        n_count_sum.<a class="code" href="classSysCounts.html#a8f9e6d193f0a554e2accd2d68b8b5c65">clear</a>();</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        dn_loop=0;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    }</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordtype">void</span> printProfile() {</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keyword">const</span> <a class="code" href="classSysProfile.html">SysProfile</a>&amp; profile_min = profile.<a class="code" href="classSysProfile.html#a29d995275d99572ecff682569a15c77c">getMin</a>();</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            std::cout&lt;&lt;std::setprecision(5);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;Tree step number: &quot;</span>&lt;&lt;dn_loop&lt;&lt;std::endl;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;**** Wallclock time per step (local): [Min/Max]\n&quot;</span>;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            <span class="comment">//std::cout&lt;&lt;std::setw(PRINT_WIDTH)&lt;&lt;&quot;Rank&quot;;</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            profile.<a class="code" href="classSysProfile.html#a64c14ef58f38b806f03a24fd9628c470">dumpName</a>(std::cout);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            <span class="comment">//std::cout&lt;&lt;std::setw(PRINT_WIDTH)&lt;&lt;my_rank;</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            profile_min.<a class="code" href="classSysProfile.html#a83fada2e7b3ab2ea14ef267d0c026b92">dump</a>(std::cout,dn_loop);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            profile.<a class="code" href="classSysProfile.html#a83fada2e7b3ab2ea14ef267d0c026b92">dump</a>(std::cout,dn_loop);</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;**** FDPS tree soft force time profile (local):\n&quot;</span>;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            tree_soft_profile.<a class="code" href="classFDPSProfile.html#a00c543c78cce28a08c0d40c5bf32cbd4">dumpName</a>(std::cout);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            tree_soft_profile.<a class="code" href="classFDPSProfile.html#a9987ad38ffbeba5186859d395d50f009">dump</a>(std::cout,dn_loop);</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;**** Tree neighbor time profile (local):\n&quot;</span>;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            tree_nb_profile.<a class="code" href="classFDPSProfile.html#a00c543c78cce28a08c0d40c5bf32cbd4">dumpName</a>(std::cout);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            tree_nb_profile.<a class="code" href="classFDPSProfile.html#a9987ad38ffbeba5186859d395d50f009">dump</a>(std::cout,dn_loop);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160; </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="preprocessor">#if defined(USE_GPU) &amp;&amp; defined(GPU_PROFILE)</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;**** GPU time profile (local):\n&quot;</span>;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            gpu_profile.dumpName(std::cout);</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            gpu_counter.dumpName(std::cout);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            gpu_profile.dump(std::cout,dn_loop);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            gpu_counter.dump(std::cout,dn_loop);</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160; </div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;**** Number per step (global):\n&quot;</span>;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            n_count_sum.<a class="code" href="classSysCounts.html#a9d983bfda9790179f173da6f09af5d35">dumpName</a>(std::cout);</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            n_count_sum.<a class="code" href="classSysCounts.html#a73663955d851be11aac6b22831bcf03f">dump</a>(std::cout,dn_loop);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;            std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                </div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;**** Number of members in clusters (global):\n&quot;</span>;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            n_count_sum.<a class="code" href="classSysCounts.html#a56d420bdf5e85f515fa2d706adf1f6c0">printHist</a>(std::cout,dn_loop);</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        }</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0) {</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            fprofile&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            fprofile&lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;my_rank;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            fprofile&lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                    &lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;dn_loop</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                    &lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            profile.<a class="code" href="classSysProfile.html#a83fada2e7b3ab2ea14ef267d0c026b92">dump</a>(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            profile.<a class="code" href="classSysProfile.html#a7ba7d3a659225a47527f2af0be9ca068">dumpBarrier</a>(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;            tree_soft_profile.<a class="code" href="classFDPSProfile.html#a9987ad38ffbeba5186859d395d50f009">dump</a>(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            tree_nb_profile.<a class="code" href="classFDPSProfile.html#a9987ad38ffbeba5186859d395d50f009">dump</a>(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="preprocessor">#if defined(USE_GPU) &amp;&amp; defined(GPU_PROFILE)</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;            gpu_profile.dump(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            gpu_counter.dump(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            n_count.<a class="code" href="classSysCounts.html#a73663955d851be11aac6b22831bcf03f">dump</a>(fprofile, dn_loop, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            fprofile&lt;&lt;std::endl;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160; </div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> getParticleAdrFromID(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> _id) {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        <span class="keyword">auto</span> item = id_adr_map.find(_id);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        <span class="keywordflow">if</span> (item==id_adr_map.end()) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">return</span> item-&gt;second;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    }</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="keywordtype">void</span> addParticleInIdAdrMap(<a class="code" href="classFPSoft.html">FPSoft</a>&amp; _ptcl) {</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        id_adr_map[_ptcl.<a class="code" href="classPtcl.html#a6a43cef83e56ad4b3d985ccead9ef716">id</a>] = _ptcl.<a class="code" href="classFPSoft.html#ad052ed9ba9fa413f216cb2501f1cf669">adr</a>;</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160; </div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <span class="keywordtype">void</span> reconstructIdAdrMap() {</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        id_adr_map.clear();</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) id_adr_map[system_soft[i].<span class="keywordtype">id</span>] = i;</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    }</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="keywordtype">void</span> correctSoftPotMassChange() {</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;        <span class="comment">// correct soft potential energy due to mass change</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;mass_modify_list.size(); k++)  {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;            <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i = mass_modify_list[k];</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;            <span class="keyword">auto</span>&amp; pi = system_soft[i];</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dpot = pi.dm*pi.pot_soft;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a01d39d5cf22000b7af75f3d14217374f">etot_ref</a> += dpot;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_cum += dpot;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.etot_sd_ref += dpot;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_cum += dpot;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            pi.dm = 0.0;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            <span class="comment">// ghost particle case, check in remove_particle instead</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            <span class="comment">//if(pi.mass==0.0&amp;&amp;pi.group_data.artificial.isUnused()) {</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;            <span class="comment">//    remove_list.push_back(i);</span></div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            <span class="comment">//}</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        mass_modify_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    }</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> removeParticleFromIdAdrMap(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> _id) {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        <span class="keyword">auto</span> item = id_adr_map.find(_id);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        <span class="keywordflow">if</span> (item==id_adr_map.end()) <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> adr = item-&gt;second;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            id_adr_map.erase(item);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            <span class="keywordflow">return</span> adr;</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        }</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;    }</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordtype">void</span> removeParticles() {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        assert(n_interrupt_glb==0);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        <span class="comment">// first remove artificial particles</span></div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        system_soft.setNumberOfParticleLocal(stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160; </div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        <span class="comment">// set flag for particles in remove_list</span></div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_remove = remove_list.size();</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_remove; i++) {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            <span class="keyword">auto</span>&amp; pi = system_soft[remove_list[i]];</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            pi.group_data.artificial.setParticleTypeToUnused(); <span class="comment">// sign for removing</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            <span class="comment">// if mass is not zero, correct energy</span></div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;            <span class="keywordflow">if</span> (pi.mass&gt;0) {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dpot = pi.mass*pi.pot_tot;</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dkin = 0.5*pi.mass*(pi.vel*pi.vel);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> eloss = dpot + dkin;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a01d39d5cf22000b7af75f3d14217374f">etot_ref</a> -= eloss;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;                stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_cum -= eloss;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.etot_sd_ref -= eloss;</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_cum -= eloss;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                pi.mass = 0.0;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;            }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;        }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        remove_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160; </div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        <span class="comment">// check all particles escaper status and remove</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> num_thread = PS::Comm::getNumberOfThread();</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        PS::ReallocatableArray&lt;PS::S32&gt; remove_list_thx[num_thread];</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;num_thread; i++) remove_list_thx[i].resizeNoInitialize(0);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;        { </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> ith = PS::Comm::getThreadNum();</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="preprocessor">#pragma omp for </span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                <span class="keyword">auto</span>&amp; pi = system_soft[i];</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                <span class="keywordflow">if</span> (escaper.<a class="code" href="classEscaper.html#a2b248b32607d13e2834d3123892e2e66">isEscaper</a>(pi,stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>)) {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                    remove_list_thx[ith].push_back(i);</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dpot = pi.mass*pi.pot_tot;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dkin = 0.5*pi.mass*(pi.vel*pi.vel);</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> eloss = dpot + dkin;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a01d39d5cf22000b7af75f3d14217374f">etot_ref</a> -= eloss;</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_cum -= eloss;</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.etot_sd_ref -= eloss;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_cum -= eloss;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                <span class="comment">// Registered removed particles have already done energy correction</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi.mass==0.0&amp;&amp;pi.group_data.artificial.isUnused()) </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                    remove_list_thx[ith].push_back(i);</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            }</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        <span class="comment">// gether remove indices</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        <span class="keywordtype">int</span> n_esc=0;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;num_thread; i++) </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> k=0; k&lt;remove_list_thx[i].size(); k++) {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;                <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> index=remove_list_thx[i][k];</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                remove_list.push_back(index);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                remove_id_record.push_back(system_soft[index].<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                <span class="keywordflow">if</span> (system_soft[index].mass&gt;0) {</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                    <span class="keywordflow">if</span> (input_parameters.<a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;0) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                        fesc&lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                        system_soft[index].printColumn(fesc,<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                        fesc&lt;&lt;std::endl;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                    }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                    n_esc++;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                }</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            }</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        <span class="comment">// Remove particles</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        n_remove = remove_list.size();</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        system_soft.removeParticle(remove_list.getPointer(), remove_list.size());</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        stat.<a class="code" href="classStatus.html#a0e6b78a9428d64a9d46f08883e6f54f6">n_escape_glb</a> += PS::Comm::getSum(n_esc);</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        stat.<a class="code" href="classStatus.html#aa57f2f0496be3ea54c28dd16b41f20cd">n_remove_glb</a> += PS::Comm::getSum(n_remove);</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="comment">// reset particle number</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>-remove_list.size();</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;        system_soft.setNumberOfParticleLocal(stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> = system_soft.getNumberOfParticleGlobal();</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;        remove_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160; </div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="preprocessor">#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++){</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;            assert(system_soft[i].mass!=0.0);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;            assert(!std::isinf(system_soft[i].pos[0]));</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            assert(!std::isnan(system_soft[i].pos[0]));</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            assert(!std::isinf(system_soft[i].vel[0]));</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            assert(!std::isnan(system_soft[i].vel[0]));</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> getNumberOfRemovedParticlesLocal()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        <span class="keywordflow">return</span> remove_id_record.size();</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160; </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> getNumberOfRemovedParticlesGlobal()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_remove_loc = remove_id_record.size();</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;        <span class="keywordflow">return</span> PS::Comm::getSum(n_remove_loc);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    }</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a>* getRemovedIDListLocal()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">return</span> remove_id_record.getPointer();</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keywordtype">void</span> clearRemovedIDList() {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        remove_id_record.resizeNoInitialize(0);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    }</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    <span class="keywordtype">void</span> exchangeParticle() {</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;        assert(n_interrupt_glb==0);</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;        profile.<a class="code" href="classSysProfile.html#a46bf7349e0d7d7f7b51335a090937a47">exchange</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        system_soft.exchangeParticle(dinfo);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_loc = system_soft.getNumberOfParticleLocal();</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160; </div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            system_soft[i].rank_org = my_rank;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;            system_soft[i].adr = i;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;        }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <span class="comment">// record real particle n_loc/glb</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = n_loc;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="preprocessor">#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        assert(stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>==system_soft.getNumberOfParticleGlobal());</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        profile.<a class="code" href="classSysProfile.html#a46bf7349e0d7d7f7b51335a090937a47">exchange</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        PS::Comm::barrier();</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        profile.<a class="code" href="classSysProfile.html#a46bf7349e0d7d7f7b51335a090937a47">exchange</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;    }</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> initialFDPS(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        <span class="keywordflow">if</span> (!initial_fdps_flag) {</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;            PS::Initialize(argc, argv);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            initial_fdps_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        }</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    }</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160; </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">void</span> finalizeFDPS() {</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        <span class="keywordflow">if</span> (initial_fdps_flag) {</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;            PS::Finalize();</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;            initial_fdps_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;        }</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    }</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="preprocessor">#ifdef FDPS_COMM</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="comment">// create a MPI communicator</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> createCommunicator(<span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> rank[]) {</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        assert(initial_fdps_flag);</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        assert(!initial_parameters_flag);</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        comm_info.create(n,rank);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        system_soft.setCommInfo(comm_info);</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        dinfo.setCommInfo(comm_info);</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;        tree_nb.setCommInfo(comm_info);</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        tree_soft.setCommInfo(comm_info);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;        my_rank = comm_info.getRank();</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;        n_proc = comm_info.getNumberOfProc();</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;    }</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; </div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="comment">// set a MPI communicator</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment"></span>    <span class="keywordtype">void</span> setCommunicator(<span class="keyword">const</span> PS::CommInfo &amp;_comm_info) {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        assert(initial_fdps_flag);</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        assert(!initial_parameters_flag);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        comm_info = _comm_info;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        system_soft.setCommInfo(comm_info);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        dinfo.setCommInfo(comm_info);</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;        tree_nb.setCommInfo(comm_info);</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;        tree_soft.setCommInfo(comm_info);</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        my_rank = comm_info.getRank();</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;        n_proc = comm_info.getNumberOfProc();</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    }</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    <span class="keywordtype">void</span> printLogo(std::ostream &amp; fout)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;\n ******************************************\n&quot;</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;     \n&quot;</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;  \n&quot;</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;          \n&quot;</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;           \n&quot;</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;                 \n&quot;</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;                 \n&quot;</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;            &lt;&lt;<span class="stringliteral">&quot; ******************************************\n&quot;</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;Version: &quot;</span>&lt;&lt;<a class="code" href="get__version_8hpp.html#a818f229e54b2ba1843a3692b9cecd363">GetVersion</a>()</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;            &lt;&lt;std::endl;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    }</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keywordtype">void</span> printReference(std::ostream &amp; fout)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;============== PeTar ================\n&quot;</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;            &lt;&lt;<span class="stringliteral">&quot; Online document: (preparing)\n&quot;</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;            &lt;&lt;<span class="stringliteral">&quot; GitHub page: https://github.com/lwang-astro/PeTar\n&quot;</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;            &lt;&lt;<span class="stringliteral">&quot; License: MIT\n&quot;</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            &lt;&lt;<span class="stringliteral">&quot; Please cite the following papers when you use PeTar for any publications\n&quot;</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;    FDPS: see above FPDS Logo message\n&quot;</span>;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;        AR::printReference(fout);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;    PeTar: Wang L., Iwasawa M., Nitadori K., Makino J., 2020, MNRAS, 497, 536\n&quot;</span>;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <a class="code" href="classBSEManager.html#af25ae410253f1e9118fefc98696e6ce3">BSEManager::printReference</a>(fout);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        <a class="code" href="classGalpyManager.html#a982ceeab737762887eec4a15035fc594">GalpyManager::printReference</a>(fout);</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot; Copyright (C) 2017\n&quot;</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;            &lt;&lt;<span class="stringliteral">&quot;    Long Wang, Masaki Iwasawa, Keigo Nitadori, Junichiro Makino and many others\n&quot;</span>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;=====================================&quot;</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;            &lt;&lt;std::endl;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;    }</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;    <span class="keywordtype">void</span> printFeatures(std::ostream &amp; fout)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="preprocessor">#ifdef USE_QUAD</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use quadrupole moment in tree force calculation\n&quot;</span>;</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="preprocessor">#endif        </span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160; </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="preprocessor">#ifdef SOFT_PERT</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="preprocessor">#ifdef TIDAL_TENSOR_3RD</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use 3rd order tidal tensor method\n&quot;</span>;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use 2nd order tidal tensor method\n&quot;</span>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160; </div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="preprocessor">#ifdef ORBIT_SAMPLING</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use orbit-sampling method\n&quot;</span>;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use Pseudoparticle multipole method\n&quot;</span>;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160; </div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use stellar evolution method: &quot;</span>;</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;        fout&lt;&lt;<a class="code" href="classBSEManager.html#a569c067ad29e6fd5f665c7fd83e3386d">BSEManager::getBSEName</a>()&lt;&lt;std::endl;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Base\n&quot;</span>;</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160; </div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use external potential: Galpy\n&quot;</span>;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="preprocessor">#ifdef KDKDK_2ND</span></div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use 2nd-order KDKDK mode for tree step\n&quot;</span>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use 4th-order KDKDK mode for tree step\n&quot;</span>;</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160; </div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="preprocessor">#ifdef CLUSTER_VELOCITY</span></div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use orbit-dependent neighbor criterion\n&quot;</span>;</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160; </div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Check energy of short-range (hard) integration\n&quot;</span>;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; </div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="preprocessor">#ifdef HARD_COUNT_NO_NEIGHBOR</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Count isolated particles in hard clusters\n&quot;</span>;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="preprocessor">#ifdef USE_SIMD</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use SIMD\n&quot;</span>;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="preprocessor">#ifdef P3T_64BIT</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use 64 bit SIMD n&quot;</span>;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="preprocessor">#ifdef USE_FUGAKU</span></div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use Fugaku\n&quot;</span>;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160; </div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="preprocessor">#ifdef USE_GPU</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use GPU\n&quot;</span>;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="preprocessor">#ifdef GPERF_PROFILE</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Use gperftools\n&quot;</span>;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160; </div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Calculate profile\n&quot;</span>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160; </div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="preprocessor">#ifdef GPU_PROFILE</span></div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Calculate GPU profile\n&quot;</span>;</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160; </div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;        AR::printFeatures(fout);</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        H4::printFeatures(fout);</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    }</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160; </div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <span class="keywordtype">void</span> printDebugFeatures(std::ostream &amp; fout)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="preprocessor">#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Debug mode: PETAR\n&quot;</span>;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="preprocessor">#ifdef STABLE_CHECK_DEBUG</span></div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Debug mode: STABLE_CHECK\n&quot;</span>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="preprocessor">#ifdef CLUSTER_DEBUG</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Debug mode: CLUSTER\n&quot;</span>;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="preprocessor">#ifdef ARTIFICIAL_PARTICLE_DEBUG</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Debug mode: ARTIFICIAL_PARTICLE\n&quot;</span>;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="preprocessor">#ifdef HARD_DEBUG</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Debug mode: HARD\n&quot;</span>;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="preprocessor">#ifdef NAN_CHECK_DEBUG</span></div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;        fout&lt;&lt;<span class="stringliteral">&quot;Debug mode: NAN_CHECK\n&quot;</span>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        AR::printDebugFeatures(fout);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        H4::printDebugFeatures(fout);</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    }</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160; </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    <span class="keywordtype">int</span> readParameters(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        <span class="comment">// print reference</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) {</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            printLogo(std::cerr);</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            printReference(std::cerr);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            printFeatures(std::cerr);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;            printDebugFeatures(std::cerr);</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;=====================================&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;        }</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; </div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;        <span class="comment">//assert(initial_fdps_flag);</span></div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        assert(!read_parameters_flag);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        <span class="comment">// reading parameters</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        opterr = 0;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        read_parameters_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;        <span class="keywordflow">else</span> input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        <span class="keywordtype">int</span> read_flag = input_parameters.<a class="code" href="classIOParamsPeTar.html#aa428da858ec3e53058edeb77b9412075">read</a>(argc,argv);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) bse_parameters.<a class="code" href="classIOParamsBSE.html#a43e7ef9939837cab859bb7891e461d3d">print_flag</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;        <span class="keywordflow">else</span> bse_parameters.<a class="code" href="classIOParamsBSE.html#a43e7ef9939837cab859bb7891e461d3d">print_flag</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;        bse_parameters.<a class="code" href="classIOParamsBSE.html#a2312b0c004f47cf752a9c9321acf36eb">read</a>(argc,argv);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        <span class="keywordflow">if</span> (my_rank==0) galpy_parameters.<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        <span class="keywordflow">else</span> galpy_parameters.<a class="code" href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">print_flag</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        galpy_parameters.<a class="code" href="classIOParamsGalpy.html#a7525714c40a2cc23a672b9f2498dcc3d">read</a>(argc,argv);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160; </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="comment">// help case, return directly</span></div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <span class="keywordflow">if</span> (read_flag==-1) {</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;            <span class="comment">// avoid segmentation fault due to FDPS clear function bug</span></div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;            tree_nb.initialize(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            tree_soft.initialize(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160; </div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;            <span class="keywordflow">return</span> read_flag;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        }</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160; </div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        <span class="keywordtype">bool</span> print_flag = input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;        <span class="keywordtype">int</span> write_style = input_parameters.<a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <span class="keywordflow">if</span>(print_flag) {</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;----- Parallelization information -----\n&quot;</span>;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;MPI processors: &quot;</span>&lt;&lt;n_proc&lt;&lt;std::endl;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;OMP threads:    &quot;</span>&lt;&lt;PS::Comm::getNumberOfThread()&lt;&lt;std::endl;</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        }</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    </div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;        <span class="comment">// open profile file</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        <span class="keywordflow">if</span>(write_style&gt;0) {</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;            std::string fproname=input_parameters.<a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>+<span class="stringliteral">&quot;.prof.rank.&quot;</span>+std::to_string(my_rank);</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;            <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1) fprofile.open(fproname.c_str(),std::ofstream::out|std::ofstream::app);</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;            <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                fprofile.open(fproname.c_str(),std::ofstream::out);</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; </div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                fprofile&lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;<span class="stringliteral">&quot;my_rank&quot;</span></div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                        &lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;<span class="stringliteral">&quot;Time&quot;</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                        &lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;<span class="stringliteral">&quot;N_steps&quot;</span></div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                        &lt;&lt;std::setw(<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>)&lt;&lt;<span class="stringliteral">&quot;N_real_loc&quot;</span>;</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;                profile.<a class="code" href="classSysProfile.html#a64c14ef58f38b806f03a24fd9628c470">dumpName</a>(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;                profile.<a class="code" href="classSysProfile.html#ae98fe6006760d363089bdefe67d11d8d">dumpBarrierName</a>(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;                tree_soft_profile.<a class="code" href="classFDPSProfile.html#a00c543c78cce28a08c0d40c5bf32cbd4">dumpName</a>(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;                tree_nb_profile.<a class="code" href="classFDPSProfile.html#a00c543c78cce28a08c0d40c5bf32cbd4">dumpName</a>(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="preprocessor">#if defined(USE_GPU) &amp;&amp; defined(GPU_PROFILE)</span></div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                gpu_profile.dumpName(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                gpu_counter.dumpName(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;                n_count.<a class="code" href="classSysCounts.html#a9d983bfda9790179f173da6f09af5d35">dumpName</a>(fprofile, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;                fprofile&lt;&lt;std::endl;</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;            }</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            fprofile&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        }</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="preprocessor">#endif    </span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        <span class="comment">// open output files</span></div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        <span class="comment">// status information output</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        std::string&amp; fname_snp = input_parameters.<a class="code" href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">fname_snp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;        <span class="keywordflow">if</span>(write_style&gt;0&amp;&amp;my_rank==0) {</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;            <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1) </div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;                fstatus.open((fname_snp+<span class="stringliteral">&quot;.status&quot;</span>).c_str(),std::ofstream::out|std::ofstream::app);</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;                fstatus.open((fname_snp+<span class="stringliteral">&quot;.status&quot;</span>).c_str(),std::ofstream::out);</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;                <span class="comment">// write titles of columns</span></div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                stat.<a class="code" href="classStatus.html#a7f0176ce36b41f113ac9cd02b0f541b3">printColumnTitle</a>(fstatus,<a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;                <span class="keywordflow">if</span> (write_style==2) {</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) system_soft[0].printColumnTitle(fstatus, <a class="code" href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a>);</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;                }</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                fstatus&lt;&lt;std::endl;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;            }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            fstatus&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        }</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160; </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        <span class="keywordflow">if</span>(write_style&gt;0) {</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;            <span class="comment">// open escaper file</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;            std::string my_rank_str = std::to_string(my_rank);</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;            std::string fname_esc = fname_snp + <span class="stringliteral">&quot;.esc.&quot;</span> + my_rank_str;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;            <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1) </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                fesc.open(fname_esc.c_str(), std::ofstream::out|std::ofstream::app);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                fesc.open(fname_esc.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                <span class="comment">// write titles of columns, will cause issue when gether different MPI ranks</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;                <span class="comment">// fesc&lt;&lt;std::setw(WRITE_WIDTH)&lt;&lt;&quot;Time&quot;;</span></div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;                <span class="comment">// FPSoft::printColumnTitle(fesc,WRITE_WIDTH);</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;                <span class="comment">// fesc&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            }</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            fesc&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;            <span class="comment">// open SSE/BSE file</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;            std::string fsse_name = fname_snp + fsse_par_suffix + <span class="stringliteral">&quot;.&quot;</span> + my_rank_str;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            std::string fbse_name = fname_snp + fbse_par_suffix + <span class="stringliteral">&quot;.&quot;</span> + my_rank_str;</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1) {</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.fout_sse.open(fsse_name.c_str(), std::ofstream::out|std::ofstream::app);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.fout_bse.open(fbse_name.c_str(), std::ofstream::out|std::ofstream::app);</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            }</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.fout_sse.open(fsse_name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.fout_bse.open(fbse_name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.fout_sse&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.fout_bse&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="preprocessor">#endif </span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="preprocessor">#ifdef ADJUST_GROUP_PRINT</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            <span class="comment">// open file for new/end group information</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            <span class="keywordflow">if</span> (input_parameters.adjust_group_write_option.value==1) {</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                std::string fgroup_name = fname_snp + <span class="stringliteral">&quot;.group.&quot;</span> + my_rank_str;</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;                <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">append_switcher</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1) </div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;                    hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.fgroup.open(fgroup_name.c_str(), std::ofstream::out|std::ofstream::app);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                <span class="keywordflow">else</span> </div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;                    hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.fgroup.open(fgroup_name.c_str(), std::ofstream::out);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;                hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.fgroup&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            }</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        }</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160; </div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="preprocessor">#ifdef HARD_DUMP</span></div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="comment">// initial hard_dump </span></div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> num_thread = PS::Comm::getNumberOfThread();</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        hard_dump.initial(num_thread, my_rank);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160; </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="comment">// particle system</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        system_soft.initialize();</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160; </div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;        <span class="comment">// domain decomposition</span></div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;        system_soft.setAverageTargetNumberOfSampleParticlePerProcess(input_parameters.<a class="code" href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">n_smp_ave</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#acdce743393992cd4186218680bed1034">PS::F32</a> coef_ema = 0.2;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;        domain_decompose_weight=1.0;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;        dinfo.initialize(coef_ema);</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160; </div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;        <span class="keywordflow">if</span>(pos_domain==NULL) {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;            pos_domain = <span class="keyword">new</span> PS::F64ort[n_proc];</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_proc; i++) pos_domain[i] = dinfo.getPosDomain(i);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160; </div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        <span class="comment">// tree for neighbor search</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        tree_nb.initialize(input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160; </div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        <span class="comment">// tree for force</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_tree_init = input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> + input_parameters.<a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        tree_soft.initialize(n_tree_init, input_parameters.<a class="code" href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">theta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">n_leaf_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">n_group_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;        <span class="comment">// initial search cluster</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;        search_cluster.<a class="code" href="classSearchCluster.html#a80b0896173dc501cd2457c1636289206">initialize</a>();</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160; </div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;        <span class="keywordflow">return</span> read_flag;</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    }</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    </div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="keywordtype">void</span> readDataFromFile() {</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;        assert(read_parameters_flag);</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;        <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==<span class="stringliteral">&quot;__NONE__&quot;</span>) {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;            std::cerr&lt;&lt;<span class="stringliteral">&quot;Error: the input data filename is not provided, make sure your options have the correct format.&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;            abort();</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;        }</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160; </div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;        <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> data_format = input_parameters.<a class="code" href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">data_format</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        <span class="keyword">auto</span>* data_filename = input_parameters.<a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>.c_str();</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                </div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;        <span class="keywordflow">if</span>(data_format==1||data_format==2||data_format==4)</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            system_soft.readParticleAscii(data_filename, file_header);</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;            system_soft.readParticleBinary(data_filename, file_header);</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        PS::Comm::broadcast(&amp;file_header, 1, 0);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_glb = system_soft.getNumberOfParticleGlobal();</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = system_soft.getNumberOfParticleLocal();</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160; </div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <span class="keywordflow">if</span>(input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>) {</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;            std::cout&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;----- Reading file: &quot;</span>&lt;&lt;data_filename&lt;&lt;<span class="stringliteral">&quot; -----&quot;</span>&lt;&lt;std::endl</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;Number of particles = &quot;</span>&lt;&lt;n_glb&lt;&lt;std::endl</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot;Time = &quot;</span>&lt;&lt;file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        }</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160; </div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a>;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> = stat.<a class="code" href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">n_all_glb</a> = n_glb;</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a> = n_loc;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mass = 0.0;</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_loc; i++) mass += system_soft[i].mass;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#ad020c438a456b75785265885bcbc2764">mass</a> = PS::Comm::getSum(mass);</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="preprocessor">#else        </span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#ad020c438a456b75785265885bcbc2764">mass</a> = mass;</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a> = file_header.pos_offset;</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a> = file_header.vel_offset;</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;        stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a4c4dec3144fdb4b077c095492a24969a">is_center_shift_flag</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="preprocessor">#endif        </span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;        input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = n_glb;</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160; </div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        read_data_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;    }</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160; </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> Tptcl&gt;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;    <span class="keywordtype">void</span> readDataFromArray(<a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> _n_partcle, Tptcl* _particle) {</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        assert(read_parameters_flag);</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160; </div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_glb = _n_partcle;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = n_glb / n_proc; </div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc &gt; my_rank) n_loc++;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_h = n_glb/n_proc*my_rank;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc  &gt; my_rank) i_h += my_rank;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;        <span class="keywordflow">else</span> i_h += n_glb % n_proc;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = n_glb;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_h = 0;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160; </div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        system_soft.setNumberOfParticleLocal(n_loc);</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;            <span class="keywordtype">int</span> k = i_h+i;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;            system_soft[i].mass  = _particle[k].getMass();</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;            system_soft[i].pos.x = _particle[k].getPos()[0];</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;            system_soft[i].pos.y = _particle[k].getPos()[1];</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;            system_soft[i].pos.z = _particle[k].getPos()[2];</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;            system_soft[i].vel.x = _particle[k].getVel()[0];</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            system_soft[i].vel.y = _particle[k].getVel()[1];</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;            system_soft[i].vel.z = _particle[k].getVel()[2];</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            system_soft[i].id = i_h+i+1;</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;            system_soft[i].group_data.artificial.setParticleTypeToSingle();</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        }</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160; </div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a> = 0;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        file_header.<a class="code" href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">n_body</a> = n_glb;</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a> = 0.0;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160; </div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;        stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = 0.0;</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;        stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> = stat.<a class="code" href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">n_all_glb</a> = n_glb;</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a> = n_loc;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;        stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;system_soft[0], n_loc, 3, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        file_header.pos_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        file_header.vel_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>;</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;        input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = n_glb;</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;        read_data_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160; </div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;    <span class="keywordtype">void</span> readDataFromArray(<a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> _n_partcle, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _mass, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _x, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _y, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _z, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _vx, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _vy, <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>* _vz, <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a>* _id=NULL) {</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        assert(read_parameters_flag);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160; </div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_glb = _n_partcle;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = n_glb / n_proc; </div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc &gt; my_rank) n_loc++;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_h = n_glb/n_proc*my_rank;</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc  &gt; my_rank) i_h += my_rank;</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;        <span class="keywordflow">else</span> i_h += n_glb % n_proc;</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = n_glb;</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_h = 0;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160; </div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        system_soft.setNumberOfParticleLocal(n_loc);</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        <span class="keywordflow">if</span> (_id!=NULL) {</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;                system_soft[i].mass = _mass[i_h+i];</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                system_soft[i].pos.x = _x[i_h+i];</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;                system_soft[i].pos.y = _y[i_h+i];</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;                system_soft[i].pos.z = _z[i_h+i];</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;                system_soft[i].vel.x = _vx[i_h+i];</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;                system_soft[i].vel.y = _vy[i_h+i];</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;                system_soft[i].vel.z = _vz[i_h+i];</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                system_soft[i].id = _id[i_h+i];</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                system_soft[i].group_data.artificial.setParticleTypeToSingle();</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;                assert(_id[i_h+i]&gt;0);</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;            }</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        }</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;            <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                system_soft[i].mass = _mass[i_h+i];</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                system_soft[i].pos.x = _x[i_h+i];</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                system_soft[i].pos.y = _y[i_h+i];</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                system_soft[i].pos.z = _z[i_h+i];</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                system_soft[i].vel.x = _vx[i_h+i];</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                system_soft[i].vel.y = _vy[i_h+i];</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                system_soft[i].vel.z = _vz[i_h+i];</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                system_soft[i].id = i_h+i+1;</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                system_soft[i].group_data.artificial.setParticleTypeToSingle();</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;            }</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;        }</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a> = 0;</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        file_header.<a class="code" href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">n_body</a> = n_glb;</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a> = 0.0;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160; </div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = 0.0;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> = stat.<a class="code" href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">n_all_glb</a> = n_glb;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a> = n_loc;</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;        stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;system_soft[0], n_loc, 3, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160; </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;        file_header.pos_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;        file_header.vel_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>;</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160; </div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;        input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = n_glb;</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160; </div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;        read_data_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    }</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;    <span class="keywordtype">void</span> generatePlummer() {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;        <span class="comment">// ensure parameters are used</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        assert(read_parameters_flag);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160; </div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_glb = input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;        assert(n_glb&gt;0);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = n_glb / n_proc; </div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc &gt; my_rank) n_loc++;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        system_soft.setNumberOfParticleLocal(n_loc);</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160; </div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> * mass;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> * pos;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> * vel;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160; </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> m_tot = 1.0;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> eng = -0.25;</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160; </div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;        <a class="code" href="classParticleDistributionGenerator.html#a07e0c5fd52b542a040c885cf5f4aec7a">ParticleDistributionGenerator::makePlummerModel</a>(m_tot, n_glb, n_loc, mass, pos, vel, eng);</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160; </div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_h = n_glb/n_proc*my_rank;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc  &gt; my_rank) i_h += my_rank;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        <span class="keywordflow">else</span> i_h += n_glb % n_proc;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            system_soft[i].mass = mass[i];</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;            system_soft[i].pos = pos[i];</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            system_soft[i].vel = vel[i];</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            system_soft[i].id = i_h + i + 1;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;            system_soft[i].radius = 0.0;</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;            system_soft[i].dm = 0.0;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;            system_soft[i].time_record = 0.0;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;            system_soft[i].time_interrupt = 0.0;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;            system_soft[i].binary_state = 0;</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;            system_soft[i].star.initial(mass[i]*bse_parameters.<a class="code" href="classIOParamsBSE.html#aa8274f54dfd8538bef1f43110dfb4e4d">mscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;            system_soft[i].group_data.artificial.setParticleTypeToSingle();</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        }</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160; </div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a> = 0;</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;        file_header.<a class="code" href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">n_body</a> = n_glb;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a> = 0.0;</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160; </div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = 0.0;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> = stat.<a class="code" href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">n_all_glb</a> = n_glb;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a> = n_loc;</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160; </div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;system_soft[0], n_loc, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;        file_header.pos_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        file_header.vel_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>;</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; </div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        read_data_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160; </div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;        <span class="keyword">delete</span> [] mass;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;        <span class="keyword">delete</span> [] pos;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;        <span class="keyword">delete</span> [] vel;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    }</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160; </div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; </div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;    <span class="keywordtype">void</span> generateKeplerDisk(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> ax_in, <span class="comment">// [AU]</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> ax_out, <span class="comment">// [AU]</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> ecc_rms, <span class="comment">// normalized</span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> inc_rms, <span class="comment">// normalized</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dens = 10.0, <span class="comment">// [g/cm^2]</span></div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mass_sun = 1.0, <span class="comment">//[m_sun]</span></div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> a_ice = 0.0,</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> f_ice = 1.0,</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">double</span> power = -1.5,</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                            <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> seed = 0) {</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;        </div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <span class="comment">// ensure parameters are used</span></div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;        assert(read_parameters_flag);</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160; </div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_glb = input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;        assert(n_glb&gt;0);</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160; </div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = n_glb / n_proc; </div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc &gt; my_rank) n_loc++;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;        system_soft.setNumberOfParticleLocal(n_loc);</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160; </div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> * mass;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> * pos;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> * vel;</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mass_planet_glb;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;        <a class="code" href="classParticleDistributionGenerator.html#ad955d89d061b82c3f1b0d0d956b8185e">ParticleDistributionGenerator::makeKeplerDisk</a>(mass_planet_glb, mass, pos, vel, n_glb, n_loc,</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                                                      ax_in, ax_out, ecc_rms, inc_rms, dens, mass_sun, a_ice, f_ice, power, seed);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; </div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i_h = n_glb/n_proc*my_rank;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <span class="keywordflow">if</span>( n_glb % n_proc  &gt; my_rank) i_h += my_rank;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        <span class="keywordflow">else</span> i_h += n_glb % n_proc;</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            system_soft[i].mass = mass[i];</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;            system_soft[i].pos = pos[i];</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            system_soft[i].vel = vel[i];</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            system_soft[i].id = i_h + i + 1;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            system_soft[i].group_data.artificial.setParticleTypeToSingle();</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;        }</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160; </div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a> = 0;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = file_header.<a class="code" href="classFileHeader.html#a3b50f979bd6770010875255529015591">time</a> = 0.0;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        file_header.<a class="code" href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">n_body</a> = n_glb;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160; </div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> = stat.<a class="code" href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">n_all_glb</a> = n_glb;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;        stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a> = stat.<a class="code" href="classStatus.html#a16948b9f8395887fd619627b5df0c619">n_all_loc</a> = n_loc;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160; </div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;        stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;system_soft[0], n_loc, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        file_header.pos_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a>;</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        file_header.vel_offset = stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160; </div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        read_data_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160; </div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;        <span class="keyword">delete</span> [] mass;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        <span class="keyword">delete</span> [] pos;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        <span class="keyword">delete</span> [] vel;</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    }</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160; </div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    <span class="keywordtype">void</span> initialParameters() {</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        <span class="comment">// ensure data is read</span></div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        assert(read_data_flag);</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        assert(stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>&gt;0);</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160; </div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <span class="keywordtype">bool</span> print_flag = input_parameters.<a class="code" href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">print_flag</a>;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        <span class="keywordtype">int</span> write_style = input_parameters.<a class="code" href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">write_style</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;        std::cout&lt;&lt;std::setprecision(<a class="code" href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a>);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;        <span class="comment">// units</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keywordflow">if</span> (input_parameters.<a class="code" href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">unit_set</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>==1) {</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;            input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 0.00449830997959438; <span class="comment">// pc^3/(Msun*Myr^2)</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;            bse_parameters.<a class="code" href="classIOParamsBSE.html#ac385ca33abb342a264e4180aa5fbca4f">tscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 1.0; <span class="comment">// Myr</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            bse_parameters.<a class="code" href="classIOParamsBSE.html#ad010440b7d8abbcd67597f1d88eb3789">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 44353565.919218; <span class="comment">// pc -&gt; rsun</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;            bse_parameters.<a class="code" href="classIOParamsBSE.html#aa8274f54dfd8538bef1f43110dfb4e4d">mscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 1.0; <span class="comment">// Msun</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            bse_parameters.<a class="code" href="classIOParamsBSE.html#a74d7120d680227042b2eed49f8b3476a">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> = 0.977813107686401; <span class="comment">// pc/Myr -&gt; km/s</span></div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;            <span class="keywordflow">if</span>(print_flag) {</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                std::cout&lt;&lt;<span class="stringliteral">&quot;----- Unit set 1: Msun, pc, Myr -----\n&quot;</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;                         &lt;&lt;<span class="stringliteral">&quot;gravitational_constant = &quot;</span>&lt;&lt;input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot; pc^3/(Msun*Myr^2)\n&quot;</span>;</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;                std::cout&lt;&lt;<span class="stringliteral">&quot;----- Unit conversion for BSE ----- \n&quot;</span></div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;                         &lt;&lt;<span class="stringliteral">&quot; tscale = &quot;</span>&lt;&lt;bse_parameters.<a class="code" href="classIOParamsBSE.html#ac385ca33abb342a264e4180aa5fbca4f">tscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot;  Myr / Myr\n&quot;</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                         &lt;&lt;<span class="stringliteral">&quot; mscale = &quot;</span>&lt;&lt;bse_parameters.<a class="code" href="classIOParamsBSE.html#aa8274f54dfd8538bef1f43110dfb4e4d">mscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot;  Msun / Msun\n&quot;</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;                         &lt;&lt;<span class="stringliteral">&quot; rscale = &quot;</span>&lt;&lt;bse_parameters.<a class="code" href="classIOParamsBSE.html#ad010440b7d8abbcd67597f1d88eb3789">rscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot;  Rsun / pc\n&quot;</span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                         &lt;&lt;<span class="stringliteral">&quot; vscale = &quot;</span>&lt;&lt;bse_parameters.<a class="code" href="classIOParamsBSE.html#a74d7120d680227042b2eed49f8b3476a">vscale</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&lt;&lt;<span class="stringliteral">&quot;  [km/s] / [pc/Myr]\n&quot;</span>;</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160; </div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;            }</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">//#ifdef GALPY</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">//            galpy_parameters.setStdUnit(print_flag);</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160; </div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;        }</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160; </div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;        <span class="comment">// calculate system parameters</span></div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> r_in, mass_average, vel_disp;<span class="comment">// mass_max, vel_max;</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; r_out = input_parameters.<a class="code" href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">r_out</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; r_bin = input_parameters.<a class="code" href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">r_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; r_search_min = input_parameters.<a class="code" href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">r_search_min</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;<span class="comment">//        PS::F64&amp; r_search_max = input_parameters.r_search_max.value;</span></div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; dt_soft = input_parameters.<a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; dt_snap = input_parameters.<a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; search_vel_factor =  input_parameters.<a class="code" href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">search_vel_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; ratio_r_cut   =  input_parameters.<a class="code" href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">ratio_r_cut</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a>&amp; n_bin         =  input_parameters.<a class="code" href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">n_bin</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <span class="comment">//PS::F64&amp; theta         =  input_parameters.theta.value;</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; G             =  input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>&amp; nstep_dt_soft_kepler = input_parameters.<a class="code" href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">nstep_dt_soft_kepler</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160; </div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        <span class="comment">// local particle number</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_loc = system_soft.getNumberOfParticleLocal();</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160; </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        <span class="comment">// local c.m velocity</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> vel_cm_loc = 0.0;</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;        <span class="comment">// local c.m. pos</span></div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> pos_cm_loc = 0.0;</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;        <span class="comment">// local c.m. mass</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mass_cm_loc = 0.0;</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;        <span class="comment">// local maximum mass</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;        <span class="comment">//PS::F64 mass_max_loc = 0.0;</span></div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;        <span class="comment">// box size</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> rmax=0.0;</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160; </div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;        <span class="keywordflow">for</span>(<a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i=0; i&lt;n_loc; i++){</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mi = system_soft[i].mass;</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;            <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> vi = system_soft[i].vel;</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> ri = system_soft[i].pos;</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160; </div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;<span class="preprocessor">#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;            assert(mi&gt;0);</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;            mass_cm_loc += mi;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            vel_cm_loc += mi * vi;</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;            pos_cm_loc += mi * ri;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> r2 = ri*ri;</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;            rmax = <a class="code" href="namespacePIKG.html#aede68ae33404ee6199164897b8cbc9ad">std::max</a>(r2,rmax);</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;            <span class="comment">//mass_max_loc = std::max(mi, mass_max_loc);</span></div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        }</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;        rmax = std::sqrt(rmax);</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> rmax_glb = PS::Comm::getMaxValue(rmax);</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160; </div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <span class="comment">// global c.m. parameters</span></div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>    mass_cm_glb = PS::Comm::getSum(mass_cm_loc);</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="comment">//mass_max = PS::Comm::getMaxValue(mass_max_loc);</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> pos_cm_glb  = PS::Comm::getSum(pos_cm_loc);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;        <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> vel_cm_glb  = PS::Comm::getSum(vel_cm_loc);</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;        pos_cm_glb /= mass_cm_glb;</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;        vel_cm_glb /= mass_cm_glb;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160; </div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> rmin_glb = std::sqrt(pos_cm_glb*pos_cm_glb);</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160; </div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        <span class="comment">// local velocity square</span></div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> vel_sq_loc = 0.0;</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> n_vel_loc_count = 0;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160; </div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;        <span class="comment">// single particle starting index</span></div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> single_start_index = 0;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> bin_last_id = 2*n_bin;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        <span class="keywordflow">if</span> (system_soft[0].<span class="keywordtype">id</span>&lt;bin_last_id) {</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;            single_start_index = <a class="code" href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">std::min</a>(bin_last_id - system_soft[0].<span class="keywordtype">id</span> + 1,n_loc);</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;            <span class="keywordflow">if</span>(single_start_index%2!=0) single_start_index--;</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;        }</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;        <span class="comment">// binary particle starting index</span></div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> binary_start_index = (system_soft[0].id%2==0)?1:0;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160; </div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="comment">// calculate velocity dispersion</span></div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i=binary_start_index; i&lt;single_start_index; i+=2) {</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> m1 = system_soft[i].mass;</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> m2 = system_soft[i+1].mass;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;            <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> dv = (m1*system_soft[i].vel + m2*system_soft[i+1].vel)/(m1+m2) - vel_cm_glb;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;            vel_sq_loc += dv * dv;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            n_vel_loc_count++;</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;        }</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    </div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;        <span class="keywordflow">if</span> (single_start_index &lt;n_loc) </div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> i=single_start_index; i&lt;n_loc; i++){</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;                <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> dv = system_soft[i].vel - vel_cm_glb;</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;                vel_sq_loc += dv * dv;</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;                n_vel_loc_count++;</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;            }</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160; </div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a>    n_vel_glb_count= PS::Comm::getSum(n_vel_loc_count);</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a>    n_glb          = PS::Comm::getSum(n_loc);</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>    vel_sq_glb     = PS::Comm::getSum(vel_sq_loc);</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        vel_disp   = sqrt(vel_sq_glb / 3.0 / (<a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>)n_vel_glb_count);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mass_average_glb = mass_cm_glb/(<a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a>)n_glb;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        mass_average = mass_average_glb;</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160; </div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;        <span class="comment">// flag to check whether r_ous is already defined</span></div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keywordtype">bool</span> r_out_flag = (r_out&gt;0);</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    </div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        <span class="comment">// if r_out is already defined, calculate r_in based on ratio_r_cut</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;        <span class="keywordflow">if</span> (r_out_flag) r_in = r_out * ratio_r_cut;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <span class="comment">// calculate r_out based on virial radius scaled with (N)^(1/3), calculate r_in by ratio_r_cut</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;            <span class="keywordflow">if</span> (n_glb&gt;1) {</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;                r_out = <a class="code" href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">std::min</a>(0.1*G*mass_cm_glb/(std::pow(n_glb,1.0/3.0)) / (3*vel_disp*vel_disp), 3.0*(rmax_glb-rmin_glb));</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;                r_in = r_out * ratio_r_cut;</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;            }</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                <span class="comment">// give two small values, no meaning at all</span></div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                r_out = 1e-16;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;                r_in = r_out*ratio_r_cut;</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;In one particle case, changeover radius is set to a small value\n&quot;</span>;</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;            }</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        }</div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160; </div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        <span class="comment">// if tree time step is not defined, calculate tree time step by r_out and velocity dispersion</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;        <span class="keywordflow">if</span> (dt_soft==0.0) {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;            <span class="keywordflow">if</span> (n_glb==1) {</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;                <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;In one particle case, tree time step is finishing - starting time\n&quot;</span>;</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;                dt_soft = input_parameters.<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> - stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>;</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;            }</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;                <span class="comment">// 1/nstep of a binary period with semi-major axis = r_int.</span></div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;                <span class="keywordflow">if</span> (nstep_dt_soft_kepler&gt;0)  </div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;                    dt_soft = regularTimeStep(COMM::Binary::semiToPeriod(r_in, mass_average, G)/nstep_dt_soft_kepler);</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;                <span class="keywordflow">else</span> </div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;                    dt_soft = regularTimeStep(0.1*r_out / vel_disp);</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;            }</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        }</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;            dt_soft = regularTimeStep(dt_soft);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;            <span class="comment">// if r_out is not defined, adjust r_out to minimum based on tree step</span></div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;            <span class="keywordflow">if</span> (!r_out_flag) {</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;                <span class="keywordflow">if</span> (n_glb&gt;1) {</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;                    <span class="keywordflow">if</span> (nstep_dt_soft_kepler&gt;0) {</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;                            r_in = COMM::Binary::periodToSemi(dt_soft*nstep_dt_soft_kepler, mass_average, G);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;                            r_out = r_in / ratio_r_cut;</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;                    }</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;                        r_out = 10.0*dt_soft*vel_disp;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;                        r_in = r_out * ratio_r_cut;</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;                    }</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                }</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;                    r_out = 1e-16;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;                    r_in = r_out*ratio_r_cut;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;                    <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;In one particle case, changeover radius is set to a small value\n&quot;</span>;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;                }</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            }</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;        }</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160; </div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        <span class="comment">// if r_bin is not defined, set to theta * r_in</span></div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        <span class="keywordflow">if</span> (r_bin==0.0) r_bin = 0.8*r_in;</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160; </div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        <span class="comment">// if r_search_min is not defined, calculate by search_vel_factor*velocity_dispersion*tree_time_step + r_out</span></div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        <span class="keywordflow">if</span> (r_search_min==0.0) r_search_min = search_vel_factor*vel_disp*dt_soft + r_out;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;        <span class="comment">// if r_search_max is not defined, calcualte by 5*r_out</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="comment">//        if (r_search_max==0.0) r_search_max = 5*r_out;</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        <span class="comment">// calculate v_max based on r_search_max, tree time step and search_vel_factor</span></div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;        <span class="comment">//vel_max = (r_search_max - r_out) / dt_soft / search_vel_factor;</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="comment">// regularize output time</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        dt_snap = regularTimeStep(dt_snap);</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160; </div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <a class="code" href="classEPISoft.html#a1aa7e04f972b62365f20272e926ecbdc">EPISoft::eps</a>   = input_parameters.<a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <a class="code" href="classEPISoft.html#ad680f261dc954c1771bd1446d3289e4b">EPISoft::r_out</a> = r_out;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        <a class="code" href="classForceSoft.html#acbd19675019ce01e03779282bf9d2d5d">ForceSoft::grav_const</a> = input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;        <a class="code" href="classPtcl.html#a452aeb749947f5076dc1ec44ce8b3119">Ptcl::search_factor</a> = search_vel_factor;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        <a class="code" href="classPtcl.html#ac748724105c87e84400c053085291e6b">Ptcl::r_search_min</a> = r_search_min;</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;        <a class="code" href="classPtcl.html#a71024cba537fba6124b23fa39b0b7dbf">Ptcl::mean_mass_inv</a> = 1.0/mass_average;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;        <a class="code" href="classPtcl.html#a774fbb60e8482e1f77637418409bd3dd">Ptcl::r_group_crit_ratio</a> = r_bin/r_in;</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        <span class="comment">//Ptcl::vel_cm = vel_cm_glb;</span></div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;        escaper.<a class="code" href="classEscaper.html#a9590851cc9f8630c1492a4e3a463d22c">r_escape_sq</a> = input_parameters.<a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>*input_parameters.<a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;        escaper.<a class="code" href="classEscaper.html#aafe14c4313939d6e8e3c46e1848c3b28">check_energy_flag</a> = (input_parameters.<a class="code" href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">r_escape</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>&gt;=0);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160; </div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;        <span class="keywordflow">if</span>(print_flag) {</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        <span class="comment">// set print format</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;----- Parameter list: -----\n&quot;</span>;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot; mass_average = &quot;</span>&lt;&lt;mass_average   &lt;&lt;std::endl</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; r_in         = &quot;</span>&lt;&lt;r_in           &lt;&lt;std::endl</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; r_out        = &quot;</span>&lt;&lt;r_out          &lt;&lt;std::endl</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; r_bin        = &quot;</span>&lt;&lt;r_bin          &lt;&lt;std::endl</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; r_search_min = &quot;</span>&lt;&lt;r_search_min   &lt;&lt;std::endl</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; vel_disp     = &quot;</span>&lt;&lt;vel_disp       &lt;&lt;std::endl</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                     &lt;&lt;<span class="stringliteral">&quot; dt_soft      = &quot;</span>&lt;&lt;dt_soft        &lt;&lt;std::endl;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;        }</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160; </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;        <span class="comment">// check restart</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;        <span class="keywordtype">bool</span> restart_flag = file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a>; <span class="comment">// nfile = 0 is assumed as initial data file</span></div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160; </div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        <span class="comment">// set id_offset</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="preprocessor">#ifdef PETAR_DEBUG</span></div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        assert(stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> == input_parameters.<a class="code" href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">n_glb</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        assert(stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a> == system_soft.getNumberOfParticleGlobal());</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a>&amp; id_offset = input_parameters.<a class="code" href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">id_offset</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        id_offset = id_offset==-1 ? stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>+1 : id_offset;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        <span class="comment">// initial particles paramters</span></div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;        <span class="keywordflow">if</span> (!restart_flag) {</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) {</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                <span class="comment">// ID safety check </span></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                <a class="code" href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PS::S64</a> <span class="keywordtype">id</span> = system_soft[i].id;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                assert(id_offset&gt;<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;                assert(<span class="keywordtype">id</span>&gt;0);</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160; </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;                <span class="comment">// set changeover </span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> m_fac = system_soft[i].mass*<a class="code" href="classPtcl.html#a71024cba537fba6124b23fa39b0b7dbf">Ptcl::mean_mass_inv</a>;</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;                system_soft[i].changeover.setR(m_fac, r_in, r_out);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;                <span class="comment">// calculate r_search for particles, for binary, r_search depend on vel_disp</span></div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;                <span class="keywordflow">if</span>(<span class="keywordtype">id</span>&lt;=2*n_bin) system_soft[i].r_search = <a class="code" href="namespacePIKG.html#aede68ae33404ee6199164897b8cbc9ad">std::max</a>(r_search_min,vel_disp*dt_soft*search_vel_factor + system_soft[i].changeover.getRout());</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;                <span class="keywordflow">else</span> system_soft[i].calcRSearch(dt_soft);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160; </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;                <span class="keyword">auto</span>&amp; pi_cm = system_soft[i].group_data.cm;</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;                pi_cm.mass = pi_cm.vel.x = pi_cm.vel.y = pi_cm.vel.z = 0.0;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;            }</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;        }</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;            <span class="comment">// clear up group_data.cm to avoid issue in search neighbor; update changeover and r_search</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> i=0; i&lt;stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>; i++) {</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;                <span class="keyword">auto</span>&amp; pi_cm = system_soft[i].group_data.cm;</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160; </div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;                <span class="comment">// update changeover</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;                <span class="keywordflow">if</span> (input_parameters.<a class="code" href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">update_changeover_flag</a>) {</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;                    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> m_fac = system_soft[i].mass*<a class="code" href="classPtcl.html#a71024cba537fba6124b23fa39b0b7dbf">Ptcl::mean_mass_inv</a>;</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;                    system_soft[i].changeover.setR(m_fac, r_in, r_out);</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;                }</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160; </div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;                <span class="comment">// update research</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;                <span class="keywordflow">if</span> (input_parameters.<a class="code" href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">update_rsearch_flag</a>) {</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;                    <span class="keywordflow">if</span> (pi_cm.mass!=0.0) {</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;<span class="comment">//#ifdef GROUP_DATA_WRITE_ARTIFICIAL</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;                        system_soft[i].r_search = <a class="code" href="namespacePIKG.html#aede68ae33404ee6199164897b8cbc9ad">std::max</a>(r_search_min, vel_disp*dt_soft*search_vel_factor + system_soft[i].changeover.getRout());</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;<span class="comment">// not correct, when data is dumped, it is not cm information but artificial particle data</span></div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;<span class="comment">//#else</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;<span class="comment">//                        PS::F64 vcm = std::sqrt(pi_cm.vel*pi_cm.vel);</span></div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;<span class="comment">//                        system_soft[i].r_search = std::max(r_search_min,vcm*dt_soft*search_vel_factor + system_soft[i].changeover.getRout());</span></div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;                    }</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;                    <span class="keywordflow">else</span> system_soft[i].calcRSearch(dt_soft);</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;                }</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160; </div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;                pi_cm.mass = pi_cm.vel.x = pi_cm.vel.y = pi_cm.vel.z = 0.0;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            }</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;            stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;            stat.<a class="code" href="classStatus.html#a95226a9e5aceeea5c44e89b8a3bccb0c">calcCenterOfMass</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;            <span class="comment">//Ptcl::vel_cm = stat.pcm.vel;</span></div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;        }</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160; </div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        std::string galpy_conf_filename = input_parameters.<a class="code" href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">fname_inp</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>+<span class="stringliteral">&quot;.galpy&quot;</span>;</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        galpy_manager.<a class="code" href="classGalpyManager.html#ac6ce59845e4b863a3fce47c18e09631a">initial</a>(galpy_parameters, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, galpy_conf_filename, restart_flag, print_flag);</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    </div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        <span class="comment">// set system hard paramters</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a15998274cba2e1818e82ce08a2aaccb2">setDtRange</a>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>/input_parameters.<a class="code" href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">dt_limit_hard_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>, input_parameters.<a class="code" href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">dt_min_hermite_index</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#ad5806725afa5d1d09fc312531a699701">setEpsSq</a>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>*input_parameters.<a class="code" href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">eps</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a6911fcad253f3013f968eb2b14df5a26">setGravitationalConstant</a>(input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#ad7a092adf9d04898efbcee49c2912784">r_in_base</a> = r_in;</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a1081bf754ceeb9a61acbd96a3250e682">r_out_base</a> = r_out;</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="preprocessor">#ifdef HARD_CHECK_ENERGY</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a24a9393ae64ca5e77e8c71ec7d31fbd7">energy_error_max</a> = input_parameters.e_err_hard.value;</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a24a9393ae64ca5e77e8c71ec7d31fbd7">energy_error_max</a> = PS::LARGE_FLOAT;</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a51b15c2ff0aa0c7d18304d6c2926b89d">n_step_per_orbit</a> = input_parameters.<a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">ap_manager</a>.<a class="code" href="classArtificialParticleManager.html#a1807b5880300cd2a40e74b5c570d71a2">r_tidal_tensor</a> = r_bin;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">ap_manager</a>.<a class="code" href="classArtificialParticleManager.html#ab892e537c506f6e0c29d0e7e86113e58">id_offset</a> = id_offset;</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="preprocessor">#ifdef ORBIT_SAMPLING</span></div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">ap_manager</a>.<a class="code" href="classArtificialParticleManager.html#a652d6cdf139b4fef72816be7d7439de6">orbit_manager</a>.setParticleSplitN(input_parameters.n_split.value);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.step.eta_4th = input_parameters.<a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.step.eta_2nd = 0.01*input_parameters.<a class="code" href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">eta</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.step.calcAcc0OffsetSq(mass_average, r_out, input_parameters.<a class="code" href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">gravitational_constant</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.energy_error_relative_max = input_parameters.<a class="code" href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">e_err_ar</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.step_count_max = input_parameters.<a class="code" href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">step_limit_ar</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.step.initialSymplecticCofficients(-6);</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.slowdown_pert_ratio_ref = input_parameters.<a class="code" href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">sd_factor</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.slowdown_timescale_max = dt_soft*input_parameters.<a class="code" href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">n_step_per_orbit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;        <span class="comment">//hard_manager.ar_manager.slowdown_timescale_max = dt_soft;</span></div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="preprocessor">#ifdef SLOWDOWN_MASSRATIO</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.slowdown_mass_ref = mass_average;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interrupt_detection_option = input_parameters.<a class="code" href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">interrupt_detection_option</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.stellar_evolution_option = input_parameters.stellar_evolution_option.value;</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        <span class="keywordflow">if</span> (write_style) hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.stellar_evolution_write_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;        <span class="keywordflow">else</span> hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.stellar_evolution_write_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;        <span class="keywordflow">if</span> (input_parameters.stellar_evolution_option.value&gt;0) {</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.bse_manager.initial(bse_parameters, print_flag);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.tide.speed_of_light = hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.bse_manager.getSpeedOfLight();</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;        }</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;<span class="preprocessor">#ifdef ADJUST_GROUP_PRINT</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        <span class="comment">// group information</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        <span class="keywordflow">if</span> (write_style&amp;&amp;input_parameters.adjust_group_write_option.value==1) </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.adjust_group_write_flag=<span class="keyword">true</span>;</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        <span class="keywordflow">else</span> </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.adjust_group_write_flag=<span class="keyword">false</span>;</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;<span class="preprocessor">#endif        </span></div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160; </div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;        <span class="comment">// check consistence of paramters</span></div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        input_parameters.<a class="code" href="classIOParamsPeTar.html#a6126c51ce250b208260fbe6ca073f1ac">checkParams</a>();</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;        hard_manager.<a class="code" href="classHardManager.html#af7548086113d591778ce878a53dad036">checkParams</a>();</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160; </div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;        <span class="comment">// initial hard class and parameters</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#a6c021c99c3f6ae3adbfbc3a4929fd06f">manager</a> = &amp;hard_manager;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;        system_hard_one_cluster.<a class="code" href="classSystemHard.html#abd543bc60e7a4e5e19a73c1e5fa8c612">setTimeOrigin</a>(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>);</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160; </div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#a689b06c61c96f9d0cd2447402b83d3fc">allocateHardIntegrator</a>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#a6c021c99c3f6ae3adbfbc3a4929fd06f">manager</a> = &amp;hard_manager;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        system_hard_isolated.<a class="code" href="classSystemHard.html#abd543bc60e7a4e5e19a73c1e5fa8c612">setTimeOrigin</a>(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>);</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160; </div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a689b06c61c96f9d0cd2447402b83d3fc">allocateHardIntegrator</a>(input_parameters.<a class="code" href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">n_interrupt_limit</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#a6c021c99c3f6ae3adbfbc3a4929fd06f">manager</a> = &amp;hard_manager;</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        system_hard_connected.<a class="code" href="classSystemHard.html#abd543bc60e7a4e5e19a73c1e5fa8c612">setTimeOrigin</a>(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>);</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160; </div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;        time_kick = stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>;</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160; </div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        <span class="keywordflow">if</span>(write_style&gt;0&amp;&amp;my_rank==0) {</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;-----  Dump parameter files -----&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;            <span class="comment">// save initial parameters</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;            std::string&amp; fname_par = input_parameters.<a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;            <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Save input parameters to file &quot;</span>&lt;&lt;fname_par&lt;&lt;std::endl;</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;            FILE* fpar_out;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;            <span class="keywordflow">if</span>( (fpar_out = fopen(fname_par.c_str(),<span class="stringliteral">&quot;w&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                fprintf(stderr,<span class="stringliteral">&quot;Error: Cannot open file %s.\n&quot;</span>, fname_par.c_str());</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                abort();</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;            }</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;            input_parameters.<a class="code" href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a4e42d749bdaeba0cbf805d45f2401aa1">writeAscii</a>(fpar_out);</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;            fclose(fpar_out);</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160; </div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;            <span class="comment">// save hard paramters </span></div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;            std::string fhard_par = input_parameters.<a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> + <span class="stringliteral">&quot;.hard&quot;</span>;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;            <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Save hard_manager parameters to file &quot;</span>&lt;&lt;fhard_par&lt;&lt;std::endl;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;            <span class="keywordflow">if</span>( (fpar_out = fopen(fhard_par.c_str(),<span class="stringliteral">&quot;w&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;                fprintf(stderr,<span class="stringliteral">&quot;Error: Cannot open file %s.\n&quot;</span>, fhard_par.c_str());</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;                abort();</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;            }</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#accedec239afc4e94f6120b9fb7704860">writeBinary</a>(fpar_out);</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            fclose(fpar_out);</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160; </div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            <span class="comment">// save bse parameters</span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            std::string fbse_par = input_parameters.<a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> + fbse_par_suffix;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;            <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Save bse_parameters to file &quot;</span>&lt;&lt;fbse_par&lt;&lt;std::endl;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;            <span class="keywordflow">if</span>( (fpar_out = fopen(fbse_par.c_str(),<span class="stringliteral">&quot;w&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;                fprintf(stderr,<span class="stringliteral">&quot;Error: Cannot open file %s.\n&quot;</span>, fbse_par.c_str());</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                abort();</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;            }</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            bse_parameters.<a class="code" href="classIOParamsBSE.html#accccd85595390fa0c1b3a8e80325efd3">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a4e42d749bdaeba0cbf805d45f2401aa1">writeAscii</a>(fpar_out);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            fclose(fpar_out);</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160; </div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            <span class="comment">// save galpy parameters</span></div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;            std::string fgalpy_par = input_parameters.<a class="code" href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">fname_par</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a> + <span class="stringliteral">&quot;.galpy&quot;</span>;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;            <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;Save galpy_parameters to file &quot;</span>&lt;&lt;fgalpy_par&lt;&lt;std::endl;</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;            <span class="keywordflow">if</span>( (fpar_out = fopen(fgalpy_par.c_str(),<span class="stringliteral">&quot;w&quot;</span>)) == NULL) {</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;                fprintf(stderr,<span class="stringliteral">&quot;Error: Cannot open file %s.\n&quot;</span>, fgalpy_par.c_str());</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                abort();</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            }</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;            galpy_parameters.<a class="code" href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">input_par_store</a>.<a class="code" href="classIOParamsContainer.html#a4e42d749bdaeba0cbf805d45f2401aa1">writeAscii</a>(fpar_out);</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;            fclose(fpar_out);</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        }</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160; </div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;        <span class="comment">// initial tree step manager</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        dt_manager.<a class="code" href="classKickDriftStep.html#a31da641094322c1d3e95a220450a02da">setKDKMode</a>();</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160; </div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;        <span class="keywordflow">if</span> (print_flag) std::cout&lt;&lt;<span class="stringliteral">&quot;-----  Finish parameter initialization -----&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160; </div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;        initial_parameters_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    }</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160; </div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <span class="keywordtype">void</span> initialStep() {</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        assert(initial_parameters_flag);</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="keywordflow">if</span> (initial_step_flag) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160; </div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        assert(checkTimeConsistence());</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160; </div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        <span class="comment">// one particle case</span></div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>==1) {</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <a class="code" href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a> = <a class="code" href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da13fd1a10d5921e99bd06b81590017ed6">GroupDataMode::artificial</a>;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160; </div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;            <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>==1) system_soft[0].clearForce();</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;            externalForce();</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160; </div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;            <span class="comment">// initial status and energy</span></div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;            updateStatus(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160; </div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_tree = input_parameters.<a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;            dt_manager.<a class="code" href="classKickDriftStep.html#af9cec4bb5599c16ca82eb4b11eb4e773">setStep</a>(dt_tree);</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160; </div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;            <span class="comment">// output initial data</span></div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;            file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a>--; <span class="comment">// avoid repeating files</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;            output();</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160; </div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;            clearProfile();</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;            initial_step_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160; </div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;        }</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160; </div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;        <span class="comment">// domain decomposition</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;        domainDecompose();</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160; </div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        <span class="comment">// exchange particles</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;        exchangeParticle();</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160; </div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_tree = input_parameters.<a class="code" href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">dt_soft</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;        dt_manager.<a class="code" href="classKickDriftStep.html#af9cec4bb5599c16ca82eb4b11eb4e773">setStep</a>(dt_tree);</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160; </div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;        <span class="comment">// &gt;1. Tree for neighbor searching </span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;<span class="comment"></span>        treeNeighborSearch();</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160; </div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        <span class="comment">// &gt;2. search clusters</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;<span class="comment"></span>        <a class="code" href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a> = <a class="code" href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da820eb5b696ea2a657c0db1e258dc7d81">GroupDataMode::cm</a>;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;        searchCluster();</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160; </div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;        <span class="comment">// &gt;3. find group and create artificial particles</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;<span class="comment"></span>        createGroup(dt_tree);</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;        <span class="comment">// &gt;4 tree soft force</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="comment"></span>        treeSoftForce();</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160; </div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;        externalForce();</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160; </div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        <span class="comment">// &gt;5 correct change over</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;<span class="comment"></span>        treeForceCorrectChangeover();</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160; </div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;        <span class="comment">// correct force due to the change over update</span></div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;        correctForceChangeOverUpdate();</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160; </div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;        <span class="comment">// recover mass</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;        kickClusterAndRecoverGroupMemberMass(system_soft, system_hard_isolated.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), 0);</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160; </div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL</span></div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        <span class="comment">// connected</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;        kickClusterAndRecoverGroupMemberMass(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>(), 0);</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;        <span class="comment">// sending list for connected clusters</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;        kickSend(system_soft, search_cluster.<a class="code" href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">getAdrSysConnectClusterSend</a>(), 0);</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;        <span class="comment">// send kicked particle from sending list, and receive remote single particle</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;        search_cluster.SendSinglePtcl(system_soft, system_hard_connected.<a class="code" href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">getPtcl</a>());</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160; </div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        <span class="comment">// update global particle system due to kick</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;        writeBackHardParticles();</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160; </div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;        <span class="comment">// initial status and energy</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        updateStatus(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160; </div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;        <span class="comment">// output initial data</span></div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        file_header.<a class="code" href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">nfile</a>--; <span class="comment">// avoid repeating files</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        output();</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160; </div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;        <span class="comment">// remove artificial particles</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;        system_soft.setNumberOfParticleLocal(stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160; </div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;<span class="preprocessor">#ifdef CLUSTER_VELOCITY</span></div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;        setParticleGroupDataToCMData();</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160; </div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;        clearProfile();</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;        initial_step_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;    }</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160; </div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> integrateOneToTime(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _time_break=0.0) {</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <span class="comment">// ensure it is initialized</span></div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;        assert(initial_step_flag);</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;        assert(stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>==1);</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160; </div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;        <span class="comment">// check time break</span></div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> time_break = _time_break==0.0? input_parameters.<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>: <a class="code" href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">std::min</a>(_time_break,input_parameters.<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;        <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>&gt;=time_break) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160; </div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;        <span class="comment">//PS::F64 dt = std::min(input_parameters.dt_soft.value, time_break-stat.time);</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_output = input_parameters.<a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;        <span class="comment">//bool start_flag=true;</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160; </div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;        <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>==1) { </div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            assert(system_soft.getNumberOfParticleLocal()==1);</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;            <span class="keyword">auto</span>&amp; p = system_soft[0];</div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160; </div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;            <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;                </div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;                <span class="comment">// reset total potential</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;                p.clearForce();</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160; </div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;                externalForce();</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160; </div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;                stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;p, stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160; </div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                <span class="keywordtype">bool</span> interrupt_flag = <span class="keyword">false</span>;  <span class="comment">// for interrupt integration when time reach end</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                <span class="keywordtype">bool</span> output_flag = <span class="keyword">false</span>;    <span class="comment">// for output snapshot and information</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160; </div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_kick, dt_drift;</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                <span class="comment">// for initial the system</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                <span class="keywordflow">if</span> (dt_manager.<a class="code" href="classKickDriftStep.html#a6a0d5294c1a8b179b73282c56a0ede0c">isNextStart</a>()) {</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160; </div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                    <span class="comment">// set step to the begining step</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                    dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#a59127c2c2bf117e0687726ebcf43d6f0">getDtStartContinue</a>();</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                }</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;                <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;                    <span class="comment">// increase loop counter</span></div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;                    n_loop++;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160; </div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;                    <span class="comment">// for next kick-drift pair</span></div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;                    dt_manager.<a class="code" href="classKickDriftStep.html#a66510cbd00fe10a923aa1846f83f1451">nextContinue</a>();</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;                    </div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                    <span class="keywordflow">if</span> (dt_manager.<a class="code" href="classKickDriftStep.html#a41d3e9e230a42bf0ddc5c419d7b70aaa">isNextEndPossible</a>()) {</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160; </div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;                        <span class="comment">// output step, get last kick step</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;                        output_flag = (fmod(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, dt_output) == 0.0);</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160; </div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                        <span class="comment">// check interruption</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;                        interrupt_flag = (stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>&gt;=time_break);</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160; </div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;                        <span class="keywordflow">if</span> (output_flag||interrupt_flag) dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#aa2ca643bb9ff0dd17a27968b0b3a3d16">getDtEndContinue</a>();</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                        <span class="keywordflow">else</span> dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#aab1d155c3b9c827a131539d82925794a">getDtKickContinue</a>();</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;                    }</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;                    <span class="keywordflow">else</span> dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#aab1d155c3b9c827a131539d82925794a">getDtKickContinue</a>();</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;                }</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                </div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                <span class="comment">//kick </span></div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;                p.vel += p.acc * dt_kick;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                galpy_manager.<a class="code" href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da">kickMovePot</a>(dt_kick);</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                time_kick += dt_kick;</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160; </div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;                <span class="comment">// output information</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;                <span class="keywordflow">if</span>(output_flag) {</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160; </div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;                    updateStatus(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;                    output();</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;                    <span class="comment">// profile</span></div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                    profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;                    PS::Comm::barrier();</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                    profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160; </div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                    printProfile();</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;                    clearProfile();</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160; </div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;                    PS::Comm::barrier();</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;                    profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                }</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160; </div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                <span class="comment">// interrupt</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                <span class="keywordflow">if</span>(interrupt_flag) {</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;                    assert(checkTimeConsistence());</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                    profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;                    PS::Comm::barrier();</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;                    profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                }</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160; </div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                <span class="comment">// second kick if output exists </span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;                <span class="keywordflow">if</span>(output_flag) {</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;                    dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#a59127c2c2bf117e0687726ebcf43d6f0">getDtStartContinue</a>();</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;                    p.vel += p.acc * dt_kick;</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                    galpy_manager.<a class="code" href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da">kickMovePot</a>(dt_kick);</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;                    <span class="comment">// correct Ptcl:vel_cm</span></div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;                    correctPtclVelCM(dt_kick);</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;                    time_kick += dt_kick;</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;                }</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160; </div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                <span class="comment">// get drift step</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;                dt_drift = dt_manager.<a class="code" href="classKickDriftStep.html#ac13b3a09c5626975c412cdf331316c92">getDtDriftContinue</a>();</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160; </div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                p.pos += p.vel * dt_drift;</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160; </div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;                <span class="comment">// drift cm</span></div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">pos</a> += stat.<a class="code" href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">pcm</a>.<a class="code" href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">vel</a>*dt_drift;</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160; </div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;<span class="preprocessor">#ifdef GALPY</span></div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;                galpy_manager.<a class="code" href="classGalpyManager.html#a56875a530c45fac6439a6d6d4f671b3d">driftMovePot</a>(dt_drift);</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160; </div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;                <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> mbk = p.mass;</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;                <a class="code" href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PS::F64vec</a> vbk = p.vel; <span class="comment">//back up velocity in case of change</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;                <span class="keywordtype">int</span> modify_flag = hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.modifyOneParticle(p, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> + dt_drift);</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;                <span class="keywordflow">if</span> (modify_flag) {</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;                    <span class="keyword">auto</span>&amp; v = p.vel;</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;                    <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> de_kin = 0.5*(p.mass*(v[0]*v[0]+v[1]*v[1]+v[2]*v[2]) - mbk*(vbk[0]*vbk[0]+vbk[1]*vbk[1]+vbk[2]*vbk[2]));</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_cum += de_kin;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_sd_change_modify_single += de_kin;</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_cum += de_kin;</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.de_change_modify_single += de_kin;</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.<a class="code" href="classEnergyAndMomemtum.html#a01d39d5cf22000b7af75f3d14217374f">etot_ref</a> += de_kin;</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;                    stat.<a class="code" href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">energy</a>.etot_sd_ref += de_kin;</div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;                }</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;                <span class="comment">// shift time interrupt in order to get consistent time for stellar evolution in the next drift</span></div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;                <span class="comment">//p.time_record    -= dt;</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;                <span class="comment">//p.time_interrupt -= dt;</span></div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;                stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> += dt_drift;</div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160; </div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160; </div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;                calcProfile();</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;            }</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        }</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_tree = dt_manager.<a class="code" href="classKickDriftStep.html#a2d3302ea2190553e73fe1094e71d87ea">getStep</a>();</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;            <span class="keywordflow">while</span> (stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>  &lt; time_break) {</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;                stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> += dt_tree;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;                time_kick = stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>;</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;            }</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;        }</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160; </div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    }</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160; </div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    </div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160; </div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> integrateToTime(<span class="keyword">const</span> <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> _time_break=0.0) {</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160; </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;        <span class="comment">// ensure it is initialized</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;        assert(initial_step_flag);</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160; </div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;        <span class="comment">// for one particle case</span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;        <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">n_real_glb</a>==1) <span class="keywordflow">return</span> integrateOneToTime(_time_break);</div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160; </div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;        <span class="comment">// finish interrupted integrations</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_glb&gt;0) finishInterruptDrift();</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        <span class="comment">// if interrupt still exist, do not continue</span></div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        <span class="keywordflow">if</span> (n_interrupt_glb&gt;0) <span class="keywordflow">return</span> n_interrupt_glb;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160; </div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;        <span class="comment">// check time break</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> time_break = _time_break==0.0? input_parameters.<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>: <a class="code" href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">std::min</a>(_time_break,input_parameters.<a class="code" href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">time_end</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;        <span class="keywordflow">if</span> (stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>&gt;=time_break) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160; </div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_output = input_parameters.<a class="code" href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">dt_snap</a>.<a class="code" href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">value</a>;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;        <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_tree = dt_manager.<a class="code" href="classKickDriftStep.html#a2d3302ea2190553e73fe1094e71d87ea">getStep</a>();</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160; </div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;        <span class="keywordflow">while</span>(<span class="keyword">true</span>) {</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;            profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160; </div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;            <span class="comment">// correct soft potential energy due to mass change</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;            correctSoftPotMassChange();</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160; </div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;            <span class="comment">// remove artificial and ununsed particles in system_soft.</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;            removeParticles();</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160; </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="preprocessor">#ifdef RECORD_CM_IN_HEADER</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;            <span class="comment">// update center</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;            stat.<a class="code" href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">calcAndShiftCenterOfMass</a>(&amp;system_soft[0], stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160; </div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;            <span class="comment">// &gt;9. Domain decomposition</span></div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;            domainDecompose();</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160; </div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;            <span class="comment">// &gt;10. exchange particles</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;            exchangeParticle();</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160; </div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;            <span class="comment">// &gt;1. Tree for neighbor searching </span></div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<span class="comment"></span>            treeNeighborSearch();</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160; </div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;            <span class="comment">// &gt;2. search clusters</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="comment"></span>            searchCluster();</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160; </div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;            <span class="comment">// &gt;3. find group and create artificial particles</span></div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;<span class="comment"></span>            createGroup(dt_tree);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160; </div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;            <span class="comment">// &gt;4 tree soft force</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;<span class="comment"></span>            treeSoftForce() ;</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160; </div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;            externalForce();</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160; </div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;            <span class="comment">// &gt;5 correct change over and potential energy due to mass change</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment"></span>            treeForceCorrectChangeover();</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160; </div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160; </div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="preprocessor">#ifdef KDKDK_4TH</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;            <span class="comment">// only do correction at middle step</span></div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;            <span class="keywordflow">if</span> (dt_manager.<a class="code" href="classKickDriftStep.html#a6ba6476cb397b9177ce4e175d947d3de">getCountContinue</a>() == 1) GradientKick();</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160; </div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;            <span class="keywordtype">bool</span> interrupt_flag = <span class="keyword">false</span>;  <span class="comment">// for interrupt integration when time reach end</span></div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;            <span class="keywordtype">bool</span> output_flag = <span class="keyword">false</span>;    <span class="comment">// for output snapshot and information</span></div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;            <span class="comment">//bool dt_mod_flag = false;    // for check whether tree time step need update</span></div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;            <span class="keywordtype">bool</span> changeover_flag = <span class="keyword">false</span>; <span class="comment">// for check whether changeover need update</span></div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;            <a class="code" href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PS::F64</a> dt_kick, dt_drift;</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160; </div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;            <span class="comment">// for initial the system</span></div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;            <span class="keywordflow">if</span> (dt_manager.<a class="code" href="classKickDriftStep.html#a6a0d5294c1a8b179b73282c56a0ede0c">isNextStart</a>()) {</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160; </div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;                <span class="comment">// update changeover if last time it is modified.</span></div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;                correctForceChangeOverUpdate();</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160; </div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;                <span class="comment">// set step to the begining step</span></div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#a59127c2c2bf117e0687726ebcf43d6f0">getDtStartContinue</a>();</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;            }</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;                profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;                <span class="comment">// increase loop counter</span></div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;                n_loop++;</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160; </div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;                <span class="comment">// for next kick-drift pair</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;                dt_manager.<a class="code" href="classKickDriftStep.html#a66510cbd00fe10a923aa1846f83f1451">nextContinue</a>();</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160; </div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;                <span class="comment">// update stat time </span></div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;                stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = system_hard_one_cluster.<a class="code" href="classSystemHard.html#aaa3225b5e3f3fdeef1626258addcae12">getTimeOrigin</a>();</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160; </div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;                <span class="comment">// check whether output or changeover change are needed (only at the ending step)</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;                <span class="keywordflow">if</span> (dt_manager.<a class="code" href="classKickDriftStep.html#a41d3e9e230a42bf0ddc5c419d7b70aaa">isNextEndPossible</a>()) {</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160; </div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;                    <span class="comment">// adjust tree step</span></div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;                    <span class="comment">//dt_mod_flag = adjustDtTreeReduce(dt_reduce_factor, dt_tree, dt_manager.getStep());</span></div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                    <span class="comment">//if(dt_mod_flag) dt_kick = dt_manager.getDtEndContinue();</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160; </div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                    <span class="comment">// output step, get last kick step</span></div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                    output_flag = (fmod(stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>, dt_output) == 0.0);</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160; </div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                    <span class="comment">// check changeover change</span></div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                    changeover_flag = (system_hard_isolated.<a class="code" href="classSystemHard.html#a9acc9ace45305aba14aedcaf2c8dcf7c">getNClusterChangeOverUpdate</a>()&gt;0);</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160; </div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;<span class="preprocessor">#ifdef PARTICLE_SIMULATOR_MPI_PARALLEL        </span></div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_changeover_modify_local  = system_hard_connected.<a class="code" href="classSystemHard.html#a9acc9ace45305aba14aedcaf2c8dcf7c">getNClusterChangeOverUpdate</a>() + system_hard_isolated.<a class="code" href="classSystemHard.html#a9acc9ace45305aba14aedcaf2c8dcf7c">getNClusterChangeOverUpdate</a>();</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;                    <a class="code" href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PS::S32</a> n_changeover_modify_global = PS::Comm::getSum(n_changeover_modify_local);</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;                    <span class="keywordflow">if</span> (n_changeover_modify_global&gt;0) changeover_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160; </div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                    <span class="comment">// check interruption</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                    interrupt_flag = (stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a>&gt;=time_break);</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160; </div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                    <span class="comment">// set next step to be last</span></div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                    <span class="keywordflow">if</span> (output_flag||changeover_flag||interrupt_flag) dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#aa2ca643bb9ff0dd17a27968b0b3a3d16">getDtEndContinue</a>();</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                    <span class="keywordflow">else</span> dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#aab1d155c3b9c827a131539d82925794a">getDtKickContinue</a>();</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                }</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;                <span class="keywordflow">else</span> dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#aab1d155c3b9c827a131539d82925794a">getDtKickContinue</a>();</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;                profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;                profile.<a class="code" href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">other</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;            }</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160; </div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160; </div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;            <span class="comment">// &gt;6. kick </span></div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;            kick(dt_kick);</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160; </div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;            <span class="comment">// &gt;7. write back data</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;            <span class="keywordflow">if</span>(output_flag||interrupt_flag) {</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                <span class="comment">// update global particle system due to kick</span></div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;                writeBackHardParticles();</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;            }</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160; </div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;            <span class="comment">// output information</span></div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;            <span class="keywordflow">if</span>(output_flag) {</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;                <span class="comment">// update status</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;                updateStatus(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;                output();</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160; </div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;                <span class="comment">// profile</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160; </div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;                printProfile();</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;                clearProfile();</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160; </div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">start</a>();</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;            }</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160; </div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;            <span class="comment">// modify the tree step</span></div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;            <span class="comment">//if(dt_mod_flag) {</span></div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;            <span class="comment">//    dt_manager.setStep(dt_tree/dt_reduce_factor);</span></div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;            <span class="comment">//    if (input_parameters.print_flag) {</span></div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;            <span class="comment">//        std::cout&lt;&lt;&quot;Tree time step change, time = &quot;&lt;&lt;stat.time</span></div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;            <span class="comment">//                 &lt;&lt;&quot;  dt_soft = &quot;&lt;&lt;dt_tree</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;            <span class="comment">//                 &lt;&lt;&quot;  reduce factor = &quot;&lt;&lt;dt_reduce_factor</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;            <span class="comment">//                 &lt;&lt;std::endl;</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;            <span class="comment">//    }</span></div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;            <span class="comment">//}</span></div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160; </div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;            <span class="comment">// interrupt</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;            <span class="keywordflow">if</span>(interrupt_flag) {</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;<span class="preprocessor">#ifdef CLUSTER_VELOCITY</span></div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;                setParticleGroupDataToCMData();</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;                <span class="comment">// correct force due to the change over update</span></div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;                correctForceChangeOverUpdate();</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160; </div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;                <span class="comment">// need remove artificial particles</span></div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;                system_soft.setNumberOfParticleLocal(stat.<a class="code" href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">n_real_loc</a>);</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160; </div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;                assert(checkTimeConsistence());</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160; </div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;                PS::Comm::barrier();</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;            }</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;            <span class="comment">// second kick if output exists or changeover is modified</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;            <span class="comment">//if(dt_mod_flag||output_flag||changeover_flag) {</span></div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;            <span class="keywordflow">if</span>(output_flag||changeover_flag) {</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160; </div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;                assert(checkTimeConsistence());</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;                <span class="comment">// determine the next tree time step</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;                <span class="comment">//PS::F64 dt_reduce_factor_org = 1.0;</span></div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;                <span class="comment">//dt_reduce_factor_org = PS::Comm::getMaxValue(dt_reduce_factor_org);</span></div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;                <span class="comment">//dt_reduce_factor = 1.0;</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;                <span class="comment">//while(dt_reduce_factor&lt;dt_reduce_factor_org) dt_reduce_factor *=2.0;</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160; </div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;                <span class="comment">//update new tree step if reduce factor is changed</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;                dt_kick = dt_manager.<a class="code" href="classKickDriftStep.html#a59127c2c2bf117e0687726ebcf43d6f0">getDtStartContinue</a>();</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160; </div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;                correctForceChangeOverUpdate();</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160; </div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;                kick(dt_kick);</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160; </div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;            }</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160; </div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160; </div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;            <span class="comment">// &gt;8. Hard integration </span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;            <span class="comment">// get drift step</span></div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;            dt_drift = dt_manager.<a class="code" href="classKickDriftStep.html#ac13b3a09c5626975c412cdf331316c92">getDtDriftContinue</a>();</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;            </div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;<span class="preprocessor">#ifdef STELLAR_EVOLUTION</span></div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;            hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction.time_interrupt_max = stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> + dt_drift;</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;<span class="preprocessor">#endif            </span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;            </div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;            drift(dt_drift);</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160; </div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;            <span class="comment">// update stat time </span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;            stat.<a class="code" href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">time</a> = system_hard_one_cluster.<a class="code" href="classSystemHard.html#aaa3225b5e3f3fdeef1626258addcae12">getTimeOrigin</a>();</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160; </div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;            <span class="comment">// calculate profile</span></div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;            profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">barrier</a>();</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;            PS::Comm::barrier();</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;            profile.<a class="code" href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">total</a>.<a class="code" href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">end</a>();</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160; </div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;            calcProfile();</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;            </div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;            <span class="comment">// when interrupt exist, quit the loop</span></div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;            <span class="keywordflow">if</span> (n_interrupt_glb&gt;0) {</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="preprocessor">#ifdef HARD_INTERRUPT_PRINT</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;                std::cerr&lt;&lt;<span class="stringliteral">&quot;Interrupt detected, number: &quot;</span>&lt;&lt;n_interrupt_glb&lt;&lt;std::endl;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;                <span class="keywordflow">return</span> n_interrupt_glb;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;            }</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160; </div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;        }</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160; </div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    }</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160; </div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;    <span class="keywordtype">void</span> clear() {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160; </div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;        <span class="keywordflow">if</span> (fstatus.is_open()) fstatus.close();</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;        <span class="keywordflow">if</span> (fesc.is_open()) fesc.close();</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="preprocessor">#ifdef PROFILE</span></div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;        <span class="keywordflow">if</span> (fprofile.is_open()) fprofile.close();</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160; </div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="preprocessor">#ifdef BSE_BASE</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        <span class="keyword">auto</span>&amp; interaction = hard_manager.<a class="code" href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">ar_manager</a>.interaction;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;        <span class="keywordflow">if</span> (interaction.fout_sse.is_open()) interaction.fout_sse.close();</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="keywordflow">if</span> (interaction.fout_bse.is_open()) interaction.fout_bse.close();</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;<span class="preprocessor">#ifdef ADJUST_GROUP_PRINT</span></div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;        <span class="keywordflow">if</span> (hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.fgroup.is_open()) hard_manager.<a class="code" href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">h4_manager</a>.fgroup.close();</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;        <span class="keywordflow">if</span> (pos_domain) {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;            <span class="keyword">delete</span>[] pos_domain;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;            pos_domain=NULL;</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        }</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160; </div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;        <span class="comment">//if (initial_fdps_flag) PS::Finalize();</span></div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;        remove_list.resizeNoInitialize(0);</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;        n_interrupt_glb = 0;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;        <span class="comment">//initial_fdps_flag = false;</span></div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;        read_parameters_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;        read_data_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;        initial_parameters_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;        initial_step_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;    }</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160; </div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    ~PeTar() { clear();}</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;};</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160; </div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;<span class="keywordtype">bool</span> PeTar::initial_fdps_flag = <span class="keyword">false</span>;</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassArtificialParticleManager_html_ac3c6685d320c92bc37b697d6cd791db0"><div class="ttname"><a href="classArtificialParticleManager.html#ac3c6685d320c92bc37b697d6cd791db0">ArtificialParticleManager::getCMParticles</a></div><div class="ttdeci">Tptcl * getCMParticles(Tptcl *_ptcl_list)</div><div class="ttdoc">get c.m. particle list address from a artificial particle array</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:404</div></div>
<div class="ttc" id="aclassSysCounts_html_a8f9e6d193f0a554e2accd2d68b8b5c65"><div class="ttname"><a href="classSysCounts.html#a8f9e6d193f0a554e2accd2d68b8b5c65">SysCounts::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> profile.hpp:533</div></div>
<div class="ttc" id="aclassSystemHard_html_a2d86414801edb526081bb7441b6a0da4"><div class="ttname"><a href="classSystemHard.html#a2d86414801edb526081bb7441b6a0da4">SystemHard::finishIntegrateInterruptClustersOMP</a></div><div class="ttdeci">PS::S32 finishIntegrateInterruptClustersOMP()</div><div class="ttdoc">Finish interrupt integration.</div><div class="ttdef"><b>Definition:</b> hard.hpp:2425</div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_a8eda14e2b591d14c43672977cc4e57b8"><div class="ttname"><a href="classEnergyAndMomemtum.html#a8eda14e2b591d14c43672977cc4e57b8">EnergyAndMomemtum::ekin</a></div><div class="ttdeci">PS::F64 ekin</div><div class="ttdef"><b>Definition:</b> energy.hpp:7</div></div>
<div class="ttc" id="astructStatus_1_1ParticleCM_html_a99d597e173bd2de26a14e081e271003b"><div class="ttname"><a href="structStatus_1_1ParticleCM.html#a99d597e173bd2de26a14e081e271003b">Status::ParticleCM::vel</a></div><div class="ttdeci">PS::F64vec vel</div><div class="ttdef"><b>Definition:</b> status.hpp:21</div></div>
<div class="ttc" id="aclassKickDriftStep_html_aa2ca643bb9ff0dd17a27968b0b3a3d16"><div class="ttname"><a href="classKickDriftStep.html#aa2ca643bb9ff0dd17a27968b0b3a3d16">KickDriftStep::getDtEndContinue</a></div><div class="ttdeci">PS::F64 getDtEndContinue()</div><div class="ttdoc">Get ending step size for continue case.</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:161</div></div>
<div class="ttc" id="aclassFileHeader_html_abf680d62b5f42ec965e1038ca3c7c01a"><div class="ttname"><a href="classFileHeader.html#abf680d62b5f42ec965e1038ca3c7c01a">FileHeader::n_body</a></div><div class="ttdeci">long long int n_body</div><div class="ttdef"><b>Definition:</b> io.hpp:213</div></div>
<div class="ttc" id="aclassStatus_html_ab914306bf82dce98487573a9d4bce1a9"><div class="ttname"><a href="classStatus.html#ab914306bf82dce98487573a9d4bce1a9">Status::pcm</a></div><div class="ttdeci">struct Status::ParticleCM pcm</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a313d21dd4ab5bce5cb9e12e117e34a53"><div class="ttname"><a href="classIOParamsPeTar.html#a313d21dd4ab5bce5cb9e12e117e34a53">IOParamsPeTar::dt_soft</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; dt_soft</div><div class="ttdef"><b>Definition:</b> petar.hpp:110</div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_af3f3f5838916c54dbcbe983098f26d09"><div class="ttname"><a href="classEnergyAndMomemtum.html#af3f3f5838916c54dbcbe983098f26d09">EnergyAndMomemtum::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> energy.hpp:36</div></div>
<div class="ttc" id="aclassFPSoft_html"><div class="ttname"><a href="classFPSoft.html">FPSoft</a></div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:26</div></div>
<div class="ttc" id="aclassSysProfile_html_a08359fc357df49d8df1ccd539b95e195"><div class="ttname"><a href="classSysProfile.html#a08359fc357df49d8df1ccd539b95e195">SysProfile::tree_nb</a></div><div class="ttdeci">Tprofile tree_nb</div><div class="ttdef"><b>Definition:</b> profile.hpp:320</div></div>
<div class="ttc" id="ahard_8hpp_html"><div class="ttname"><a href="hard_8hpp.html">hard.hpp</a></div></div>
<div class="ttc" id="aclassSystemHard_html_a014acbefdcaa7a3db1cf6d043b7b519c"><div class="ttname"><a href="classSystemHard.html#a014acbefdcaa7a3db1cf6d043b7b519c">SystemHard::correctForceWithCutoffClusterOMP</a></div><div class="ttdeci">void correctForceWithCutoffClusterOMP(Tsys &amp;_sys, const bool _acorr_flag=false)</div><div class="ttdoc">Soft force correction due to different cut-off function.</div><div class="ttdef"><b>Definition:</b> hard.hpp:3181</div></div>
<div class="ttc" id="aclassEscaper_html_a2b248b32607d13e2834d3123892e2e66"><div class="ttname"><a href="classEscaper.html#a2b248b32607d13e2834d3123892e2e66">Escaper::isEscaper</a></div><div class="ttdeci">bool isEscaper(Tptcl &amp;_p, Tpcm &amp;_pcm)</div><div class="ttdoc">check escaper based on distance and c.m. of the system</div><div class="ttdef"><b>Definition:</b> escaper.hpp:14</div></div>
<div class="ttc" id="aclassHardManager_html_ad5806725afa5d1d09fc312531a699701"><div class="ttname"><a href="classHardManager.html#ad5806725afa5d1d09fc312531a699701">HardManager::setEpsSq</a></div><div class="ttdeci">void setEpsSq(const PS::F64 _eps_sq)</div><div class="ttdoc">set softening</div><div class="ttdef"><b>Definition:</b> hard.hpp:41</div></div>
<div class="ttc" id="astructHardEnergy_html_a67a00aa59d17ef75f04bc02433377d84"><div class="ttname"><a href="structHardEnergy.html#a67a00aa59d17ef75f04bc02433377d84">HardEnergy::de_sd_change_binary_interrupt</a></div><div class="ttdeci">PS::F64 de_sd_change_binary_interrupt</div><div class="ttdef"><b>Definition:</b> hard.hpp:126</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ae7981689c035c1a951ee481ece60d011"><div class="ttname"><a href="classIOParamsPeTar.html#ae7981689c035c1a951ee481ece60d011">IOParamsPeTar::r_out</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; r_out</div><div class="ttdef"><b>Definition:</b> petar.hpp:126</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a6126c51ce250b208260fbe6ca073f1ac"><div class="ttname"><a href="classIOParamsPeTar.html#a6126c51ce250b208260fbe6ca073f1ac">IOParamsPeTar::checkParams</a></div><div class="ttdeci">bool checkParams()</div><div class="ttdoc">check paramters</div><div class="ttdef"><b>Definition:</b> petar.hpp:583</div></div>
<div class="ttc" id="aclassHardManager_html_a19cf9561596c28882f52dad82dea4998"><div class="ttname"><a href="classHardManager.html#a19cf9561596c28882f52dad82dea4998">HardManager::ap_manager</a></div><div class="ttdeci">ArtificialParticleManager ap_manager</div><div class="ttdef"><b>Definition:</b> hard.hpp:33</div></div>
<div class="ttc" id="aclassFDPSProfile_html_a9987ad38ffbeba5186859d395d50f009"><div class="ttname"><a href="classFDPSProfile.html#a9987ad38ffbeba5186859d395d50f009">FDPSProfile::dump</a></div><div class="ttdeci">void dump(std::ostream &amp;fout, const PS::S64 n_loop=1, const PS::S32 width=PROFILE_PRINT_WIDTH)</div><div class="ttdef"><b>Definition:</b> profile.hpp:293</div></div>
<div class="ttc" id="aclassSystemHard_html_a0aefe9e642d174f1d8ab04825a3bce3c"><div class="ttname"><a href="classSystemHard.html#a0aefe9e642d174f1d8ab04825a3bce3c">SystemHard::updateTimeWriteBack</a></div><div class="ttdeci">void updateTimeWriteBack()</div><div class="ttdef"><b>Definition:</b> hard.hpp:1969</div></div>
<div class="ttc" id="aformat__transfer_8cxx_html_a10a10c3512c1f179be30181fdd3bc8b1"><div class="ttname"><a href="format__transfer_8cxx.html#a10a10c3512c1f179be30181fdd3bc8b1">SystemSoft</a></div><div class="ttdeci">PS::ParticleSystem&lt; FPSoft &gt; SystemSoft</div><div class="ttdef"><b>Definition:</b> format_transfer.cxx:8</div></div>
<div class="ttc" id="aclassGalpyManager_html_a982ceeab737762887eec4a15035fc594"><div class="ttname"><a href="classGalpyManager.html#a982ceeab737762887eec4a15035fc594">GalpyManager::printReference</a></div><div class="ttdeci">static void printReference(std::ostream &amp;fout, const int offset=4)</div><div class="ttdoc">print reference to cite</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1486</div></div>
<div class="ttc" id="astructIOParams_html_a2fa82cf43f6b5395becdfc7ebed1839e"><div class="ttname"><a href="structIOParams.html#a2fa82cf43f6b5395becdfc7ebed1839e">IOParams::value</a></div><div class="ttdeci">Type value</div><div class="ttdef"><b>Definition:</b> io.hpp:43</div></div>
<div class="ttc" id="aclassSysProfile_html_a33719f58788aab42d20be6dd71a92c20"><div class="ttname"><a href="classSysProfile.html#a33719f58788aab42d20be6dd71a92c20">SysProfile::output</a></div><div class="ttdeci">Tprofile output</div><div class="ttdef"><b>Definition:</b> profile.hpp:328</div></div>
<div class="ttc" id="astructHardEnergy_html_aa0e750a49bdaed986677db718f671215"><div class="ttname"><a href="structHardEnergy.html#aa0e750a49bdaed986677db718f671215">HardEnergy::de_sd</a></div><div class="ttdeci">PS::F64 de_sd</div><div class="ttdef"><b>Definition:</b> hard.hpp:124</div></div>
<div class="ttc" id="aclassGalpyManager_html_a84d80784f5da870ff86d61bf29eb98d1"><div class="ttname"><a href="classGalpyManager.html#a84d80784f5da870ff86d61bf29eb98d1">GalpyManager::writePotentialPars</a></div><div class="ttdeci">void writePotentialPars(const std::string &amp;_filename, const double &amp;_system_time)</div><div class="ttdoc">write potential parameters for restart</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1474</div></div>
<div class="ttc" id="aclassBSEManager_html_af25ae410253f1e9118fefc98696e6ce3"><div class="ttname"><a href="classBSEManager.html#af25ae410253f1e9118fefc98696e6ce3">BSEManager::printReference</a></div><div class="ttdeci">static void printReference(std::ostream &amp;fout, const int offset=4)</div><div class="ttdoc">print reference to cite</div><div class="ttdef"><b>Definition:</b> bse_interface.h:1146</div></div>
<div class="ttc" id="aclassBSEManager_html_a52d9f47da0278671ab0aa05281801446"><div class="ttname"><a href="classBSEManager.html#a52d9f47da0278671ab0aa05281801446">BSEManager::getBSEOutputFilenameSuffix</a></div><div class="ttdeci">static std::string getBSEOutputFilenameSuffix()</div><div class="ttdef"><b>Definition:</b> bse_interface.h:1178</div></div>
<div class="ttc" id="akickdriftstep_8hpp_html"><div class="ttname"><a href="kickdriftstep_8hpp.html">kickdriftstep.hpp</a></div></div>
<div class="ttc" id="astructHardEnergy_html_a84c5a7638e18d922d9d666dcc7d1186e"><div class="ttname"><a href="structHardEnergy.html#a84c5a7638e18d922d9d666dcc7d1186e">HardEnergy::de</a></div><div class="ttdeci">PS::F64 de</div><div class="ttdef"><b>Definition:</b> hard.hpp:120</div></div>
<div class="ttc" id="aclassIOParamsBSE_html"><div class="ttname"><a href="classIOParamsBSE.html">IOParamsBSE</a></div><div class="ttdoc">IO parameters manager for BSE based code.</div><div class="ttdef"><b>Definition:</b> bse_interface.h:619</div></div>
<div class="ttc" id="aclassSysCounts_html_a82e5d98b06ad5f01bdca7f90a7dd59c2"><div class="ttname"><a href="classSysCounts.html#a82e5d98b06ad5f01bdca7f90a7dd59c2">SysCounts::getherClusterCount</a></div><div class="ttdeci">void getherClusterCount(int *n, int *count, const long unsigned int size)</div><div class="ttdef"><b>Definition:</b> profile.hpp:464</div></div>
<div class="ttc" id="aclassSysCounts_html_a9cf5f8b421b99e3442dc2d40c6221052"><div class="ttname"><a href="classSysCounts.html#a9cf5f8b421b99e3442dc2d40c6221052">SysCounts::addClusterCount</a></div><div class="ttdeci">void addClusterCount(SysCounts &amp;n_count)</div><div class="ttdef"><b>Definition:</b> profile.hpp:480</div></div>
<div class="ttc" id="anamespacePIKG_html_a9f581dea11be0ac2b9ad0ec87dc1dac3"><div class="ttname"><a href="namespacePIKG.html#a9f581dea11be0ac2b9ad0ec87dc1dac3">PIKG::S32</a></div><div class="ttdeci">int32_t S32</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:24</div></div>
<div class="ttc" id="adomain_8hpp_html"><div class="ttname"><a href="domain_8hpp.html">domain.hpp</a></div></div>
<div class="ttc" id="aclassStatus_html_a0e6b78a9428d64a9d46f08883e6f54f6"><div class="ttname"><a href="classStatus.html#a0e6b78a9428d64a9d46f08883e6f54f6">Status::n_escape_glb</a></div><div class="ttdeci">PS::S32 n_escape_glb</div><div class="ttdef"><b>Definition:</b> status.hpp:15</div></div>
<div class="ttc" id="aclassSysProfile_html_ae277e507e601a1c650631e8521891ee4"><div class="ttname"><a href="classSysProfile.html#ae277e507e601a1c650631e8521891ee4">SysProfile::search_cluster</a></div><div class="ttdeci">Tprofile search_cluster</div><div class="ttdef"><b>Definition:</b> profile.hpp:324</div></div>
<div class="ttc" id="aclassSysCounts_html_a531348a4cbf7ec59b68bf58e521b1bef"><div class="ttname"><a href="classSysCounts.html#a531348a4cbf7ec59b68bf58e521b1bef">SysCounts::cluster_isolated</a></div><div class="ttdeci">NumCounter cluster_isolated</div><div class="ttdef"><b>Definition:</b> profile.hpp:424</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a0a8b537849950e26f9c2722c50ef93b9"><div class="ttname"><a href="classIOParamsPeTar.html#a0a8b537849950e26f9c2722c50ef93b9">IOParamsPeTar::n_leaf_limit</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_leaf_limit</div><div class="ttdef"><b>Definition:</b> petar.hpp:95</div></div>
<div class="ttc" id="aclassSearchCluster_html_ae89195308010bf7c79d95e672ed4e793"><div class="ttname"><a href="classSearchCluster.html#ae89195308010bf7c79d95e672ed4e793">SearchCluster::n_ptcl_in_multi_cluster_isolated_</a></div><div class="ttdeci">PS::ReallocatableArray&lt; PS::S32 &gt; n_ptcl_in_multi_cluster_isolated_</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:178</div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_a1aed44f1fd6443ded7eb940b696c0beb"><div class="ttname"><a href="classEnergyAndMomemtum.html#a1aed44f1fd6443ded7eb940b696c0beb">EnergyAndMomemtum::saveEnergyError</a></div><div class="ttdeci">void saveEnergyError()</div><div class="ttdoc">save current energy error</div><div class="ttdef"><b>Definition:</b> energy.hpp:301</div></div>
<div class="ttc" id="aclassParticleDistributionGenerator_html_a07e0c5fd52b542a040c885cf5f4aec7a"><div class="ttname"><a href="classParticleDistributionGenerator.html#a07e0c5fd52b542a040c885cf5f4aec7a">ParticleDistributionGenerator::makePlummerModel</a></div><div class="ttdeci">static void makePlummerModel(const double mass_glb, const long long int n_glb, const long long int n_loc, double *&amp;mass, PS::F64vec *&amp;pos, PS::F64vec *&amp;vel, const double eng=-0.25, const int seed=0)</div><div class="ttdef"><b>Definition:</b> particle_distribution_generator.hpp:173</div></div>
<div class="ttc" id="asoft__ptcl_8hpp_html"><div class="ttname"><a href="soft__ptcl_8hpp.html">soft_ptcl.hpp</a></div></div>
<div class="ttc" id="aclassSysCounts_html_ad03923dd131a830d4bc1124947b77589"><div class="ttname"><a href="classSysCounts.html#ad03923dd131a830d4bc1124947b77589">SysCounts::clusterCount</a></div><div class="ttdeci">void clusterCount(const PS::S32 n, const PS::S32 ntimes=1)</div><div class="ttdef"><b>Definition:</b> profile.hpp:455</div></div>
<div class="ttc" id="aclassPtcl_html_a5c94025b3778a5a349e80d72e618018d"><div class="ttname"><a href="classPtcl.html#a5c94025b3778a5a349e80d72e618018d">Ptcl::group_data_mode</a></div><div class="ttdeci">static GroupDataMode group_data_mode</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:47</div></div>
<div class="ttc" id="aclassPtcl_html_a71024cba537fba6124b23fa39b0b7dbf"><div class="ttname"><a href="classPtcl.html#a71024cba537fba6124b23fa39b0b7dbf">Ptcl::mean_mass_inv</a></div><div class="ttdeci">static PS::F64 mean_mass_inv</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:45</div></div>
<div class="ttc" id="aclassSysCounts_html_a5954fd75177dbbf517c6fae9409a67b9"><div class="ttname"><a href="classSysCounts.html#a5954fd75177dbbf517c6fae9409a67b9">SysCounts::hard_connected</a></div><div class="ttdeci">NumCounter hard_connected</div><div class="ttdef"><b>Definition:</b> profile.hpp:422</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ae8044a331b1960ee328a8d4c82107b06"><div class="ttname"><a href="classIOParamsPeTar.html#ae8044a331b1960ee328a8d4c82107b06">IOParamsPeTar::r_bin</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; r_bin</div><div class="ttdef"><b>Definition:</b> petar.hpp:127</div></div>
<div class="ttc" id="aclassFileHeader_html_a3b50f979bd6770010875255529015591"><div class="ttname"><a href="classFileHeader.html#a3b50f979bd6770010875255529015591">FileHeader::time</a></div><div class="ttdeci">double time</div><div class="ttdef"><b>Definition:</b> io.hpp:214</div></div>
<div class="ttc" id="aclassGalpyManager_html_a2b9c41229c1b4a6d5c06e18017298357"><div class="ttname"><a href="classGalpyManager.html#a2b9c41229c1b4a6d5c06e18017298357">GalpyManager::updatePotential</a></div><div class="ttdeci">void updatePotential(const double &amp;_system_time, const bool _print_flag)</div><div class="ttdoc">Update Potential types and arguments based on time.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1443</div></div>
<div class="ttc" id="anamespacePIKG_html_a5c5a56be541ab462edc062a5901d9dfe"><div class="ttname"><a href="namespacePIKG.html#a5c5a56be541ab462edc062a5901d9dfe">PIKG::F64vec</a></div><div class="ttdeci">Vector3&lt; F64 &gt; F64vec</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:167</div></div>
<div class="ttc" id="aclassSearchCluster_html_ab4db2590e66759a8cce93e2acd2892fd"><div class="ttname"><a href="classSearchCluster.html#ab4db2590e66759a8cce93e2acd2892fd">SearchCluster::mediator_sorted_id_cluster_</a></div><div class="ttdeci">PS::ReallocatableArray&lt; Mediator &gt; mediator_sorted_id_cluster_</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:180</div></div>
<div class="ttc" id="aclassIOParamsContainer_html_a972926da32b4043d06456ab6d35d7752"><div class="ttname"><a href="classIOParamsContainer.html#a972926da32b4043d06456ab6d35d7752">IOParamsContainer::readAscii</a></div><div class="ttdeci">void readAscii(FILE *_fin)</div><div class="ttdef"><b>Definition:</b> io.hpp:112</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_accccd85595390fa0c1b3a8e80325efd3"><div class="ttname"><a href="classIOParamsBSE.html#accccd85595390fa0c1b3a8e80325efd3">IOParamsBSE::input_par_store</a></div><div class="ttdeci">IOParamsContainer input_par_store</div><div class="ttdef"><b>Definition:</b> bse_interface.h:621</div></div>
<div class="ttc" id="aclassKickDriftStep_html"><div class="ttname"><a href="classKickDriftStep.html">KickDriftStep</a></div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:1</div></div>
<div class="ttc" id="aclassSystemHard_html_a9acc9ace45305aba14aedcaf2c8dcf7c"><div class="ttname"><a href="classSystemHard.html#a9acc9ace45305aba14aedcaf2c8dcf7c">SystemHard::getNClusterChangeOverUpdate</a></div><div class="ttdeci">PS::S32 getNClusterChangeOverUpdate() const</div><div class="ttdef"><b>Definition:</b> hard.hpp:1961</div></div>
<div class="ttc" id="astructCalcForceEpSpQuadNoSimd_html"><div class="ttname"><a href="structCalcForceEpSpQuadNoSimd.html">CalcForceEpSpQuadNoSimd</a></div><div class="ttdef"><b>Definition:</b> soft_force.hpp:160</div></div>
<div class="ttc" id="aclassHardManager_html_a1081bf754ceeb9a61acbd96a3250e682"><div class="ttname"><a href="classHardManager.html#a1081bf754ceeb9a61acbd96a3250e682">HardManager::r_out_base</a></div><div class="ttdeci">PS::F64 r_out_base</div><div class="ttdef"><b>Definition:</b> hard.hpp:31</div></div>
<div class="ttc" id="aclassSystemHard_html_ad981cab6e696a124b003289878094386"><div class="ttname"><a href="classSystemHard.html#ad981cab6e696a124b003289878094386">SystemHard::getNumberOfInterruptClusters</a></div><div class="ttdeci">PS::S32 getNumberOfInterruptClusters() const</div><div class="ttdef"><b>Definition:</b> hard.hpp:1933</div></div>
<div class="ttc" id="aclassIOParamsContainer_html_a8bdebaa655392813c07b0dd4ae6469c2"><div class="ttname"><a href="classIOParamsContainer.html#a8bdebaa655392813c07b0dd4ae6469c2">IOParamsContainer::printHelp</a></div><div class="ttdeci">void printHelp(std::ostream &amp;os, const int _offset_short_key=2, const int _offset_long_key=1, const int _width_key=23) const</div><div class="ttdef"><b>Definition:</b> io.hpp:198</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ad9040627d84b5c2301f53660dcf343ed"><div class="ttname"><a href="classIOParamsPeTar.html#ad9040627d84b5c2301f53660dcf343ed">IOParamsPeTar::unit_set</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; unit_set</div><div class="ttdef"><b>Definition:</b> petar.hpp:107</div></div>
<div class="ttc" id="anamespacegalpy__pot__movie_html_af6d8a3f703079e7b353b7af8c136e946"><div class="ttname"><a href="namespacegalpy__pot__movie.html#af6d8a3f703079e7b353b7af8c136e946">galpy_pot_movie.dt</a></div><div class="ttdeci">dt</div><div class="ttdef"><b>Definition:</b> galpy_pot_movie.py:134</div></div>
<div class="ttc" id="aptcl_8hpp_html_ad4140470df0d058ffde0786386a5589da820eb5b696ea2a657c0db1e258dc7d81"><div class="ttname"><a href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da820eb5b696ea2a657c0db1e258dc7d81">GroupDataMode::cm</a></div><div class="ttdeci">@ cm</div></div>
<div class="ttc" id="aclassHardManager_html_a24a9393ae64ca5e77e8c71ec7d31fbd7"><div class="ttname"><a href="classHardManager.html#a24a9393ae64ca5e77e8c71ec7d31fbd7">HardManager::energy_error_max</a></div><div class="ttdeci">PS::F64 energy_error_max</div><div class="ttdef"><b>Definition:</b> hard.hpp:28</div></div>
<div class="ttc" id="astructTprofile_html_a2345fef9ec21dcb3b3ee72ad36348559"><div class="ttname"><a href="structTprofile.html#a2345fef9ec21dcb3b3ee72ad36348559">Tprofile::end</a></div><div class="ttdeci">void end()</div><div class="ttdef"><b>Definition:</b> profile.hpp:191</div></div>
<div class="ttc" id="aclassSysCounts_html_aacf09fcd49268cae7a3c264e9e0ddf14"><div class="ttname"><a href="classSysCounts.html#aacf09fcd49268cae7a3c264e9e0ddf14">SysCounts::ARC_n_groups_iso</a></div><div class="ttdeci">NumCounter ARC_n_groups_iso</div><div class="ttdef"><b>Definition:</b> profile.hpp:429</div></div>
<div class="ttc" id="aclassSysCounts_html_a9b18829f0e2260f853f82d4353a26140"><div class="ttname"><a href="classSysCounts.html#a9b18829f0e2260f853f82d4353a26140">SysCounts::ep_sp_interact</a></div><div class="ttdeci">NumCounter ep_sp_interact</div><div class="ttdef"><b>Definition:</b> profile.hpp:433</div></div>
<div class="ttc" id="aclassGalpyManager_html_ac6ce59845e4b863a3fce47c18e09631a"><div class="ttname"><a href="classGalpyManager.html#ac6ce59845e4b863a3fce47c18e09631a">GalpyManager::initial</a></div><div class="ttdeci">void initial(const IOParamsGalpy &amp;_input, const double _time, const std::string _conf_name, const bool _restart_flag, const bool _print_flag=false)</div><div class="ttdoc">initialization function</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:852</div></div>
<div class="ttc" id="astructTprofile_html_aa4331b775dd43b6ca51644f94bd3e218"><div class="ttname"><a href="structTprofile.html#aa4331b775dd43b6ca51644f94bd3e218">Tprofile::barrier</a></div><div class="ttdeci">void barrier()</div><div class="ttdef"><b>Definition:</b> profile.hpp:187</div></div>
<div class="ttc" id="aclassSysProfile_html_a7ba7d3a659225a47527f2af0be9ca068"><div class="ttname"><a href="classSysProfile.html#a7ba7d3a659225a47527f2af0be9ca068">SysProfile::dumpBarrier</a></div><div class="ttdeci">void dumpBarrier(std::ostream &amp;fout, const PS::S64 n_loop=1, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:375</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a98329e8b6b58ae6f2641abeacd33fd63"><div class="ttname"><a href="classIOParamsPeTar.html#a98329e8b6b58ae6f2641abeacd33fd63">IOParamsPeTar::theta</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; theta</div><div class="ttdef"><b>Definition:</b> petar.hpp:94</div></div>
<div class="ttc" id="aclassHardManager_html"><div class="ttname"><a href="classHardManager.html">HardManager</a></div><div class="ttdoc">Hard integrator parameter manager.</div><div class="ttdef"><b>Definition:</b> hard.hpp:26</div></div>
<div class="ttc" id="astructCalcForceEpEpWithLinearCutoffNoSimd_html"><div class="ttname"><a href="structCalcForceEpEpWithLinearCutoffNoSimd.html">CalcForceEpEpWithLinearCutoffNoSimd</a></div><div class="ttdoc">FORCE FUNCTOR.</div><div class="ttdef"><b>Definition:</b> soft_force.hpp:38</div></div>
<div class="ttc" id="aclassSearchCluster_html_a80b0896173dc501cd2457c1636289206"><div class="ttname"><a href="classSearchCluster.html#a80b0896173dc501cd2457c1636289206">SearchCluster::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:333</div></div>
<div class="ttc" id="aforce__gpu__cuda_8hpp_html_aedbe85337286f7c675e64a36cb78d099"><div class="ttname"><a href="force__gpu__cuda_8hpp.html#aedbe85337286f7c675e64a36cb78d099">RetrieveForceCUDA</a></div><div class="ttdeci">PS::S32 RetrieveForceCUDA(const PS::S32 tag, const PS::S32 n_walk, const PS::S32 *ni, ForceSoft **force)</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ab4c8908923243dd20dc9de37dbb5500d"><div class="ttname"><a href="classIOParamsPeTar.html#ab4c8908923243dd20dc9de37dbb5500d">IOParamsPeTar::r_search_min</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; r_search_min</div><div class="ttdef"><b>Definition:</b> petar.hpp:129</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a9fae21b4ddfc97e9fe70e2e18a49fce1"><div class="ttname"><a href="classIOParamsPeTar.html#a9fae21b4ddfc97e9fe70e2e18a49fce1">IOParamsPeTar::n_step_per_orbit</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_step_per_orbit</div><div class="ttdef"><b>Definition:</b> petar.hpp:103</div></div>
<div class="ttc" id="aclassFPSoft_html_a68e7765addbb0746733c24c373c15075"><div class="ttname"><a href="classFPSoft.html#a68e7765addbb0746733c24c373c15075">FPSoft::pot_tot</a></div><div class="ttdeci">PS::F64 pot_tot</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:32</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_a74d7120d680227042b2eed49f8b3476a"><div class="ttname"><a href="classIOParamsBSE.html#a74d7120d680227042b2eed49f8b3476a">IOParamsBSE::vscale</a></div><div class="ttdeci">IOParams&lt; double &gt; vscale</div><div class="ttdef"><b>Definition:</b> bse_interface.h:663</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a2d3302ea2190553e73fe1094e71d87ea"><div class="ttname"><a href="classKickDriftStep.html#a2d3302ea2190553e73fe1094e71d87ea">KickDriftStep::getStep</a></div><div class="ttdeci">PS::F64 getStep() const</div><div class="ttdoc">get base step size</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:107</div></div>
<div class="ttc" id="anamespacePIKG_html_a46994fde865611ddaf1334e0a6694ed0"><div class="ttname"><a href="namespacePIKG.html#a46994fde865611ddaf1334e0a6694ed0">PIKG::F64</a></div><div class="ttdeci">double F64</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:17</div></div>
<div class="ttc" id="aclassSysProfile_html"><div class="ttname"><a href="classSysProfile.html">SysProfile</a></div><div class="ttdef"><b>Definition:</b> profile.hpp:313</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a71fa11e45670eea1c686c530490a7798"><div class="ttname"><a href="classIOParamsPeTar.html#a71fa11e45670eea1c686c530490a7798">IOParamsPeTar::dt_min_hermite_index</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; dt_min_hermite_index</div><div class="ttdef"><b>Definition:</b> petar.hpp:116</div></div>
<div class="ttc" id="aclassGalpyManager_html_ab6b486c9d6318238f363a6656ffc7824"><div class="ttname"><a href="classGalpyManager.html#ab6b486c9d6318238f363a6656ffc7824">GalpyManager::calcAccPot</a></div><div class="ttdeci">void calcAccPot(double *acc, double &amp;pot, const double _time, const double gm, const double *pos_g, const double *pos_l)</div><div class="ttdoc">calculate acceleration and potential at give position</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1603</div></div>
<div class="ttc" id="astructHardEnergy_html_ad179469610bd9c46eee79e3efd90c66c"><div class="ttname"><a href="structHardEnergy.html#ad179469610bd9c46eee79e3efd90c66c">HardEnergy::de_change_cum</a></div><div class="ttdeci">PS::F64 de_change_cum</div><div class="ttdef"><b>Definition:</b> hard.hpp:121</div></div>
<div class="ttc" id="aget__version_8hpp_html"><div class="ttname"><a href="get__version_8hpp.html">get_version.hpp</a></div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a7466fadc59b145f79299db9a77b8e632"><div class="ttname"><a href="classIOParamsGalpy.html#a7466fadc59b145f79299db9a77b8e632">IOParamsGalpy::print_flag</a></div><div class="ttdeci">bool print_flag</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:28</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html"><div class="ttname"><a href="classIOParamsPeTar.html">IOParamsPeTar</a></div><div class="ttdoc">IO parameters for Petar.</div><div class="ttdef"><b>Definition:</b> petar.hpp:89</div></div>
<div class="ttc" id="astructIOParams_html_a14f008160ee20f31bee6973eb7d5416d"><div class="ttname"><a href="structIOParams.html#a14f008160ee20f31bee6973eb7d5416d">IOParams::print</a></div><div class="ttdeci">void print(std::ostream &amp;os) const</div><div class="ttdef"><b>Definition:</b> io.hpp:54</div></div>
<div class="ttc" id="aclassHardManager_html_ac977049b8e7365fb5899bc0a642d32d5"><div class="ttname"><a href="classHardManager.html#ac977049b8e7365fb5899bc0a642d32d5">HardManager::h4_manager</a></div><div class="ttdeci">H4::HermiteManager&lt; HermiteInteraction &gt; h4_manager</div><div class="ttdef"><b>Definition:</b> hard.hpp:34</div></div>
<div class="ttc" id="aclassSysProfile_html_a29d995275d99572ecff682569a15c77c"><div class="ttname"><a href="classSysProfile.html#a29d995275d99572ecff682569a15c77c">SysProfile::getMin</a></div><div class="ttdeci">SysProfile getMin()</div><div class="ttdef"><b>Definition:</b> profile.hpp:399</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a6ee1912c7448cb38242a4c0bd06fefb3"><div class="ttname"><a href="classIOParamsPeTar.html#a6ee1912c7448cb38242a4c0bd06fefb3">IOParamsPeTar::IOParamsPeTar</a></div><div class="ttdeci">IOParamsPeTar()</div><div class="ttdef"><b>Definition:</b> petar.hpp:151</div></div>
<div class="ttc" id="aclassKickDriftStep_html_af9cec4bb5599c16ca82eb4b11eb4e773"><div class="ttname"><a href="classKickDriftStep.html#af9cec4bb5599c16ca82eb4b11eb4e773">KickDriftStep::setStep</a></div><div class="ttdeci">void setStep(const PS::F64 _ds)</div><div class="ttdoc">set base step size</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:76</div></div>
<div class="ttc" id="aparticle__distribution__generator_8hpp_html"><div class="ttname"><a href="particle__distribution__generator_8hpp.html">particle_distribution_generator.hpp</a></div></div>
<div class="ttc" id="aclassGalpyManager_html_acce39be5c07a685b73a888b4298fd0da"><div class="ttname"><a href="classGalpyManager.html#acce39be5c07a685b73a888b4298fd0da">GalpyManager::kickMovePot</a></div><div class="ttdeci">void kickMovePot(const double dt)</div><div class="ttdoc">kick velocity of moving potential (mode 2)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1503</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a834f0ee9d024b5f66267627465664b3c"><div class="ttname"><a href="classIOParamsPeTar.html#a834f0ee9d024b5f66267627465664b3c">IOParamsPeTar::data_format</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; data_format</div><div class="ttdef"><b>Definition:</b> petar.hpp:132</div></div>
<div class="ttc" id="aclassSysProfile_html_a83d7ad10647318e23eb11e1a338715d7"><div class="ttname"><a href="classSysProfile.html#a83d7ad10647318e23eb11e1a338715d7">SysProfile::hard_isolated</a></div><div class="ttdeci">Tprofile hard_isolated</div><div class="ttdef"><b>Definition:</b> profile.hpp:317</div></div>
<div class="ttc" id="aclassBSEManager_html_a569c067ad29e6fd5f665c7fd83e3386d"><div class="ttname"><a href="classBSEManager.html#a569c067ad29e6fd5f665c7fd83e3386d">BSEManager::getBSEName</a></div><div class="ttdeci">static std::string getBSEName()</div><div class="ttdef"><b>Definition:</b> bse_interface.h:1198</div></div>
<div class="ttc" id="aclassSystemHard_html_ad15b5a9f60e73df248ce6e68512e791d"><div class="ttname"><a href="classSystemHard.html#ad15b5a9f60e73df248ce6e68512e791d">SystemHard::correctPotWithCutoffOMP</a></div><div class="ttdeci">void correctPotWithCutoffOMP(Tsys &amp;_sys, const PS::ReallocatableArray&lt; PS::S32 &gt; &amp;_ptcl_list)</div><div class="ttdoc">potential correction for single cluster</div><div class="ttdef"><b>Definition:</b> hard.hpp:3102</div></div>
<div class="ttc" id="aforce__gpu__cuda_8hpp_html"><div class="ttname"><a href="force__gpu__cuda_8hpp.html">force_gpu_cuda.hpp</a></div></div>
<div class="ttc" id="aptcl_8hpp_html_ad4140470df0d058ffde0786386a5589da13fd1a10d5921e99bd06b81590017ed6"><div class="ttname"><a href="ptcl_8hpp.html#ad4140470df0d058ffde0786386a5589da13fd1a10d5921e99bd06b81590017ed6">GroupDataMode::artificial</a></div><div class="ttdeci">@ artificial</div></div>
<div class="ttc" id="aclassGalpyManager_html"><div class="ttname"><a href="classGalpyManager.html">GalpyManager</a></div><div class="ttdoc">A class to manager the API to Galpy.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:658</div></div>
<div class="ttc" id="aclassStatus_html_a893a87b3a2602c3afa0821abda1dcd72"><div class="ttname"><a href="classStatus.html#a893a87b3a2602c3afa0821abda1dcd72">Status::time</a></div><div class="ttdeci">PS::F64 time</div><div class="ttdef"><b>Definition:</b> status.hpp:9</div></div>
<div class="ttc" id="aclassSysProfile_html_ab2ac884dc80339cc010d33a9b279a68f"><div class="ttname"><a href="classSysProfile.html#ab2ac884dc80339cc010d33a9b279a68f">SysProfile::force_correct</a></div><div class="ttdeci">Tprofile force_correct</div><div class="ttdef"><b>Definition:</b> profile.hpp:322</div></div>
<div class="ttc" id="astructSearchNeighborEpEpNoSimd_html"><div class="ttname"><a href="structSearchNeighborEpEpNoSimd.html">SearchNeighborEpEpNoSimd</a></div><div class="ttdef"><b>Definition:</b> soft_force.hpp:11</div></div>
<div class="ttc" id="aclassStatus_html"><div class="ttname"><a href="classStatus.html">Status</a></div><div class="ttdoc">class for measure the status of the system</div><div class="ttdef"><b>Definition:</b> status.hpp:7</div></div>
<div class="ttc" id="aclassSysProfile_html_a83fada2e7b3ab2ea14ef267d0c026b92"><div class="ttname"><a href="classSysProfile.html#a83fada2e7b3ab2ea14ef267d0c026b92">SysProfile::dump</a></div><div class="ttdeci">void dump(std::ostream &amp;fout, const PS::S64 n_loop=1, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:361</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a3d412367d4f0784d94f876890aed9859"><div class="ttname"><a href="classIOParamsPeTar.html#a3d412367d4f0784d94f876890aed9859">IOParamsPeTar::append_switcher</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; append_switcher</div><div class="ttdef"><b>Definition:</b> petar.hpp:141</div></div>
<div class="ttc" id="aclassSysProfile_html_abaa07e7fbb6826f0bda3fab1dcb09fa3"><div class="ttname"><a href="classSysProfile.html#abaa07e7fbb6826f0bda3fab1dcb09fa3">SysProfile::tree_soft</a></div><div class="ttdeci">Tprofile tree_soft</div><div class="ttdef"><b>Definition:</b> profile.hpp:321</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_afd0dfcfcdab7d35e492d8a76314b45cb"><div class="ttname"><a href="classIOParamsGalpy.html#afd0dfcfcdab7d35e492d8a76314b45cb">IOParamsGalpy::input_par_store</a></div><div class="ttdeci">IOParamsContainer input_par_store</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:17</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a6a0d5294c1a8b179b73282c56a0ede0c"><div class="ttname"><a href="classKickDriftStep.html#a6a0d5294c1a8b179b73282c56a0ede0c">KickDriftStep::isNextStart</a></div><div class="ttdeci">bool isNextStart() const</div><div class="ttdoc">get whether next is start</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:172</div></div>
<div class="ttc" id="anamespacePIKG_html_ac0a6edfa4881b63ce80ce9a92b899265"><div class="ttname"><a href="namespacePIKG.html#ac0a6edfa4881b63ce80ce9a92b899265">PIKG::S64</a></div><div class="ttdeci">int64_t S64</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:23</div></div>
<div class="ttc" id="aclassSysCounts_html_ab1502b63dd0b38cfe55826932eb410b2"><div class="ttname"><a href="classSysCounts.html#ab1502b63dd0b38cfe55826932eb410b2">SysCounts::ep_ep_interact</a></div><div class="ttdeci">NumCounter ep_ep_interact</div><div class="ttdef"><b>Definition:</b> profile.hpp:432</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a41d3e9e230a42bf0ddc5c419d7b70aaa"><div class="ttname"><a href="classKickDriftStep.html#a41d3e9e230a42bf0ddc5c419d7b70aaa">KickDriftStep::isNextEndPossible</a></div><div class="ttdeci">bool isNextEndPossible() const</div><div class="ttdoc">get whether next can be end</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:177</div></div>
<div class="ttc" id="aclassSystemHard_html_abd543bc60e7a4e5e19a73c1e5fa8c612"><div class="ttname"><a href="classSystemHard.html#abd543bc60e7a4e5e19a73c1e5fa8c612">SystemHard::setTimeOrigin</a></div><div class="ttdeci">void setTimeOrigin(const PS::F64 _time_origin)</div><div class="ttdef"><b>Definition:</b> hard.hpp:1965</div></div>
<div class="ttc" id="aclassSysCounts_html_a4d5972bb104e6700b8b7a536fd26dbfc"><div class="ttname"><a href="classSysCounts.html#a4d5972bb104e6700b8b7a536fd26dbfc">SysCounts::hard_interrupt</a></div><div class="ttdeci">NumCounter hard_interrupt</div><div class="ttdef"><b>Definition:</b> profile.hpp:423</div></div>
<div class="ttc" id="aclassSysProfile_html_ae6945bf42298b0c257b745921f4dcd4b"><div class="ttname"><a href="classSysProfile.html#ae6945bf42298b0c257b745921f4dcd4b">SysProfile::kick</a></div><div class="ttdeci">Tprofile kick</div><div class="ttdef"><b>Definition:</b> profile.hpp:323</div></div>
<div class="ttc" id="aclassEPISoft_html_ad680f261dc954c1771bd1446d3289e4b"><div class="ttname"><a href="classEPISoft.html#ad680f261dc954c1771bd1446d3289e4b">EPISoft::r_out</a></div><div class="ttdeci">static PS::F64 r_out</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:282</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a71cb527f3d9541292303fc23a6d2c07a"><div class="ttname"><a href="classIOParamsPeTar.html#a71cb527f3d9541292303fc23a6d2c07a">IOParamsPeTar::r_escape</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; r_escape</div><div class="ttdef"><b>Definition:</b> petar.hpp:130</div></div>
<div class="ttc" id="aclassArtificialParticleManager_html_a1807b5880300cd2a40e74b5c570d71a2"><div class="ttname"><a href="classArtificialParticleManager.html#a1807b5880300cd2a40e74b5c570d71a2">ArtificialParticleManager::r_tidal_tensor</a></div><div class="ttdeci">PS::F64 r_tidal_tensor</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:235</div></div>
<div class="ttc" id="astructIOParams_html_a8bcd5a17ce843559b07a968a70c482dc"><div class="ttname"><a href="structIOParams.html#a8bcd5a17ce843559b07a968a70c482dc">IOParams::key</a></div><div class="ttdeci">const char * key</div><div class="ttdef"><b>Definition:</b> io.hpp:44</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a55ba98a709e93dc1a4f70eec6e4314e7"><div class="ttname"><a href="classIOParamsPeTar.html#a55ba98a709e93dc1a4f70eec6e4314e7">IOParamsPeTar::time_end</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; time_end</div><div class="ttdef"><b>Definition:</b> petar.hpp:104</div></div>
<div class="ttc" id="aclassFPSoft_html_a234b9ee456887b70ff9f31c7cc960b50"><div class="ttname"><a href="classFPSoft.html#a234b9ee456887b70ff9f31c7cc960b50">FPSoft::acc</a></div><div class="ttdeci">PS::F64vec acc</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:28</div></div>
<div class="ttc" id="aio_8hpp_html"><div class="ttname"><a href="io_8hpp.html">io.hpp</a></div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_aa7482f0c09a63bac6004839410243650"><div class="ttname"><a href="classIOParamsPeTar.html#aa7482f0c09a63bac6004839410243650">IOParamsPeTar::write_style</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; write_style</div><div class="ttdef"><b>Definition:</b> petar.hpp:133</div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_aeabb3c5236a13b3db49cb64a9148dbf7"><div class="ttname"><a href="classEnergyAndMomemtum.html#aeabb3c5236a13b3db49cb64a9148dbf7">EnergyAndMomemtum::calc</a></div><div class="ttdeci">void calc(const Tptcl *_particles, const PS::S32 _n_particle, const bool _init_flag=false, const PS::F64vec *_pos_offset=NULL, const PS::F64vec *_vel_offset=NULL)</div><div class="ttdoc">calculate the system kinetic and potential energy of particles</div><div class="ttdef"><b>Definition:</b> energy.hpp:203</div></div>
<div class="ttc" id="aclassPtcl_html_ac748724105c87e84400c053085291e6b"><div class="ttname"><a href="classPtcl.html#ac748724105c87e84400c053085291e6b">Ptcl::r_search_min</a></div><div class="ttdeci">static PS::F64 r_search_min</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:43</div></div>
<div class="ttc" id="aclassParticleDistributionGenerator_html_ad955d89d061b82c3f1b0d0d956b8185e"><div class="ttname"><a href="classParticleDistributionGenerator.html#ad955d89d061b82c3f1b0d0d956b8185e">ParticleDistributionGenerator::makeKeplerDisk</a></div><div class="ttdeci">static void makeKeplerDisk(PS::F64 &amp;mass_planet_glb, PS::F64 *&amp;mass, PS::F64vec *&amp;pos, PS::F64vec *&amp;vel, const long long int n_glb, const long long int n_loc, const double a_in, const double a_out, const double e_rms, const double i_rms, const double dens=10.0, const double mass_sun=1.0, const double a_ice=0.0, const double f_ice=1.0, const double power=-1.5, const int seed=0, const double gravitational_constant=1.0)</div><div class="ttdef"><b>Definition:</b> particle_distribution_generator.hpp:111</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a31da641094322c1d3e95a220450a02da"><div class="ttname"><a href="classKickDriftStep.html#a31da641094322c1d3e95a220450a02da">KickDriftStep::setKDKMode</a></div><div class="ttdeci">void setKDKMode()</div><div class="ttdoc">set DKD mode (default is KDK)</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:66</div></div>
<div class="ttc" id="aclassSysProfile_html_accc33183497b0a98e27d155f974d4d7e"><div class="ttname"><a href="classSysProfile.html#accc33183497b0a98e27d155f974d4d7e">SysProfile::total</a></div><div class="ttdeci">Tprofile total</div><div class="ttdef"><b>Definition:</b> profile.hpp:315</div></div>
<div class="ttc" id="aprofile_8hpp_html"><div class="ttname"><a href="profile_8hpp.html">profile.hpp</a></div></div>
<div class="ttc" id="aclassSysProfile_html_a35d2315ca023213014a7c9878deea268"><div class="ttname"><a href="classSysProfile.html#a35d2315ca023213014a7c9878deea268">SysProfile::domain</a></div><div class="ttdeci">Tprofile domain</div><div class="ttdef"><b>Definition:</b> profile.hpp:326</div></div>
<div class="ttc" id="aclassStatus_html_aa57f2f0496be3ea54c28dd16b41f20cd"><div class="ttname"><a href="classStatus.html#aa57f2f0496be3ea54c28dd16b41f20cd">Status::n_remove_glb</a></div><div class="ttdeci">PS::S32 n_remove_glb</div><div class="ttdef"><b>Definition:</b> status.hpp:14</div></div>
<div class="ttc" id="aclassGalpyManager_html_a8aebb589a95e4f322c638ee740fbb9f3"><div class="ttname"><a href="classGalpyManager.html#a8aebb589a95e4f322c638ee740fbb9f3">GalpyManager::printData</a></div><div class="ttdeci">void printData(std::ostream &amp;fout)</div><div class="ttdoc">print current potential data</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:767</div></div>
<div class="ttc" id="aclassSysCounts_html_a22d0dbe1a3576c71534fd4fc7ea7ae9f"><div class="ttname"><a href="classSysCounts.html#a22d0dbe1a3576c71534fd4fc7ea7ae9f">SysCounts::n_cluster</a></div><div class="ttdeci">std::map&lt; PS::S32, PS::S32 &gt; n_cluster</div><div class="ttdoc">Histogram of number of particles in clusters.</div><div class="ttdef"><b>Definition:</b> profile.hpp:436</div></div>
<div class="ttc" id="aclassStatus_html_a7f0176ce36b41f113ac9cd02b0f541b3"><div class="ttname"><a href="classStatus.html#a7f0176ce36b41f113ac9cd02b0f541b3">Status::printColumnTitle</a></div><div class="ttdeci">void printColumnTitle(std::ofstream &amp;_fout, const PS::S32 _width=20)</div><div class="ttdoc">print titles of class members using column style</div><div class="ttdef"><b>Definition:</b> status.hpp:256</div></div>
<div class="ttc" id="astructHardEnergy_html_ac30efb096db77bccecc795941b14dac4"><div class="ttname"><a href="structHardEnergy.html#ac30efb096db77bccecc795941b14dac4">HardEnergy::de_change_binary_interrupt</a></div><div class="ttdeci">PS::F64 de_change_binary_interrupt</div><div class="ttdef"><b>Definition:</b> hard.hpp:122</div></div>
<div class="ttc" id="aclassHardManager_html_a3c94480cd738cf3a103a712dc34d877f"><div class="ttname"><a href="classHardManager.html#a3c94480cd738cf3a103a712dc34d877f">HardManager::ar_manager</a></div><div class="ttdeci">AR::TimeTransformedSymplecticManager&lt; ARInteraction &gt; ar_manager</div><div class="ttdef"><b>Definition:</b> hard.hpp:35</div></div>
<div class="ttc" id="aclassSystemHard_html_af79104a101a84b34ddfa0d87694fcb3b"><div class="ttname"><a href="classSystemHard.html#af79104a101a84b34ddfa0d87694fcb3b">SystemHard::setPtclForOneClusterOMP</a></div><div class="ttdeci">void setPtclForOneClusterOMP(const Tsys &amp;sys, const PS::ReallocatableArray&lt; PS::S32 &gt; &amp;adr_array)</div><div class="ttdef"><b>Definition:</b> hard.hpp:2026</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_af54beb9c2532976d48b0ae7bf3c7551c"><div class="ttname"><a href="classIOParamsPeTar.html#af54beb9c2532976d48b0ae7bf3c7551c">IOParamsPeTar::search_vel_factor</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; search_vel_factor</div><div class="ttdef"><b>Definition:</b> petar.hpp:113</div></div>
<div class="ttc" id="aclassHardManager_html_ad7a092adf9d04898efbcee49c2912784"><div class="ttname"><a href="classHardManager.html#ad7a092adf9d04898efbcee49c2912784">HardManager::r_in_base</a></div><div class="ttdeci">PS::F64 r_in_base</div><div class="ttdef"><b>Definition:</b> hard.hpp:30</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ad12e9c35e46d741ee967e419370e415d"><div class="ttname"><a href="classIOParamsPeTar.html#ad12e9c35e46d741ee967e419370e415d">IOParamsPeTar::gravitational_constant</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; gravitational_constant</div><div class="ttdef"><b>Definition:</b> petar.hpp:106</div></div>
<div class="ttc" id="anamespacePIKG_html_aab82f0106f14677daa09a64a269eaadf"><div class="ttname"><a href="namespacePIKG.html#aab82f0106f14677daa09a64a269eaadf">PIKG::min</a></div><div class="ttdeci">T min(const Vector3&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:150</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a7b57b431ee91260281a172138a4d5b1c"><div class="ttname"><a href="classIOParamsPeTar.html#a7b57b431ee91260281a172138a4d5b1c">IOParamsPeTar::n_group_limit</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_group_limit</div><div class="ttdef"><b>Definition:</b> petar.hpp:96</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_aa1015a13434eec535ef5231eca28e970"><div class="ttname"><a href="classIOParamsPeTar.html#aa1015a13434eec535ef5231eca28e970">IOParamsPeTar::e_err_ar</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; e_err_ar</div><div class="ttdef"><b>Definition:</b> petar.hpp:120</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a0bd1b155ddfac6ca6ff4ae8398154194"><div class="ttname"><a href="classIOParamsPeTar.html#a0bd1b155ddfac6ca6ff4ae8398154194">IOParamsPeTar::ratio_r_cut</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; ratio_r_cut</div><div class="ttdef"><b>Definition:</b> petar.hpp:93</div></div>
<div class="ttc" id="aclassStatus_html_acabdd20612801177ebc0acc3c3ddfb4d"><div class="ttname"><a href="classStatus.html#acabdd20612801177ebc0acc3c3ddfb4d">Status::n_real_glb</a></div><div class="ttdeci">PS::S64 n_real_glb</div><div class="ttdef"><b>Definition:</b> status.hpp:11</div></div>
<div class="ttc" id="aclassArtificialParticleManager_html_a652d6cdf139b4fef72816be7d7439de6"><div class="ttname"><a href="classArtificialParticleManager.html#a652d6cdf139b4fef72816be7d7439de6">ArtificialParticleManager::orbit_manager</a></div><div class="ttdeci">OrbitManager orbit_manager</div><div class="ttdoc">gravitational constant</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:238</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a6f8f101edf7583f2b20d8c4d3a322d54"><div class="ttname"><a href="classIOParamsPeTar.html#a6f8f101edf7583f2b20d8c4d3a322d54">IOParamsPeTar::n_smp_ave</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_smp_ave</div><div class="ttdef"><b>Definition:</b> petar.hpp:98</div></div>
<div class="ttc" id="aclassStatus_html_a71f2908cd2284e23931a4d364252fca1"><div class="ttname"><a href="classStatus.html#a71f2908cd2284e23931a4d364252fca1">Status::n_all_glb</a></div><div class="ttdeci">PS::S64 n_all_glb</div><div class="ttdef"><b>Definition:</b> status.hpp:13</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a3193e97896f9fe3091e7f4bc6f3a1777"><div class="ttname"><a href="classIOParamsPeTar.html#a3193e97896f9fe3091e7f4bc6f3a1777">IOParamsPeTar::n_glb</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_glb</div><div class="ttdef"><b>Definition:</b> petar.hpp:108</div></div>
<div class="ttc" id="aclassSearchCluster_html_a65a95688edf17ea40f798a6cf7055c5c"><div class="ttname"><a href="classSearchCluster.html#a65a95688edf17ea40f798a6cf7055c5c">SearchCluster::getAdrSysConnectClusterSend</a></div><div class="ttdeci">const PS::ReallocatableArray&lt; PS::S32 &gt; &amp; getAdrSysConnectClusterSend()</div><div class="ttdoc">get the address list of ptcl need to send in connected clusters</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:1376</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a5060776935b188912a225176d8cf7bbb"><div class="ttname"><a href="classIOParamsPeTar.html#a5060776935b188912a225176d8cf7bbb">IOParamsPeTar::input_par_store</a></div><div class="ttdeci">IOParamsContainer input_par_store</div><div class="ttdef"><b>Definition:</b> petar.hpp:92</div></div>
<div class="ttc" id="aclassSystemHard_html_a6c7b5d7db23cc30a8886f5cda356afe5"><div class="ttname"><a href="classSystemHard.html#a6c7b5d7db23cc30a8886f5cda356afe5">SystemHard::getNumberOfClusters</a></div><div class="ttdeci">PS::S32 getNumberOfClusters() const</div><div class="ttdef"><b>Definition:</b> hard.hpp:1929</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_afd9d1cc94757fd467975b7cf2f4baf21"><div class="ttname"><a href="classIOParamsPeTar.html#afd9d1cc94757fd467975b7cf2f4baf21">IOParamsPeTar::nstep_dt_soft_kepler</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; nstep_dt_soft_kepler</div><div class="ttdef"><b>Definition:</b> petar.hpp:112</div></div>
<div class="ttc" id="agalpy__interface_8h_html"><div class="ttname"><a href="galpy__interface_8h.html">galpy_interface.h</a></div></div>
<div class="ttc" id="aclassArtificialParticleManager_html_aef4de2cdc22768a36abee8243f0db707"><div class="ttname"><a href="classArtificialParticleManager.html#aef4de2cdc22768a36abee8243f0db707">ArtificialParticleManager::getArtificialParticleN</a></div><div class="ttdeci">PS::S32 getArtificialParticleN() const</div><div class="ttdoc">get artificial particle total number</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:427</div></div>
<div class="ttc" id="aclassStatus_html_a16948b9f8395887fd619627b5df0c619"><div class="ttname"><a href="classStatus.html#a16948b9f8395887fd619627b5df0c619">Status::n_all_loc</a></div><div class="ttdeci">PS::S64 n_all_loc</div><div class="ttdef"><b>Definition:</b> status.hpp:12</div></div>
<div class="ttc" id="acluster__list_8hpp_html"><div class="ttname"><a href="cluster__list_8hpp.html">cluster_list.hpp</a></div></div>
<div class="ttc" id="aclassHardManager_html_a6911fcad253f3013f968eb2b14df5a26"><div class="ttname"><a href="classHardManager.html#a6911fcad253f3013f968eb2b14df5a26">HardManager::setGravitationalConstant</a></div><div class="ttdeci">void setGravitationalConstant(const PS::F64 _g)</div><div class="ttdoc">set gravitational constant</div><div class="ttdef"><b>Definition:</b> hard.hpp:48</div></div>
<div class="ttc" id="aclassSystemHard_html"><div class="ttname"><a href="classSystemHard.html">SystemHard</a></div><div class="ttdoc">Hard system.</div><div class="ttdef"><b>Definition:</b> hard.hpp:1190</div></div>
<div class="ttc" id="aescaper_8hpp_html"><div class="ttname"><a href="escaper_8hpp.html">escaper.hpp</a></div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_a01d39d5cf22000b7af75f3d14217374f"><div class="ttname"><a href="classEnergyAndMomemtum.html#a01d39d5cf22000b7af75f3d14217374f">EnergyAndMomemtum::etot_ref</a></div><div class="ttdeci">PS::F64 etot_ref</div><div class="ttdef"><b>Definition:</b> energy.hpp:9</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a0407aebcf4c0b3c5f15a036bc9c781af"><div class="ttname"><a href="classIOParamsPeTar.html#a0407aebcf4c0b3c5f15a036bc9c781af">IOParamsPeTar::fname_inp</a></div><div class="ttdeci">IOParams&lt; std::string &gt; fname_inp</div><div class="ttdef"><b>Definition:</b> petar.hpp:144</div></div>
<div class="ttc" id="aclassSysProfile_html_af82213cefaced581c81bb57bf9d6c5f9"><div class="ttname"><a href="classSysProfile.html#af82213cefaced581c81bb57bf9d6c5f9">SysProfile::create_group</a></div><div class="ttdeci">Tprofile create_group</div><div class="ttdef"><b>Definition:</b> profile.hpp:325</div></div>
<div class="ttc" id="aclassEscaper_html"><div class="ttname"><a href="classEscaper.html">Escaper</a></div><div class="ttdoc">escaper checker</div><div class="ttdef"><b>Definition:</b> escaper.hpp:5</div></div>
<div class="ttc" id="aclassSearchCluster_html_aaa328193a00abba83aec52fa41066843"><div class="ttname"><a href="classSearchCluster.html#aaa328193a00abba83aec52fa41066843">SearchCluster::adr_sys_multi_cluster_isolated_</a></div><div class="ttdeci">PS::ReallocatableArray&lt; PS::S32 &gt; adr_sys_multi_cluster_isolated_</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:182</div></div>
<div class="ttc" id="aclassIOParamsContainer_html_a4e42d749bdaeba0cbf805d45f2401aa1"><div class="ttname"><a href="classIOParamsContainer.html#a4e42d749bdaeba0cbf805d45f2401aa1">IOParamsContainer::writeAscii</a></div><div class="ttdeci">void writeAscii(FILE *_fout)</div><div class="ttdef"><b>Definition:</b> io.hpp:106</div></div>
<div class="ttc" id="astructTprofile_html_ae076178b36b67a001dcb3519b729b5db"><div class="ttname"><a href="structTprofile.html#ae076178b36b67a001dcb3519b729b5db">Tprofile::tbar</a></div><div class="ttdeci">PS::F64 tbar</div><div class="ttdef"><b>Definition:</b> profile.hpp:178</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a6ba6476cb397b9177ce4e175d947d3de"><div class="ttname"><a href="classKickDriftStep.html#a6ba6476cb397b9177ce4e175d947d3de">KickDriftStep::getCountContinue</a></div><div class="ttdeci">PS::S32 getCountContinue() const</div><div class="ttdoc">get step count for continue case</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:51</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_af31a9da18c36557c9d5b15fc4ab34e26"><div class="ttname"><a href="classIOParamsPeTar.html#af31a9da18c36557c9d5b15fc4ab34e26">IOParamsPeTar::dt_snap</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; dt_snap</div><div class="ttdef"><b>Definition:</b> petar.hpp:111</div></div>
<div class="ttc" id="astatus_8hpp_html"><div class="ttname"><a href="status_8hpp.html">status.hpp</a></div></div>
<div class="ttc" id="aclassSearchCluster_html_a7ec681af7a9dd3a5d464d9efc3c8e8f7"><div class="ttname"><a href="classSearchCluster.html#a7ec681af7a9dd3a5d464d9efc3c8e8f7">SearchCluster::ptcl_recv_</a></div><div class="ttdeci">PS::ReallocatableArray&lt; PtclComm &gt; ptcl_recv_</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:181</div></div>
<div class="ttc" id="aclassStatus_html_ae97a62d35d7fdb083be8d441fc3b2270"><div class="ttname"><a href="classStatus.html#ae97a62d35d7fdb083be8d441fc3b2270">Status::print</a></div><div class="ttdeci">void print(std::ostream &amp;_fout, const PS::S32 _precision=7)</div><div class="ttdoc">print title and values in one lines</div><div class="ttdef"><b>Definition:</b> status.hpp:290</div></div>
<div class="ttc" id="aclassSysProfile_html_a9a98d322ca1b73c44da1bac2bdc782f1"><div class="ttname"><a href="classSysProfile.html#a9a98d322ca1b73c44da1bac2bdc782f1">SysProfile::hard_connected</a></div><div class="ttdeci">Tprofile hard_connected</div><div class="ttdef"><b>Definition:</b> profile.hpp:318</div></div>
<div class="ttc" id="aclassSysProfile_html_a64c14ef58f38b806f03a24fd9628c470"><div class="ttname"><a href="classSysProfile.html#a64c14ef58f38b806f03a24fd9628c470">SysProfile::dumpName</a></div><div class="ttdeci">void dumpName(std::ostream &amp;fout, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:368</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ad2007b2bb110bca2327ed5e1153d7882"><div class="ttname"><a href="classIOParamsPeTar.html#ad2007b2bb110bca2327ed5e1153d7882">IOParamsPeTar::n_bin</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_bin</div><div class="ttdef"><b>Definition:</b> petar.hpp:102</div></div>
<div class="ttc" id="aclassSysProfile_html_ab2e64f3792e3cbeb6c94ca2c993b7df1"><div class="ttname"><a href="classSysProfile.html#ab2e64f3792e3cbeb6c94ca2c993b7df1">SysProfile::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> profile.hpp:409</div></div>
<div class="ttc" id="aclassEPJSoft_html"><div class="ttname"><a href="classEPJSoft.html">EPJSoft</a></div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:311</div></div>
<div class="ttc" id="astructStatus_1_1ParticleCM_html_a420cd069d45deba870bc7013fb050a88"><div class="ttname"><a href="structStatus_1_1ParticleCM.html#a420cd069d45deba870bc7013fb050a88">Status::ParticleCM::pos</a></div><div class="ttdeci">PS::F64vec pos</div><div class="ttdef"><b>Definition:</b> status.hpp:20</div></div>
<div class="ttc" id="abse__test_8cxx_html_aa281fbf9e0e41ce49b364f7f17432af1"><div class="ttname"><a href="bse__test_8cxx.html#aa281fbf9e0e41ce49b364f7f17432af1">WRITE_PRECISION</a></div><div class="ttdeci">const int WRITE_PRECISION</div><div class="ttdef"><b>Definition:</b> bse_test.cxx:11</div></div>
<div class="ttc" id="astructHardEnergy_html_a3314977f280a8ab3cd5fc55a12bc25d4"><div class="ttname"><a href="structHardEnergy.html#a3314977f280a8ab3cd5fc55a12bc25d4">HardEnergy::epot_sd_correction</a></div><div class="ttdeci">PS::F64 epot_sd_correction</div><div class="ttdef"><b>Definition:</b> hard.hpp:129</div></div>
<div class="ttc" id="aclassArtificialParticleManager_html_ab892e537c506f6e0c29d0e7e86113e58"><div class="ttname"><a href="classArtificialParticleManager.html#ab892e537c506f6e0c29d0e7e86113e58">ArtificialParticleManager::id_offset</a></div><div class="ttdeci">PS::S64 id_offset</div><div class="ttdoc">tidal tensor maximum distance of particles</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:236</div></div>
<div class="ttc" id="astructCalcForceWithLinearCutoffCUDA_html"><div class="ttname"><a href="structCalcForceWithLinearCutoffCUDA.html">CalcForceWithLinearCutoffCUDA</a></div><div class="ttdef"><b>Definition:</b> force_gpu_cuda.hpp:137</div></div>
<div class="ttc" id="aclassSysProfile_html_a13f67d41005470f18b697de432c5ea58"><div class="ttname"><a href="classSysProfile.html#a13f67d41005470f18b697de432c5ea58">SysProfile::hard_interrupt</a></div><div class="ttdeci">Tprofile hard_interrupt</div><div class="ttdef"><b>Definition:</b> profile.hpp:319</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_ad010440b7d8abbcd67597f1d88eb3789"><div class="ttname"><a href="classIOParamsBSE.html#ad010440b7d8abbcd67597f1d88eb3789">IOParamsBSE::rscale</a></div><div class="ttdeci">IOParams&lt; double &gt; rscale</div><div class="ttdef"><b>Definition:</b> bse_interface.h:661</div></div>
<div class="ttc" id="aclassFDPSProfile_html"><div class="ttname"><a href="classFDPSProfile.html">FDPSProfile</a></div><div class="ttdef"><b>Definition:</b> profile.hpp:267</div></div>
<div class="ttc" id="aclassFPSoft_html_ad052ed9ba9fa413f216cb2501f1cf669"><div class="ttname"><a href="classFPSoft.html#ad052ed9ba9fa413f216cb2501f1cf669">FPSoft::adr</a></div><div class="ttdeci">PS::S32 adr</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:42</div></div>
<div class="ttc" id="aclassSysProfile_html_adbcdfaecb25949b2472bfda5e66b92c7"><div class="ttname"><a href="classSysProfile.html#adbcdfaecb25949b2472bfda5e66b92c7">SysProfile::other</a></div><div class="ttdeci">Tprofile other</div><div class="ttdef"><b>Definition:</b> profile.hpp:330</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a608ca7244984d88792ea02834a3d2263"><div class="ttname"><a href="classIOParamsPeTar.html#a608ca7244984d88792ea02834a3d2263">IOParamsPeTar::eps</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; eps</div><div class="ttdef"><b>Definition:</b> petar.hpp:125</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a07e17a0071402ddd7f49d9aa54230580"><div class="ttname"><a href="classIOParamsPeTar.html#a07e17a0071402ddd7f49d9aa54230580">IOParamsPeTar::step_limit_ar</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; step_limit_ar</div><div class="ttdef"><b>Definition:</b> petar.hpp:124</div></div>
<div class="ttc" id="aclassSearchCluster_html_a41fc2645bb9d6f7feb188d6de0526df4"><div class="ttname"><a href="classSearchCluster.html#a41fc2645bb9d6f7feb188d6de0526df4">SearchCluster::searchClusterLocal</a></div><div class="ttdeci">void searchClusterLocal()</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:613</div></div>
<div class="ttc" id="aclassFPSoft_html_aca3236af1ccb822b51a0cb4acb2ab678"><div class="ttname"><a href="classFPSoft.html#aca3236af1ccb822b51a0cb4acb2ab678">FPSoft::printTitleWithMeaning</a></div><div class="ttdeci">static int printTitleWithMeaning(std::ostream &amp;_fout, const int _counter=0, const int _offset=0)</div><div class="ttdoc">print column title with meaning (each line for one column)</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:203</div></div>
<div class="ttc" id="astructIOParams_html"><div class="ttname"><a href="structIOParams.html">IOParams&lt; PS::F64 &gt;</a></div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a459dc4dad034e4045a1f90db02c6ccd1"><div class="ttname"><a href="classIOParamsPeTar.html#a459dc4dad034e4045a1f90db02c6ccd1">IOParamsPeTar::sd_factor</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; sd_factor</div><div class="ttdef"><b>Definition:</b> petar.hpp:131</div></div>
<div class="ttc" id="aclassSystemHard_html_aa18476d87a9f3647939b7429899e13bb"><div class="ttname"><a href="classSystemHard.html#aa18476d87a9f3647939b7429899e13bb">SystemHard::setPtclForIsolatedMultiClusterOMP</a></div><div class="ttdeci">void setPtclForIsolatedMultiClusterOMP(const Tsys &amp;sys, const PS::ReallocatableArray&lt; PS::S32 &gt; &amp;_adr_array, const PS::ReallocatableArray&lt; PS::S32 &gt; &amp;_n_ptcl_in_cluster)</div><div class="ttdef"><b>Definition:</b> hard.hpp:2229</div></div>
<div class="ttc" id="aclassStatus_html_a1c95aee88a7a5568b46d2c700198a139"><div class="ttname"><a href="classStatus.html#a1c95aee88a7a5568b46d2c700198a139">Status::calcAndShiftCenterOfMass</a></div><div class="ttdeci">void calcAndShiftCenterOfMass(Tsoft *_tsys, const PS::S64 _n, const int _mode=3, const bool initial_flag=false)</div><div class="ttdoc">calculate the center of system and shift particle systems to center frame</div><div class="ttdef"><b>Definition:</b> status.hpp:228</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a5c2a2666cccdfef09e1beff511129ebe"><div class="ttname"><a href="classIOParamsPeTar.html#a5c2a2666cccdfef09e1beff511129ebe">IOParamsPeTar::eta</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; eta</div><div class="ttdef"><b>Definition:</b> petar.hpp:105</div></div>
<div class="ttc" id="aclassSystemHard_html_aa4aebe7d712e02085a411e85618d6f12"><div class="ttname"><a href="classSystemHard.html#aa4aebe7d712e02085a411e85618d6f12">SystemHard::writeBackPtclForMultiCluster</a></div><div class="ttdeci">void writeBackPtclForMultiCluster(Tsys &amp;_sys, PS::ReallocatableArray&lt; PS::S32 &gt; &amp;_mass_modify_list)</div><div class="ttdoc">write back hard particles to global system, check mass modification and update time of write back</div><div class="ttdef"><b>Definition:</b> hard.hpp:2192</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html_a7525714c40a2cc23a672b9f2498dcc3d"><div class="ttname"><a href="classIOParamsGalpy.html#a7525714c40a2cc23a672b9f2498dcc3d">IOParamsGalpy::read</a></div><div class="ttdeci">int read(int argc, char *argv[], const int opt_used_pre=0)</div><div class="ttdoc">reading parameters from GNU option API</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:49</div></div>
<div class="ttc" id="aclassSystemHard_html_a689b06c61c96f9d0cd2447402b83d3fc"><div class="ttname"><a href="classSystemHard.html#a689b06c61c96f9d0cd2447402b83d3fc">SystemHard::allocateHardIntegrator</a></div><div class="ttdeci">void allocateHardIntegrator(const PS::S32 _n_hard_int)</div><div class="ttdoc">allocate memorgy for HardIntegrator</div><div class="ttdef"><b>Definition:</b> hard.hpp:1836</div></div>
<div class="ttc" id="aclassSystemHard_html_a7a93c9f2f0da92ca0eb63989a8ab2191"><div class="ttname"><a href="classSystemHard.html#a7a93c9f2f0da92ca0eb63989a8ab2191">SystemHard::getClusterNumberOfMemberList</a></div><div class="ttdeci">PS::S32 * getClusterNumberOfMemberList(const std::size_t i=0) const</div><div class="ttdef"><b>Definition:</b> hard.hpp:1941</div></div>
<div class="ttc" id="aforce__fugaku_8hpp_html"><div class="ttname"><a href="force__fugaku_8hpp.html">force_fugaku.hpp</a></div></div>
<div class="ttc" id="aclassEPISoft_html_a1aa7e04f972b62365f20272e926ecbdc"><div class="ttname"><a href="classEPISoft.html#a1aa7e04f972b62365f20272e926ecbdc">EPISoft::eps</a></div><div class="ttdeci">static PS::F64 eps</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:281</div></div>
<div class="ttc" id="aclassSysCounts_html_ac3d58a6d8e0e757af3c1054ebe50a770"><div class="ttname"><a href="classSysCounts.html#ac3d58a6d8e0e757af3c1054ebe50a770">SysCounts::cluster_connected</a></div><div class="ttdeci">NumCounter cluster_connected</div><div class="ttdef"><b>Definition:</b> profile.hpp:425</div></div>
<div class="ttc" id="abse__test_8cxx_html_ad9cf81e75da0343660af7eea82db4904"><div class="ttname"><a href="bse__test_8cxx.html#ad9cf81e75da0343660af7eea82db4904">WRITE_WIDTH</a></div><div class="ttdeci">const int WRITE_WIDTH</div><div class="ttdef"><b>Definition:</b> bse_test.cxx:10</div></div>
<div class="ttc" id="aclassIOParamsGalpy_html"><div class="ttname"><a href="classIOParamsGalpy.html">IOParamsGalpy</a></div><div class="ttdoc">IO parameters for Galpy manager.</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:15</div></div>
<div class="ttc" id="aclassSysCounts_html_ad95a1ce759efcb258f8faf632cb8f5e2"><div class="ttname"><a href="classSysCounts.html#ad95a1ce759efcb258f8faf632cb8f5e2">SysCounts::hard_single</a></div><div class="ttdeci">NumCounter hard_single</div><div class="ttdef"><b>Definition:</b> profile.hpp:420</div></div>
<div class="ttc" id="aclassKickDriftStep_html_aab1d155c3b9c827a131539d82925794a"><div class="ttname"><a href="classKickDriftStep.html#aab1d155c3b9c827a131539d82925794a">KickDriftStep::getDtKickContinue</a></div><div class="ttdeci">PS::F64 getDtKickContinue()</div><div class="ttdoc">Get kick step size for continue case.</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:122</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_aa428da858ec3e53058edeb77b9412075"><div class="ttname"><a href="classIOParamsPeTar.html#aa428da858ec3e53058edeb77b9412075">IOParamsPeTar::read</a></div><div class="ttdeci">int read(int argc, char *argv[], const int opt_used_pre=0)</div><div class="ttdoc">reading parameters from GNU option API</div><div class="ttdef"><b>Definition:</b> petar.hpp:225</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_afb4916c4cf071cd43d5d9295c72075dd"><div class="ttname"><a href="classIOParamsPeTar.html#afb4916c4cf071cd43d5d9295c72075dd">IOParamsPeTar::dt_limit_hard_factor</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; dt_limit_hard_factor</div><div class="ttdef"><b>Definition:</b> petar.hpp:115</div></div>
<div class="ttc" id="aclassSystemHard_html_a948046ca0f81181a45882201c86cca56"><div class="ttname"><a href="classSystemHard.html#a948046ca0f81181a45882201c86cca56">SystemHard::correctForceForChangeOverUpdateOMP</a></div><div class="ttdeci">void correctForceForChangeOverUpdateOMP(Tsys &amp;_sys, Ttree &amp;_tree, const PS::S32 *_adr_send=NULL, const PS::S32 _n_send=0)</div><div class="ttdoc">Correct force due to change over factor change.</div><div class="ttdef"><b>Definition:</b> hard.hpp:3262</div></div>
<div class="ttc" id="anamespacePIKG_html_aede68ae33404ee6199164897b8cbc9ad"><div class="ttname"><a href="namespacePIKG.html#aede68ae33404ee6199164897b8cbc9ad">PIKG::max</a></div><div class="ttdeci">T max(const Vector3&lt; T &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:143</div></div>
<div class="ttc" id="aclassSystemHard_html_aac43bb3f43f7b3ea6f04efcc40bf11bd"><div class="ttname"><a href="classSystemHard.html#aac43bb3f43f7b3ea6f04efcc40bf11bd">SystemHard::findGroupsAndCreateArtificialParticlesOMP</a></div><div class="ttdeci">void findGroupsAndCreateArtificialParticlesOMP(Tsys &amp;_sys, const PS::F64 _dt_tree)</div><div class="ttdoc">Find groups and create aritfical particles to sys.</div><div class="ttdef"><b>Definition:</b> hard.hpp:2757</div></div>
<div class="ttc" id="aclassFileHeader_html_a815f6011d37a3cae9dced9652c3b592a"><div class="ttname"><a href="classFileHeader.html#a815f6011d37a3cae9dced9652c3b592a">FileHeader::nfile</a></div><div class="ttdeci">long long int nfile</div><div class="ttdef"><b>Definition:</b> io.hpp:212</div></div>
<div class="ttc" id="ahard__assert_8hpp_html"><div class="ttname"><a href="hard__assert_8hpp.html">hard_assert.hpp</a></div></div>
<div class="ttc" id="aclassSysCounts_html_a12fd2d6d24adf423f07981ce005228a0"><div class="ttname"><a href="classSysCounts.html#a12fd2d6d24adf423f07981ce005228a0">SysCounts::hard_isolated</a></div><div class="ttdeci">NumCounter hard_isolated</div><div class="ttdef"><b>Definition:</b> profile.hpp:421</div></div>
<div class="ttc" id="aclassSysProfile_html_a46bf7349e0d7d7f7b51335a090937a47"><div class="ttname"><a href="classSysProfile.html#a46bf7349e0d7d7f7b51335a090937a47">SysProfile::exchange</a></div><div class="ttdeci">Tprofile exchange</div><div class="ttdef"><b>Definition:</b> profile.hpp:327</div></div>
<div class="ttc" id="aclassHardManager_html_af7548086113d591778ce878a53dad036"><div class="ttname"><a href="classHardManager.html#af7548086113d591778ce878a53dad036">HardManager::checkParams</a></div><div class="ttdeci">bool checkParams()</div><div class="ttdoc">check paramters</div><div class="ttdef"><b>Definition:</b> hard.hpp:68</div></div>
<div class="ttc" id="aclassSysProfile_html_ae98fe6006760d363089bdefe67d11d8d"><div class="ttname"><a href="classSysProfile.html#ae98fe6006760d363089bdefe67d11d8d">SysProfile::dumpBarrierName</a></div><div class="ttdeci">void dumpBarrierName(std::ostream &amp;fout, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:382</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a2868ec373fbd7b69a3a52349f1809b90"><div class="ttname"><a href="classIOParamsPeTar.html#a2868ec373fbd7b69a3a52349f1809b90">IOParamsPeTar::fname_par</a></div><div class="ttdeci">IOParams&lt; std::string &gt; fname_par</div><div class="ttdef"><b>Definition:</b> petar.hpp:143</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a12b4c4a477b5814d0407d62142052bf6"><div class="ttname"><a href="classIOParamsPeTar.html#a12b4c4a477b5814d0407d62142052bf6">IOParamsPeTar::n_interrupt_limit</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; n_interrupt_limit</div><div class="ttdef"><b>Definition:</b> petar.hpp:97</div></div>
<div class="ttc" id="astatic__variables_8hpp_html"><div class="ttname"><a href="static__variables_8hpp.html">static_variables.hpp</a></div></div>
<div class="ttc" id="aclassSysCounts_html_ae736859dafde342d60a11464140a785b"><div class="ttname"><a href="classSysCounts.html#ae736859dafde342d60a11464140a785b">SysCounts::clearClusterCount</a></div><div class="ttdeci">void clearClusterCount()</div><div class="ttdef"><b>Definition:</b> profile.hpp:460</div></div>
<div class="ttc" id="astructHardEnergy_html_a8a1ec16791c1470f637f1d7f2646e605"><div class="ttname"><a href="structHardEnergy.html#a8a1ec16791c1470f637f1d7f2646e605">HardEnergy::de_sd_change_modify_single</a></div><div class="ttdeci">PS::F64 de_sd_change_modify_single</div><div class="ttdef"><b>Definition:</b> hard.hpp:127</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a59127c2c2bf117e0687726ebcf43d6f0"><div class="ttname"><a href="classKickDriftStep.html#a59127c2c2bf117e0687726ebcf43d6f0">KickDriftStep::getDtStartContinue</a></div><div class="ttdeci">PS::F64 getDtStartContinue()</div><div class="ttdoc">Get staring step size for continue case.</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:150</div></div>
<div class="ttc" id="aclassStatus_html_ab6be16aefc348d3d5c95e83bd7a4b64f"><div class="ttname"><a href="classStatus.html#ab6be16aefc348d3d5c95e83bd7a4b64f">Status::n_real_loc</a></div><div class="ttdeci">PS::S64 n_real_loc</div><div class="ttdef"><b>Definition:</b> status.hpp:10</div></div>
<div class="ttc" id="aclassSearchCluster_html"><div class="ttname"><a href="classSearchCluster.html">SearchCluster</a></div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:176</div></div>
<div class="ttc" id="aclassSystemHard_html_a6c021c99c3f6ae3adbfbc3a4929fd06f"><div class="ttname"><a href="classSystemHard.html#a6c021c99c3f6ae3adbfbc3a4929fd06f">SystemHard::manager</a></div><div class="ttdeci">HardManager * manager</div><div class="ttdef"><b>Definition:</b> hard.hpp:1221</div></div>
<div class="ttc" id="astructHardEnergy_html_a85e9efe1ce7511c36d142f0fc5cc92a2"><div class="ttname"><a href="structHardEnergy.html#a85e9efe1ce7511c36d142f0fc5cc92a2">HardEnergy::de_change_modify_single</a></div><div class="ttdeci">PS::F64 de_change_modify_single</div><div class="ttdef"><b>Definition:</b> hard.hpp:123</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a3d02ef6fcb1076502ba6fac726a67d28"><div class="ttname"><a href="classIOParamsPeTar.html#a3d02ef6fcb1076502ba6fac726a67d28">IOParamsPeTar::interrupt_detection_option</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; interrupt_detection_option</div><div class="ttdef"><b>Definition:</b> petar.hpp:137</div></div>
<div class="ttc" id="aclassFDPSProfile_html_a00c543c78cce28a08c0d40c5bf32cbd4"><div class="ttname"><a href="classFDPSProfile.html#a00c543c78cce28a08c0d40c5bf32cbd4">FDPSProfile::dumpName</a></div><div class="ttdeci">void dumpName(std::ostream &amp;fout, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:274</div></div>
<div class="ttc" id="aclassSysCounts_html_a9d983bfda9790179f173da6f09af5d35"><div class="ttname"><a href="classSysCounts.html#a9d983bfda9790179f173da6f09af5d35">SysCounts::dumpName</a></div><div class="ttdeci">void dumpName(std::ostream &amp;fout, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:526</div></div>
<div class="ttc" id="aclassSystemHard_html_a8baaff00777996341313a1ca786a0e31"><div class="ttname"><a href="classSystemHard.html#a8baaff00777996341313a1ca786a0e31">SystemHard::initializeForOneCluster</a></div><div class="ttdeci">void initializeForOneCluster(const PS::S32 n)</div><div class="ttdef"><b>Definition:</b> hard.hpp:1851</div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_ab05745baa09b2424652f395d3780ee57"><div class="ttname"><a href="classEnergyAndMomemtum.html#ab05745baa09b2424652f395d3780ee57">EnergyAndMomemtum::getSumMultiNodes</a></div><div class="ttdeci">void getSumMultiNodes(const bool _init_flag=false)</div><div class="ttdoc">get summation of kinetic, potential energy and angular momemtum of all MPI processes</div><div class="ttdef"><b>Definition:</b> energy.hpp:286</div></div>
<div class="ttc" id="aclassStatus_html_ac895ac689db4a88a5824c8ba679e71db"><div class="ttname"><a href="classStatus.html#ac895ac689db4a88a5824c8ba679e71db">Status::energy</a></div><div class="ttdeci">EnergyAndMomemtum energy</div><div class="ttdef"><b>Definition:</b> status.hpp:17</div></div>
<div class="ttc" id="aclassGalpyManager_html_a56875a530c45fac6439a6d6d4f671b3d"><div class="ttname"><a href="classGalpyManager.html#a56875a530c45fac6439a6d6d4f671b3d">GalpyManager::driftMovePot</a></div><div class="ttdeci">void driftMovePot(const double dt)</div><div class="ttdoc">drift position of moving potential (mode 2)</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1522</div></div>
<div class="ttc" id="aclassEscaper_html_aafe14c4313939d6e8e3c46e1848c3b28"><div class="ttname"><a href="classEscaper.html#aafe14c4313939d6e8e3c46e1848c3b28">Escaper::check_energy_flag</a></div><div class="ttdeci">bool check_energy_flag</div><div class="ttdef"><b>Definition:</b> escaper.hpp:8</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_aa8274f54dfd8538bef1f43110dfb4e4d"><div class="ttname"><a href="classIOParamsBSE.html#aa8274f54dfd8538bef1f43110dfb4e4d">IOParamsBSE::mscale</a></div><div class="ttdeci">IOParams&lt; double &gt; mscale</div><div class="ttdef"><b>Definition:</b> bse_interface.h:662</div></div>
<div class="ttc" id="aclassKickDriftStep_html_ac13b3a09c5626975c412cdf331316c92"><div class="ttname"><a href="classKickDriftStep.html#ac13b3a09c5626975c412cdf331316c92">KickDriftStep::getDtDriftContinue</a></div><div class="ttdeci">PS::F64 getDtDriftContinue()</div><div class="ttdoc">Get drift step size for continue case.</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:136</div></div>
<div class="ttc" id="aclassArtificialParticleManager_html"><div class="ttname"><a href="classArtificialParticleManager.html">ArtificialParticleManager</a></div><div class="ttdoc">class to organize artificial particles</div><div class="ttdef"><b>Definition:</b> artificial_particles.hpp:232</div></div>
<div class="ttc" id="aclassGalpyManager_html_accd0a3c5a62b628e4a9e002f8ec10ad4"><div class="ttname"><a href="classGalpyManager.html#accd0a3c5a62b628e4a9e002f8ec10ad4">GalpyManager::resetPotAcc</a></div><div class="ttdeci">void resetPotAcc()</div><div class="ttdoc">reset acceleraltion of potential</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1492</div></div>
<div class="ttc" id="aclassHardManager_html_a15998274cba2e1818e82ce08a2aaccb2"><div class="ttname"><a href="classHardManager.html#a15998274cba2e1818e82ce08a2aaccb2">HardManager::setDtRange</a></div><div class="ttdeci">void setDtRange(const PS::F64 _dt_max, const PS::S32 _dt_min_index)</div><div class="ttdoc">set time step range</div><div class="ttdef"><b>Definition:</b> hard.hpp:61</div></div>
<div class="ttc" id="aclassEscaper_html_a9590851cc9f8630c1492a4e3a463d22c"><div class="ttname"><a href="classEscaper.html#a9590851cc9f8630c1492a4e3a463d22c">Escaper::r_escape_sq</a></div><div class="ttdeci">PS::F64 r_escape_sq</div><div class="ttdef"><b>Definition:</b> escaper.hpp:7</div></div>
<div class="ttc" id="aclassBSEManager_html_a69d7169d4261241df2459d3ea3b96492"><div class="ttname"><a href="classBSEManager.html#a69d7169d4261241df2459d3ea3b96492">BSEManager::getSSEOutputFilenameSuffix</a></div><div class="ttdeci">static std::string getSSEOutputFilenameSuffix()</div><div class="ttdef"><b>Definition:</b> bse_interface.h:1168</div></div>
<div class="ttc" id="aclassSysCounts_html_a02aaf494a19a1017204c0e4b6336eaf4"><div class="ttname"><a href="classSysCounts.html#a02aaf494a19a1017204c0e4b6336eaf4">SysCounts::ARC_substep_sum</a></div><div class="ttdeci">NumCounter ARC_substep_sum</div><div class="ttdef"><b>Definition:</b> profile.hpp:426</div></div>
<div class="ttc" id="astructHardEnergy_html_a302ae473aba079cf68af9fcdf2634a2e"><div class="ttname"><a href="structHardEnergy.html#a302ae473aba079cf68af9fcdf2634a2e">HardEnergy::de_sd_change_cum</a></div><div class="ttdeci">PS::F64 de_sd_change_cum</div><div class="ttdef"><b>Definition:</b> hard.hpp:125</div></div>
<div class="ttc" id="astructStatus_1_1ParticleCM_html_a4c4dec3144fdb4b077c095492a24969a"><div class="ttname"><a href="structStatus_1_1ParticleCM.html#a4c4dec3144fdb4b077c095492a24969a">Status::ParticleCM::is_center_shift_flag</a></div><div class="ttdeci">bool is_center_shift_flag</div><div class="ttdef"><b>Definition:</b> status.hpp:22</div></div>
<div class="ttc" id="aclassSystemHard_html_aaa3225b5e3f3fdeef1626258addcae12"><div class="ttname"><a href="classSystemHard.html#aaa3225b5e3f3fdeef1626258addcae12">SystemHard::getTimeOrigin</a></div><div class="ttdeci">PS::F64 getTimeOrigin() const</div><div class="ttdef"><b>Definition:</b> hard.hpp:1973</div></div>
<div class="ttc" id="aclassSystemHard_html_a1801c9b9ed48c4dab3c5e0ee8d8fe67d"><div class="ttname"><a href="classSystemHard.html#a1801c9b9ed48c4dab3c5e0ee8d8fe67d">SystemHard::getPtcl</a></div><div class="ttdeci">PS::ReallocatableArray&lt; PtclH4 &gt; &amp; getPtcl()</div><div class="ttdef"><b>Definition:</b> hard.hpp:1925</div></div>
<div class="ttc" id="aclassFileHeader_html"><div class="ttname"><a href="classFileHeader.html">FileHeader</a></div><div class="ttdef"><b>Definition:</b> io.hpp:210</div></div>
<div class="ttc" id="aclassPtcl_html_a452aeb749947f5076dc1ec44ce8b3119"><div class="ttname"><a href="classPtcl.html#a452aeb749947f5076dc1ec44ce8b3119">Ptcl::search_factor</a></div><div class="ttdeci">static PS::F64 search_factor</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:42</div></div>
<div class="ttc" id="aenergy_8hpp_html"><div class="ttname"><a href="energy_8hpp.html">energy.hpp</a></div></div>
<div class="ttc" id="astructTprofile_html_a08637a9e011800923ded7647915c5487"><div class="ttname"><a href="structTprofile.html#a08637a9e011800923ded7647915c5487">Tprofile::time</a></div><div class="ttdeci">PS::F64 time</div><div class="ttdef"><b>Definition:</b> profile.hpp:177</div></div>
<div class="ttc" id="aio_8hpp_html_a38caeb67950bf01a29a5dd4c937ca236"><div class="ttname"><a href="io_8hpp.html#a38caeb67950bf01a29a5dd4c937ca236">PRINT_PRECISION</a></div><div class="ttdeci">#define PRINT_PRECISION</div><div class="ttdef"><b>Definition:</b> io.hpp:11</div></div>
<div class="ttc" id="aclassStatus_html_a95226a9e5aceeea5c44e89b8a3bccb0c"><div class="ttname"><a href="classStatus.html#a95226a9e5aceeea5c44e89b8a3bccb0c">Status::calcCenterOfMass</a></div><div class="ttdeci">void calcCenterOfMass(Tsoft *_tsys, const PS::S64 _n, int _mode=3)</div><div class="ttdoc">calculate the center of system</div><div class="ttdef"><b>Definition:</b> status.hpp:116</div></div>
<div class="ttc" id="aclassSystemHard_html_a7c2326950585e3ca686ac07faff7f246"><div class="ttname"><a href="classSystemHard.html#a7c2326950585e3ca686ac07faff7f246">SystemHard::writeBackPtclForOneClusterOMP</a></div><div class="ttdeci">void writeBackPtclForOneClusterOMP(Tsys &amp;sys, PS::ReallocatableArray&lt; PS::S32 &gt; &amp;_mass_modify_list)</div><div class="ttdoc">write back hard particles to global system and update time of write back OMP version</div><div class="ttdef"><b>Definition:</b> hard.hpp:2143</div></div>
<div class="ttc" id="aclassSysCounts_html_a34b0e1f4a51d345a1860fb290378c7ed"><div class="ttname"><a href="classSysCounts.html#a34b0e1f4a51d345a1860fb290378c7ed">SysCounts::H4_step_sum</a></div><div class="ttdeci">NumCounter H4_step_sum</div><div class="ttdef"><b>Definition:</b> profile.hpp:430</div></div>
<div class="ttc" id="aclassSystemHard_html_a4f4cc338a1ecb9b1e2530a9a0ec0f68b"><div class="ttname"><a href="classSystemHard.html#a4f4cc338a1ecb9b1e2530a9a0ec0f68b">SystemHard::correctForceWithCutoffTreeNeighborAndClusterOMP</a></div><div class="ttdeci">void correctForceWithCutoffTreeNeighborAndClusterOMP(Tsys &amp;_sys, Ttree &amp;_tree, const PS::ReallocatableArray&lt; PS::S32 &gt; &amp;_adr_send, const bool _acorr_flag=false)</div><div class="ttdoc">Soft force correction due to different cut-off function.</div><div class="ttdef"><b>Definition:</b> hard.hpp:3132</div></div>
<div class="ttc" id="aclassSysProfile_html_a5d93b0ea4c88be1d3e320b7dc9fd6002"><div class="ttname"><a href="classSysProfile.html#a5d93b0ea4c88be1d3e320b7dc9fd6002">SysProfile::hard_single</a></div><div class="ttdeci">Tprofile hard_single</div><div class="ttdef"><b>Definition:</b> profile.hpp:316</div></div>
<div class="ttc" id="aclassPtcl_html_a6a43cef83e56ad4b3d985ccead9ef716"><div class="ttname"><a href="classPtcl.html#a6a43cef83e56ad4b3d985ccead9ef716">Ptcl::id</a></div><div class="ttdeci">PS::S64 id</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:39</div></div>
<div class="ttc" id="aclassPtcl_html_a774fbb60e8482e1f77637418409bd3dd"><div class="ttname"><a href="classPtcl.html#a774fbb60e8482e1f77637418409bd3dd">Ptcl::r_group_crit_ratio</a></div><div class="ttdeci">static PS::F64 r_group_crit_ratio</div><div class="ttdef"><b>Definition:</b> ptcl.hpp:44</div></div>
<div class="ttc" id="aclassIOParamsContainer_html"><div class="ttname"><a href="classIOParamsContainer.html">IOParamsContainer</a></div><div class="ttdoc">IO Params container.</div><div class="ttdef"><b>Definition:</b> io.hpp:82</div></div>
<div class="ttc" id="aget__version_8hpp_html_a818f229e54b2ba1843a3692b9cecd363"><div class="ttname"><a href="get__version_8hpp.html#a818f229e54b2ba1843a3692b9cecd363">GetVersion</a></div><div class="ttdeci">std::string GetVersion()</div><div class="ttdef"><b>Definition:</b> get_version.hpp:4</div></div>
<div class="ttc" id="aclassSysCounts_html_a56d420bdf5e85f515fa2d706adf1f6c0"><div class="ttname"><a href="classSysCounts.html#a56d420bdf5e85f515fa2d706adf1f6c0">SysCounts::printHist</a></div><div class="ttdeci">void printHist(std::ostream &amp;fout, const PS::S64 n_loop=1, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:487</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_ac385ca33abb342a264e4180aa5fbca4f"><div class="ttname"><a href="classIOParamsBSE.html#ac385ca33abb342a264e4180aa5fbca4f">IOParamsBSE::tscale</a></div><div class="ttdeci">IOParams&lt; double &gt; tscale</div><div class="ttdef"><b>Definition:</b> bse_interface.h:660</div></div>
<div class="ttc" id="astructStatus_1_1ParticleCM_html_ad020c438a456b75785265885bcbc2764"><div class="ttname"><a href="structStatus_1_1ParticleCM.html#ad020c438a456b75785265885bcbc2764">Status::ParticleCM::mass</a></div><div class="ttdeci">PS::F64 mass</div><div class="ttdef"><b>Definition:</b> status.hpp:19</div></div>
<div class="ttc" id="astructCalcForceEpSpMonoNoSimd_html"><div class="ttname"><a href="structCalcForceEpSpMonoNoSimd.html">CalcForceEpSpMonoNoSimd</a></div><div class="ttdef"><b>Definition:</b> soft_force.hpp:125</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a507d84b4fa5c50014cc866316598bf7d"><div class="ttname"><a href="classIOParamsPeTar.html#a507d84b4fa5c50014cc866316598bf7d">IOParamsPeTar::search_peri_factor</a></div><div class="ttdeci">IOParams&lt; PS::F64 &gt; search_peri_factor</div><div class="ttdef"><b>Definition:</b> petar.hpp:114</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_aa2f8789b76d5bada88c85b82a14f92ad"><div class="ttname"><a href="classIOParamsPeTar.html#aa2f8789b76d5bada88c85b82a14f92ad">IOParamsPeTar::id_offset</a></div><div class="ttdeci">IOParams&lt; PS::S64 &gt; id_offset</div><div class="ttdef"><b>Definition:</b> petar.hpp:109</div></div>
<div class="ttc" id="aclassSystemHard_html_a988c41fbd9c555adbaa705d01be4fd86"><div class="ttname"><a href="classSystemHard.html#a988c41fbd9c555adbaa705d01be4fd86">SystemHard::driveForOneClusterOMP</a></div><div class="ttdeci">void driveForOneClusterOMP(const PS::F64 _dt)</div><div class="ttdoc">integrate one isolated particle</div><div class="ttdef"><b>Definition:</b> hard.hpp:2046</div></div>
<div class="ttc" id="anamespacePIKG_html_ab282ca14d7ee5e3f671ceba5ceff036f"><div class="ttname"><a href="namespacePIKG.html#ab282ca14d7ee5e3f671ceba5ceff036f">PIKG::U64</a></div><div class="ttdeci">uint64_t U64</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:20</div></div>
<div class="ttc" id="aclassSysCounts_html_a73663955d851be11aac6b22831bcf03f"><div class="ttname"><a href="classSysCounts.html#a73663955d851be11aac6b22831bcf03f">SysCounts::dump</a></div><div class="ttdeci">void dump(std::ostream &amp;fout, const PS::S64 n_loop=1, const PS::S32 width=PROFILE_PRINT_WIDTH) const</div><div class="ttdef"><b>Definition:</b> profile.hpp:513</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_a2312b0c004f47cf752a9c9321acf36eb"><div class="ttname"><a href="classIOParamsBSE.html#a2312b0c004f47cf752a9c9321acf36eb">IOParamsBSE::read</a></div><div class="ttdeci">int read(int argc, char *argv[], const int opt_used_pre=0)</div><div class="ttdoc">reading parameters from GNU option API</div><div class="ttdef"><b>Definition:</b> bse_interface.h:754</div></div>
<div class="ttc" id="astructHardEnergy_html"><div class="ttname"><a href="structHardEnergy.html">HardEnergy</a></div><div class="ttdef"><b>Definition:</b> hard.hpp:119</div></div>
<div class="ttc" id="aclassSearchCluster_html_a7f630465ce2f8ef5d5339c0383600f0e"><div class="ttname"><a href="classSearchCluster.html#a7f630465ce2f8ef5d5339c0383600f0e">SearchCluster::setIdClusterLocal</a></div><div class="ttdeci">void setIdClusterLocal()</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:677</div></div>
<div class="ttc" id="aclassHardManager_html_a51b15c2ff0aa0c7d18304d6c2926b89d"><div class="ttname"><a href="classHardManager.html#a51b15c2ff0aa0c7d18304d6c2926b89d">HardManager::n_step_per_orbit</a></div><div class="ttdeci">PS::F64 n_step_per_orbit</div><div class="ttdef"><b>Definition:</b> hard.hpp:32</div></div>
<div class="ttc" id="aclassStatus_html_a86a02e9495c972470f963cec6d9e5523"><div class="ttname"><a href="classStatus.html#a86a02e9495c972470f963cec6d9e5523">Status::printColumn</a></div><div class="ttdeci">void printColumn(std::ofstream &amp;_fout, const PS::S32 _width=20)</div><div class="ttdoc">print data of class members using column style</div><div class="ttdef"><b>Definition:</b> status.hpp:273</div></div>
<div class="ttc" id="aclassSearchCluster_html_af59d0bea5da0d1febd954774dc806e35"><div class="ttname"><a href="classSearchCluster.html#af59d0bea5da0d1febd954774dc806e35">SearchCluster::getAdrSysOneCluster</a></div><div class="ttdeci">const PS::ReallocatableArray&lt; PS::S32 &gt; &amp; getAdrSysOneCluster()</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:1371</div></div>
<div class="ttc" id="aclassSysProfile_html_a080ab81ebdc56f733efb7d544b2ca80a"><div class="ttname"><a href="classSysProfile.html#a080ab81ebdc56f733efb7d544b2ca80a">SysProfile::status</a></div><div class="ttdeci">Tprofile status</div><div class="ttdef"><b>Definition:</b> profile.hpp:329</div></div>
<div class="ttc" id="anamespacePIKG_html_acdce743393992cd4186218680bed1034"><div class="ttname"><a href="namespacePIKG.html#acdce743393992cd4186218680bed1034">PIKG::F32</a></div><div class="ttdeci">float F32</div><div class="ttdef"><b>Definition:</b> pikg_vector.hpp:18</div></div>
<div class="ttc" id="aclassSysCounts_html"><div class="ttname"><a href="classSysCounts.html">SysCounts</a></div><div class="ttdef"><b>Definition:</b> profile.hpp:418</div></div>
<div class="ttc" id="aclassGalpyManager_html_a60bef4e78023b1dc281e6cb2cffd813e"><div class="ttname"><a href="classGalpyManager.html#a60bef4e78023b1dc281e6cb2cffd813e">GalpyManager::calcMovePotAccFromPot</a></div><div class="ttdeci">void calcMovePotAccFromPot(const double _time, const double *pos_pcm)</div><div class="ttdoc">calculate acceleration for moving potentials from other potentials</div><div class="ttdef"><b>Definition:</b> galpy_interface.h:1543</div></div>
<div class="ttc" id="aclassSearchCluster_html_a4eed744c2ec88e42a522c2aea48adb14"><div class="ttname"><a href="classSearchCluster.html#a4eed744c2ec88e42a522c2aea48adb14">SearchCluster::searchNeighborOMP</a></div><div class="ttdeci">void searchNeighborOMP(Tsys &amp;sys, Ttree &amp;tree, const PS::F64ort pos_domain[], const PS::F64 _G, const PS::F64 _radius_factor)</div><div class="ttdoc">search neighbors and separate isolated and multiple clusters</div><div class="ttdef"><b>Definition:</b> cluster_list.hpp:425</div></div>
<div class="ttc" id="asoft__force_8hpp_html"><div class="ttname"><a href="soft__force_8hpp.html">soft_force.hpp</a></div></div>
<div class="ttc" id="aclassSysCounts_html_a7d89305dbd6bc59e3fbb81a3a7cce180"><div class="ttname"><a href="classSysCounts.html#a7d89305dbd6bc59e3fbb81a3a7cce180">SysCounts::n_neighbor_zero</a></div><div class="ttdeci">NumCounter n_neighbor_zero</div><div class="ttdef"><b>Definition:</b> profile.hpp:431</div></div>
<div class="ttc" id="aclassForceSoft_html_acbd19675019ce01e03779282bf9d2d5d"><div class="ttname"><a href="classForceSoft.html#acbd19675019ce01e03779282bf9d2d5d">ForceSoft::grav_const</a></div><div class="ttdeci">static PS::F64 grav_const</div><div class="ttdoc">neighbor number+1</div><div class="ttdef"><b>Definition:</b> soft_ptcl.hpp:15</div></div>
<div class="ttc" id="aclassSystemHard_html_a97c75b84d56fedcc0f9a1a3995839ce8"><div class="ttname"><a href="classSystemHard.html#a97c75b84d56fedcc0f9a1a3995839ce8">SystemHard::setPtclForConnectedCluster</a></div><div class="ttdeci">void setPtclForConnectedCluster(const Tsys &amp;sys, const PS::ReallocatableArray&lt; Tmediator &gt; &amp;med, const PS::ReallocatableArray&lt; Tptcl &gt; &amp;ptcl_recv)</div><div class="ttdef"><b>Definition:</b> hard.hpp:1861</div></div>
<div class="ttc" id="aclassKickDriftStep_html_a66510cbd00fe10a923aa1846f83f1451"><div class="ttname"><a href="classKickDriftStep.html#a66510cbd00fe10a923aa1846f83f1451">KickDriftStep::nextContinue</a></div><div class="ttdeci">void nextContinue()</div><div class="ttdoc">advance step count for continuing case</div><div class="ttdef"><b>Definition:</b> kickdriftstep.hpp:34</div></div>
<div class="ttc" id="aclassHardManager_html_accedec239afc4e94f6120b9fb7704860"><div class="ttname"><a href="classHardManager.html#accedec239afc4e94f6120b9fb7704860">HardManager::writeBinary</a></div><div class="ttdeci">void writeBinary(FILE *_fp)</div><div class="ttdoc">write class data to file with binary format</div><div class="ttdef"><b>Definition:</b> hard.hpp:83</div></div>
<div class="ttc" id="astructHardEnergy_html_a594c445cbea3b6d0d36a064d1192ba78"><div class="ttname"><a href="structHardEnergy.html#a594c445cbea3b6d0d36a064d1192ba78">HardEnergy::ekin_sd_correction</a></div><div class="ttdeci">PS::F64 ekin_sd_correction</div><div class="ttdef"><b>Definition:</b> hard.hpp:128</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ae91d35c9549296d4fbbe731d8052a9ca"><div class="ttname"><a href="classIOParamsPeTar.html#ae91d35c9549296d4fbbe731d8052a9ca">IOParamsPeTar::print_flag</a></div><div class="ttdeci">bool print_flag</div><div class="ttdef"><b>Definition:</b> petar.hpp:147</div></div>
<div class="ttc" id="aclassEnergyAndMomemtum_html_a74c80ca54c9d50ef10556756fda83a1c"><div class="ttname"><a href="classEnergyAndMomemtum.html#a74c80ca54c9d50ef10556756fda83a1c">EnergyAndMomemtum::epot</a></div><div class="ttdeci">PS::F64 epot</div><div class="ttdef"><b>Definition:</b> energy.hpp:8</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a330292acfdfdbc93da0e004ab2064e6e"><div class="ttname"><a href="classIOParamsPeTar.html#a330292acfdfdbc93da0e004ab2064e6e">IOParamsPeTar::update_changeover_flag</a></div><div class="ttdeci">bool update_changeover_flag</div><div class="ttdef"><b>Definition:</b> petar.hpp:148</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_ab66217edc5c61c8042703d986c4ef0a2"><div class="ttname"><a href="classIOParamsPeTar.html#ab66217edc5c61c8042703d986c4ef0a2">IOParamsPeTar::fname_snp</a></div><div class="ttdeci">IOParams&lt; std::string &gt; fname_snp</div><div class="ttdef"><b>Definition:</b> petar.hpp:142</div></div>
<div class="ttc" id="aclassSystemHard_html_a54fe61854b07e077f41c55e52af4035c"><div class="ttname"><a href="classSystemHard.html#a54fe61854b07e077f41c55e52af4035c">SystemHard::driveForMultiClusterOMP</a></div><div class="ttdeci">int driveForMultiClusterOMP(const PS::F64 dt, Tpsoft *_ptcl_soft)</div><div class="ttdoc">Hard integration for clusters.</div><div class="ttdef"><b>Definition:</b> hard.hpp:2271</div></div>
<div class="ttc" id="aclassSysCounts_html_a198f671859c262e76600266a55a2c94d"><div class="ttname"><a href="classSysCounts.html#a198f671859c262e76600266a55a2c94d">SysCounts::ARC_tsyn_step_sum</a></div><div class="ttdeci">NumCounter ARC_tsyn_step_sum</div><div class="ttdef"><b>Definition:</b> profile.hpp:427</div></div>
<div class="ttc" id="aclassIOParamsPeTar_html_a8690bbe36b86a830f7abe9ac01b05616"><div class="ttname"><a href="classIOParamsPeTar.html#a8690bbe36b86a830f7abe9ac01b05616">IOParamsPeTar::update_rsearch_flag</a></div><div class="ttdeci">bool update_rsearch_flag</div><div class="ttdef"><b>Definition:</b> petar.hpp:149</div></div>
<div class="ttc" id="aclassSysCounts_html_a3e957552c42bd1e0aca5ce6c61eece2d"><div class="ttname"><a href="classSysCounts.html#a3e957552c42bd1e0aca5ce6c61eece2d">SysCounts::ARC_n_groups</a></div><div class="ttdeci">NumCounter ARC_n_groups</div><div class="ttdef"><b>Definition:</b> profile.hpp:428</div></div>
<div class="ttc" id="astructTprofile_html_adf2963fc05a8ee2b066f919e8d3e4e68"><div class="ttname"><a href="structTprofile.html#adf2963fc05a8ee2b066f919e8d3e4e68">Tprofile::start</a></div><div class="ttdeci">void start()</div><div class="ttdef"><b>Definition:</b> profile.hpp:183</div></div>
<div class="ttc" id="aclassIOParamsBSE_html_a43e7ef9939837cab859bb7891e461d3d"><div class="ttname"><a href="classIOParamsBSE.html#a43e7ef9939837cab859bb7891e461d3d">IOParamsBSE::print_flag</a></div><div class="ttdeci">bool print_flag</div><div class="ttdef"><b>Definition:</b> bse_interface.h:666</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="petar_8hpp.html">petar.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
