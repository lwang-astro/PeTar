<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PeTar: phantomquad_for_p3t_k.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PeTar
   </div>
   <div id="projectbrief">N-body code for collisional gravitational systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('phantomquad__for__p3t__k_8hpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">phantomquad_for_p3t_k.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="phantomquad__for__p3t__k_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;v2r8.h&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#adf764cbdea00d65edcd07bb9953ad2b7ae2066853f08044a9b4acc927e48741a3">    4</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPhantomGrapeQuad.html">PhantomGrapeQuad</a>{</div>
<div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#adf764cbdea00d65edcd07bb9953ad2b7a8faaa83eafcea15a0bdc4687b15d360a">    5</a></span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    <span class="keyword">enum</span>{</div>
<div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">    7</a></span>&#160;        <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a> = 2048,</div>
<div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">    8</a></span>&#160;        <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a> = 262144,</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    };</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="keywordtype">double</span> xibuf  [<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>/2]  [4][2]; <span class="comment">// x, y, z, r_search</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordtype">double</span> accpbuf[<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>/2]  [5][2]; <span class="comment">// ax, ay, az, pot, nngb</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordtype">double</span> epjbuf [<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>]    [4];    <span class="comment">// x, y, z, m</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordtype">double</span> spjbuf [<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>]    [10];   <span class="comment">// x, y, z, m, xx, yy, xy, yz, zx, tr</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordtype">double</span> rsearchj[<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>];          <span class="comment">// r_search_j</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keywordtype">double</span> eps2;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordtype">double</span> r_crit2;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">double</span> r_out;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordtype">double</span> r_in;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">double</span> denominator;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    v2r8 v_r_out;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    v2r8 v_r_out_sq;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    v2r8 v_r_in;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    v2r8 v_r_in_sq;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    v2r8 v_denominator;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    v2r8 v_r_crit2;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    v2r8 v_zero;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    v2r8 v_one;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    v2r8 v_n20;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    v2r8 v_p70;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    v2r8 v_n84;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    v2r8 v_p35;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> get_a_NaN(){</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keyword">union</span>{ <span class="keywordtype">long</span>   l; <span class="keywordtype">double</span> d; } m;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        m.l = -1;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keywordflow">return</span> m.d;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a63c96c2d8474f8e2a6d8bddd7342675c">   44</a></span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">// default NaN</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a88473c2a65922d0b4fc5684269e815e5">   47</a></span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#a88473c2a65922d0b4fc5684269e815e5">PhantomGrapeQuad</a>() : eps2(get_a_NaN()) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        v_zero = _fjsp_set_v2r8(0.0, 0.0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        v_one  = _fjsp_set_v2r8(1.0, 1.0);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        v_n20 = _fjsp_set_v2r8(-20.0, -20.0);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        v_p70 = _fjsp_set_v2r8(70.0, 70.0);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        v_n84 = _fjsp_set_v2r8(-84.0, -84.0);</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#aca21a801b525bf254983df07a3cc3c6e">   53</a></span>&#160;        v_p35 = _fjsp_set_v2r8(35.0, 35.0);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    } </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a27280675f9fc272c3c4ece62e319097a">   56</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a27280675f9fc272c3c4ece62e319097a">set_eps2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _eps2){</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a673058ed3554c699ea8e67e641a38845">   57</a></span>&#160;        this-&gt;eps2 = _eps2;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a0a52434a193d7b3c7db20963a03762b6">   60</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a0a52434a193d7b3c7db20963a03762b6">set_r_crit2</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _r_crit2){</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        this-&gt;r_crit2 = _r_crit2;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a15647e9abefa5c8ed9b1a61975e6d583">   62</a></span>&#160;        v_r_crit2 = _fjsp_set_v2r8(r_crit2, r_crit2);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a7623464a19889be5b75a32bb02e8744b">   65</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a7623464a19889be5b75a32bb02e8744b">set_cutoff</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> _r_out, <span class="keyword">const</span> <span class="keywordtype">double</span> _r_in){</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        this-&gt;r_out = _r_out;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        this-&gt;r_in = _r_in;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        this-&gt;denominator = 1.0 / (r_out - r_in);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        v_r_out = _fjsp_set_v2r8(r_out, r_out);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        v_r_out_sq = _fjsp_set_v2r8(r_out*r_out, r_out*r_out);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        v_r_in =  _fjsp_set_v2r8(r_in, r_in);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        v_r_in_sq =  _fjsp_set_v2r8(r_in*r_in, r_in*r_in);</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#ac016cfa4853236af9ff145ff6e3bc949">   73</a></span>&#160;        v_denominator =  _fjsp_set_v2r8(denominator, denominator);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a7b9aab0edd6d54f10816b09b81a57166">   76</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a7b9aab0edd6d54f10816b09b81a57166">set_epj_one</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> addr, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> z, <span class="keyword">const</span> <span class="keywordtype">double</span> m, <span class="keyword">const</span> <span class="keywordtype">double</span> r_search) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        epjbuf[addr][0] = x;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        epjbuf[addr][1] = y;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        epjbuf[addr][2] = z;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        epjbuf[addr][3] = m;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        rsearchj[addr]  = r_search;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// please specialize the following</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#ad9d32f695f396ce0d233f80365b3f41d">   84</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> EPJ_t&gt;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a37b4068e0d3ce2de6783e3b4b00ae4be">set_epj</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nj, <span class="keyword">const</span> EPJ_t epj[]);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a71827ad91adb544c807c6d9da5b656b8">   87</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a71827ad91adb544c807c6d9da5b656b8">set_spj_one</a>(</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> addr, </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> x,   <span class="keyword">const</span> <span class="keywordtype">double</span> y,   <span class="keyword">const</span> <span class="keywordtype">double</span> z,   <span class="keyword">const</span> <span class="keywordtype">double</span> m,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> qxx, <span class="keyword">const</span> <span class="keywordtype">double</span> qyy, <span class="keyword">const</span> <span class="keywordtype">double</span> qzz,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> qxy, <span class="keyword">const</span> <span class="keywordtype">double</span> qyz, <span class="keyword">const</span> <span class="keywordtype">double</span> qzx)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> tr = qxx + qyy + qzz;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        spjbuf[addr][0] = x;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        spjbuf[addr][1] = y;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        spjbuf[addr][2] = z;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        spjbuf[addr][3] = m;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        spjbuf[addr][4] = 3.0 * qxx - tr;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        spjbuf[addr][5] = 3.0 * qyy - tr;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        spjbuf[addr][6] = 3.0 * qxy;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        spjbuf[addr][7] = 3.0 * qyz;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        spjbuf[addr][8] = 3.0 * qzx;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        spjbuf[addr][9] = -(eps2 * tr);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// please specialize the following</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#af81a37f2016b61afb30632a36e2b7a31">  106</a></span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> SPJ_t&gt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a990fb670fa631cd60579abd2f9698592">set_spj</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> nj, <span class="keyword">const</span> SPJ_t spj[]);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a166448ffe16034085c6ec5fac45b599d">  109</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a166448ffe16034085c6ec5fac45b599d">set_xi_one</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> addr, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y, <span class="keyword">const</span> <span class="keywordtype">double</span> z, <span class="keyword">const</span> <span class="keywordtype">double</span> r_search){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ah = addr / 2;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> al = addr % 2;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        xibuf[ah][0][al] = x;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        xibuf[ah][1][al] = y;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        xibuf[ah][2][al] = z;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        xibuf[ah][3][al] = r_search;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// please specialize the following</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> EPI_t&gt;</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a5ccaeaf0431f64222af150379706b0ef">  119</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#af692dd584d3240820f613b756899dd6c">set_xi</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> EPI_t spj[]);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real_t&gt;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#abe360e7a15d8925fbe353ee0de4800f6">  122</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#abe360e7a15d8925fbe353ee0de4800f6">get_accp_one</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot){</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ah = addr / 2;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> al = addr % 2;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        ax  = accpbuf[ah][0][al];</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        ay  = accpbuf[ah][1][al];</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        az  = accpbuf[ah][2][al];</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a4417819724f5302adbc0b2e9193337ba">  128</a></span>&#160;        pot = accpbuf[ah][3][al];</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real_t&gt;</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#ad3bada74be2fd462ad6bc7436a1a2aff">  131</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#ad3bada74be2fd462ad6bc7436a1a2aff">get_accp_one</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot, real_t &amp;nngb){</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ah = addr / 2;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> al = addr % 2;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        ax  = accpbuf[ah][0][al];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        ay  = accpbuf[ah][1][al];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        az  = accpbuf[ah][2][al];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        pot = accpbuf[ah][3][al];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        nngb = accpbuf[ah][4][al];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a08b1124d94251074bea8fa7a7fed98c1">  140</a></span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real_t&gt;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a41fb5578294c3ec07e10835246f53fbd">  143</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a41fb5578294c3ec07e10835246f53fbd">accum_accp_one</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot){</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ah = addr / 2;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> al = addr % 2;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        ax  += accpbuf[ah][0][al];</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        ay  += accpbuf[ah][1][al];</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        az  += accpbuf[ah][2][al];</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        pot += accpbuf[ah][3][al];</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#ad07c0874dcc66508fad11f3f666dd39b">  150</a></span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> real_t&gt;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#af36b8097b2442d3e4c4635cf765b8ef7">  153</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#af36b8097b2442d3e4c4635cf765b8ef7">accum_accp_one</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot, real_t &amp;nngb){</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> ah = addr / 2;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> al = addr % 2;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        ax  += accpbuf[ah][0][al];</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        ay  += accpbuf[ah][1][al];</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        az  += accpbuf[ah][2][al];</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        pot += accpbuf[ah][3][al];</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a87d71a41d7b77229822369cb589ece28">  160</a></span>&#160;        nngb += accpbuf[ah][4][al];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a68b135fe28235143061518be2cafbfee">  163</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a68b135fe28235143061518be2cafbfee">run_epj</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj){</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">if</span>(ni &gt; <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a> || nj &gt; <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>){</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;ni= &quot;</span>&lt;&lt;ni&lt;&lt;<span class="stringliteral">&quot; NIMAX= &quot;</span>&lt;&lt;<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>&lt;&lt;<span class="stringliteral">&quot; nj= &quot;</span>&lt;&lt;nj&lt;&lt;<span class="stringliteral">&quot; NJMAX= &quot;</span>&lt;&lt;<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        assert(ni &lt;= <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        assert(nj &lt;= <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="comment">// kernel_epj_nounroll(ni, nj);</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">// kernel_epj_unroll2(ni, nj);</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        kernel_epj_unroll4(ni, nj);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">/*    void run_epj_for_p3t(const int ni, const int nj){</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">        if(ni &gt; NIMAX || nj &gt; NJMAX){</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">            std::cout&lt;&lt;&quot;ni= &quot;&lt;&lt;ni&lt;&lt;&quot; NIMAX= &quot;&lt;&lt;NIMAX&lt;&lt;&quot; nj= &quot;&lt;&lt;nj&lt;&lt;&quot; NJMAX= &quot;&lt;&lt;NJMAX&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">        assert(ni &lt;= NIMAX);</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">        assert(nj &lt;= NJMAX);</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">        // kernel_epj_nounroll(ni, nj);</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">        // kernel_epj_unroll2(ni, nj);</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">        //kernel_epj_unroll4_for_p3t(ni, nj);</span></div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a40f50d061c72e0f8d0d0061b642a1a7f">  184</a></span>&#160;<span class="comment">        kernel_epj_unroll4_with_cutoff(ni, nj);</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#abec53e8037f39f3f628a9cb3c96672aa">  187</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#abec53e8037f39f3f628a9cb3c96672aa">run_epj_for_p3t_with_linear_cutoff</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj){</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span>(ni &gt; <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a> || nj &gt; <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>){</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;ni= &quot;</span>&lt;&lt;ni&lt;&lt;<span class="stringliteral">&quot; NIMAX= &quot;</span>&lt;&lt;<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>&lt;&lt;<span class="stringliteral">&quot; nj= &quot;</span>&lt;&lt;nj&lt;&lt;<span class="stringliteral">&quot; NJMAX= &quot;</span>&lt;&lt;<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        assert(ni &lt;= <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        assert(nj &lt;= <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="phantomquad__for__p3t__k_8hpp.html#a39df4690c14d04378f05ffbcbaa49f6f">  193</a></span>&#160;        kernel_epj_unroll4_for_p3t_with_linear_cutoff(ni, nj);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classPhantomGrapeQuad.html#a7a6ef2e89e218a5b2cbaa5e4e84acfeb">  196</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPhantomGrapeQuad.html#a7a6ef2e89e218a5b2cbaa5e4e84acfeb">run_spj</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj){</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span>(ni &gt; <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a> || nj &gt; <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>){</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            std::cout&lt;&lt;<span class="stringliteral">&quot;ni= &quot;</span>&lt;&lt;ni&lt;&lt;<span class="stringliteral">&quot; NIMAX= &quot;</span>&lt;&lt;<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>&lt;&lt;<span class="stringliteral">&quot; nj= &quot;</span>&lt;&lt;nj&lt;&lt;<span class="stringliteral">&quot; NJMAX= &quot;</span>&lt;&lt;<a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        assert(ni &lt;= <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">NIMAX</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        assert(nj &lt;= <a class="code" href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">NJMAX</a>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        kernel_spj_unroll4(ni, nj);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((always_inline))</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">void</span> inline_kernel_epj(</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keyword">const</span> v2r8 eps2,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keyword">const</span> v2r8 jp_xy,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keyword">const</span> v2r8 jp_zm,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="keyword">const</span> v2r8 xi,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="keyword">const</span> v2r8 yi,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keyword">const</span> v2r8 zi,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            v2r8 &amp;ax,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            v2r8 &amp;ay,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            v2r8 &amp;az,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            v2r8 &amp;pot)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keyword">const</span> v2r8_bcl xj(jp_xy);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keyword">const</span> v2r8_bch yj(jp_xy);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keyword">const</span> v2r8_bcl zj(jp_zm);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keyword">const</span> v2r8_bch mj(jp_zm);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">const</span> v2r8 dx = xj - xi;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keyword">const</span> v2r8 dy = yj - yi;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">const</span> v2r8 dz = zj - zi;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keyword">const</span> v2r8 r2   = ((eps2 + dx*dx) +  dy*dy) + dz*dz;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keyword">const</span> v2r8 ri1  = r2.rsqrta_x3();</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="comment">//const v2r8 ri1  = r2.rsqrta_x7();</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keyword">const</span> v2r8 ri2  = ri1  * ri1;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keyword">const</span> v2r8 mri1 = mj   * ri1;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keyword">const</span> v2r8 mri3 = mri1 * ri2;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        pot = mj.nmsub(ri1, pot);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        ax += mri3 * dx;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        ay += mri3 * dy;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        az += mri3 * dz;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((always_inline))</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordtype">void</span> inline_kernel_epj_for_p3t(<span class="keyword">const</span> v2r8 eps2,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                   <span class="keyword">const</span> v2r8 r_crit2,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                   <span class="keyword">const</span> v2r8 jp_xy,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                   <span class="keyword">const</span> v2r8 jp_zm,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                   <span class="keyword">const</span> v2r8 xi,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                   <span class="keyword">const</span> v2r8 yi,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                   <span class="keyword">const</span> v2r8 zi,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                   v2r8 &amp;ax,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                   v2r8 &amp;ay,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                   v2r8 &amp;az,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                   v2r8 &amp;pot,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                   v2r8 &amp;nngb){</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">const</span> v2r8_bcl xj(jp_xy);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keyword">const</span> v2r8_bch yj(jp_xy);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">const</span> v2r8_bcl zj(jp_zm);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">const</span> v2r8_bch mj(jp_zm);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">const</span> v2r8 dx = xj - xi;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keyword">const</span> v2r8 dy = yj - yi;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keyword">const</span> v2r8 dz = zj - zi;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keyword">const</span> v2r8 r2   = ((eps2 + dx*dx) +  dy*dy) + dz*dz;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keyword">const</span> v2r8_mask mask = r_crit2 &lt; r2;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keyword">const</span> v2r8 ri1  = r2.rsqrta_x3() &amp; mask;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">//const v2r8 ri1  = r2.rsqrta_x7() &amp; mask;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <span class="keyword">const</span> v2r8 ri2  = ri1  * ri1;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keyword">const</span> v2r8 mri1 = mj   * ri1;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keyword">const</span> v2r8 mri3 = mri1 * ri2;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        pot = mj.nmsub(ri1, pot);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        ax += mri3 * dx;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        ay += mri3 * dy;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        az += mri3 * dz;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        nngb += _fjsp_andnot1_v2r8( mask.val, v2r8(1.0) );</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((always_inline))</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordtype">void</span> inline_kernel_epj_for_p3t_with_linear_cutoff(<span class="keyword">const</span> v2r8 eps2,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                                      v2r8 &amp;rsj,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                      <span class="keyword">const</span> v2r8 jp_xy,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                      <span class="keyword">const</span> v2r8 jp_zm,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                                                      <span class="keyword">const</span> v2r8 xi,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                      <span class="keyword">const</span> v2r8 yi,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                                      <span class="keyword">const</span> v2r8 zi,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                      v2r8 &amp;rsi,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                                                      v2r8 &amp;ax,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                                      v2r8 &amp;ay,</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                                      v2r8 &amp;az,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                      v2r8 &amp;pot,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                                      v2r8 &amp;nngb){</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keyword">const</span> v2r8_bcl xj(jp_xy);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keyword">const</span> v2r8_bch yj(jp_xy);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keyword">const</span> v2r8_bcl zj(jp_zm);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keyword">const</span> v2r8_bch mj(jp_zm);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keyword">const</span> v2r8 dx = xj - xi;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keyword">const</span> v2r8 dy = yj - yi;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keyword">const</span> v2r8 dz = zj - zi;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        v2r8 r2_real   = ((eps2 + dx*dx) +  dy*dy) + dz*dz;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keyword">const</span> v2r8 r2 = _fjsp_max_v2r8(r2_real, v_r_crit2);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keyword">const</span> v2r8 ri1  = r2.rsqrta_x3();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">//const v2r8 ri1  = r2.rsqrta_x7();</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keyword">const</span> v2r8 ri2  = ri1  * ri1;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keyword">const</span> v2r8 mri1 = mj   * ri1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keyword">const</span> v2r8 mri3 = mri1 * ri2;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        pot = mj.nmsub(ri1, pot);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        ax += mri3 * dx;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        ay += mri3 * dy;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        az += mri3 * dz;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        v2r8 r_crit = _fjsp_max_v2r8(rsi, rsj);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keyword">const</span> v2r8 r_crit2= r_crit*r_crit;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keyword">const</span> v2r8_mask mask = r_crit2 &lt; r2;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        nngb += _fjsp_andnot1_v2r8( mask.val, v2r8(1.0) );</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((always_inline))</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">void</span> inline_kernel_epj_with_cutoff(<span class="keyword">const</span> v2r8 eps2,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                       <span class="keyword">const</span> v2r8 r_crit2,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                       <span class="keyword">const</span> v2r8 jp_xy,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                       <span class="keyword">const</span> v2r8 jp_zm,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                       <span class="keyword">const</span> v2r8 xi,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                       <span class="keyword">const</span> v2r8 yi,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                       <span class="keyword">const</span> v2r8 zi,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                       v2r8 &amp;ax,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                       v2r8 &amp;ay,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                       v2r8 &amp;az,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                       v2r8 &amp;pot,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                       v2r8 &amp;nngb){</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keyword">const</span> v2r8_bcl xj(jp_xy);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keyword">const</span> v2r8_bch yj(jp_xy);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keyword">const</span> v2r8_bcl zj(jp_zm);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keyword">const</span> v2r8_bch mj(jp_zm);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="keyword">const</span> v2r8 dx = xj - xi;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keyword">const</span> v2r8 dy = yj - yi;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keyword">const</span> v2r8 dz = zj - zi;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        v2r8 r2   = ((eps2 + dx*dx) +  dy*dy) + dz*dz;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">//const v2r8_mask mask = r_crit2 &lt; r2;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">//v2r8_mask mask = v_r_in_sq &lt; r2;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        r2 = _fjsp_max_v2r8(r2, v_r_in_sq);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#ifdef RSQRT_NR_EPJ_X7</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keyword">const</span> v2r8 ri1  = r2.rsqrta_x7();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">//const v2r8 ri1  = r2.rsqrta_x7() &amp; mask;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keyword">const</span> v2r8 ri1  = r2.rsqrta_x3();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">//const v2r8 ri1  = r2.rsqrta_x3() &amp; mask;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#if 1</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keyword">const</span> v2r8 r1 = r2 * ri1;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keyword">const</span> v2r8 x = _fjsp_min_v2r8( _fjsp_max_v2r8( ((r1-v_r_in)*v_denominator), v_zero), v_one);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keyword">const</span> v2r8 x2 = x * x;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="keyword">const</span> v2r8 x4 = x2 * x2;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keyword">const</span> v2r8 k = (((v_n20*x + v_p70)*x + v_n84)*x + v_p35)*x4 ;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keyword">const</span> v2r8 mkri1 = mj * k * ri1;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keyword">const</span> v2r8 ri2  = ri1 * ri1;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keyword">const</span> v2r8 mkri3 = mkri1 * ri2;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">//const v2r8 ri2  = ri1  * ri1;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">//const v2r8 mri1 = mj   * ri1;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="comment">//const v2r8 mri3 = mri1 * ri2;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="comment">//pot = mj.nmsub(ri1, pot);</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        pot -= mkri1;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        ax += mkri3 * dx;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        ay += mkri3 * dy;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        az += mkri3 * dz;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        v2r8_mask mask = r2 &lt; r_crit2;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        nngb += _fjsp_and_v2r8( mask.val, v_one );</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">//nngb += _fjsp_andnot1_v2r8( mask.val, v_one );</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">//#if 0</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">//    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">//    void kernel_epj_nounroll(const int ni, const int nj){</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">//      for(int i=0; i&lt;ni; i+=2){</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">//          const v2r8 xi = v2r8::load(xibuf[i/2][0]);</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">//          const v2r8 yi = v2r8::load(xibuf[i/2][1]);</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">//          const v2r8 zi = v2r8::load(xibuf[i/2][2]);</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">//          const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">//          v2r8 ax(0.0);</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">//          v2r8 ay(0.0);</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">//          v2r8 az(0.0);</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">//          v2r8 po(0.0);</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">//          for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">//              const v2r8 jp_xy = v2r8::load(epjbuf[j] + 0);</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">//              const v2r8 jp_zm = v2r8::load(epjbuf[j] + 2);</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">//              inline_kernel_epj(veps2, jp_xy, jp_zm, xi, yi, zi, ax, ay, az, po);</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">//          ax.store(accpbuf[i/2][0]);</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">//          ay.store(accpbuf[i/2][1]);</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">//          az.store(accpbuf[i/2][2]);</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">//          po.store(accpbuf[i/2][3]);</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">//#if 0</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">//    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">//    void kernel_epj_unroll2(const int ni, const int nj){</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">//      for(int i=0; i&lt;ni; i+=4){</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">//          const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">//          const v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">//          const v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">//          const v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//          const v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">//          const v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">//          const v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">//          v2r8 ax0(0.0);</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">//          v2r8 ay0(0.0);</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">//          v2r8 az0(0.0);</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">//          v2r8 po0(0.0);</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">//          v2r8 ax1(0.0);</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">//          v2r8 ay1(0.0);</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">//          v2r8 az1(0.0);</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">//          v2r8 po1(0.0);</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">//          for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">//              const v2r8 jp_xy = v2r8::load(epjbuf[j] + 0);</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">//              const v2r8 jp_zm = v2r8::load(epjbuf[j] + 2);</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">//              inline_kernel_epj(veps2, jp_xy, jp_zm, xi0, yi0, zi0, ax0, ay0, az0, po0);</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">//              inline_kernel_epj(veps2, jp_xy, jp_zm, xi1, yi1, zi1, ax1, ay1, az1, po1);</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">//          ax0.store(accpbuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">//          ay0.store(accpbuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">//          az0.store(accpbuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">//          po0.store(accpbuf[0 + i/2][3]);</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">//          ax1.store(accpbuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">//          ay1.store(accpbuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">//          az1.store(accpbuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">//          po1.store(accpbuf[1 + i/2][3]);</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((noinline))</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">void</span> kernel_epj_unroll4(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj){</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;ni; i+=8){</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keyword">const</span> v2r8 veps2 = v2r8(eps2);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keyword">const</span> v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <span class="keyword">const</span> v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keyword">const</span> v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            <span class="keyword">const</span> v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <span class="keyword">const</span> v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <span class="keyword">const</span> v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="keyword">const</span> v2r8 xi2 = v2r8::load(xibuf[2 + i/2][0]);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keyword">const</span> v2r8 yi2 = v2r8::load(xibuf[2 + i/2][1]);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <span class="keyword">const</span> v2r8 zi2 = v2r8::load(xibuf[2 + i/2][2]);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keyword">const</span> v2r8 xi3 = v2r8::load(xibuf[3 + i/2][0]);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            <span class="keyword">const</span> v2r8 yi3 = v2r8::load(xibuf[3 + i/2][1]);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keyword">const</span> v2r8 zi3 = v2r8::load(xibuf[3 + i/2][2]);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            v2r8 ax0(0.0);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            v2r8 ay0(0.0);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            v2r8 az0(0.0);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            v2r8 po0(0.0);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            v2r8 ax1(0.0);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            v2r8 ay1(0.0);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            v2r8 az1(0.0);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            v2r8 po1(0.0);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            v2r8 ax2(0.0);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            v2r8 ay2(0.0);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            v2r8 az2(0.0);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            v2r8 po2(0.0);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            v2r8 ax3(0.0);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            v2r8 ay3(0.0);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            v2r8 az3(0.0);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            v2r8 po3(0.0);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nj; j++){</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keyword">const</span> v2r8 jp_xy = v2r8::load(epjbuf[j] + 0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                <span class="keyword">const</span> v2r8 jp_zm = v2r8::load(epjbuf[j] + 2);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                inline_kernel_epj(veps2, jp_xy, jp_zm, xi0, yi0, zi0, ax0, ay0, az0, po0);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                inline_kernel_epj(veps2, jp_xy, jp_zm, xi1, yi1, zi1, ax1, ay1, az1, po1);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                inline_kernel_epj(veps2, jp_xy, jp_zm, xi2, yi2, zi2, ax2, ay2, az2, po2);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                inline_kernel_epj(veps2, jp_xy, jp_zm, xi3, yi3, zi3, ax3, ay3, az3, po3);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            }</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            ax0.store(accpbuf[0 + i/2][0]);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            ay0.store(accpbuf[0 + i/2][1]);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            az0.store(accpbuf[0 + i/2][2]);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            po0.store(accpbuf[0 + i/2][3]);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            ax1.store(accpbuf[1 + i/2][0]);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            ay1.store(accpbuf[1 + i/2][1]);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            az1.store(accpbuf[1 + i/2][2]);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            po1.store(accpbuf[1 + i/2][3]);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            ax2.store(accpbuf[2 + i/2][0]);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            ay2.store(accpbuf[2 + i/2][1]);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            az2.store(accpbuf[2 + i/2][2]);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            po2.store(accpbuf[2 + i/2][3]);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            ax3.store(accpbuf[3 + i/2][0]);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            ay3.store(accpbuf[3 + i/2][1]);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            az3.store(accpbuf[3 + i/2][2]);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            po3.store(accpbuf[3 + i/2][3]);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">/*    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">    void kernel_epj_unroll4_for_p3t(const int ni, const int nj){</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">        for(int i=0; i&lt;ni; i+=8){</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">            const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">            //const v2r8 vrcrit2 = v2r8(r_crit2);</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">            const v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">            const v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">            const v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">            const v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">            const v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">            const v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">            const v2r8 xi2 = v2r8::load(xibuf[2 + i/2][0]);</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">            const v2r8 yi2 = v2r8::load(xibuf[2 + i/2][1]);</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">            const v2r8 zi2 = v2r8::load(xibuf[2 + i/2][2]);</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">            const v2r8 xi3 = v2r8::load(xibuf[3 + i/2][0]);</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">            const v2r8 yi3 = v2r8::load(xibuf[3 + i/2][1]);</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">            const v2r8 zi3 = v2r8::load(xibuf[3 + i/2][2]);</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">            v2r8 ax0(0.0);</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">            v2r8 ay0(0.0);</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">            v2r8 az0(0.0);</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">            v2r8 po0(0.0);</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">            v2r8 nngb0(0.0);</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">            v2r8 ax1(0.0);</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">            v2r8 ay1(0.0);</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">            v2r8 az1(0.0);</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">            v2r8 po1(0.0);</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">            v2r8 nngb1(0.0);</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">            v2r8 ax2(0.0);</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">            v2r8 ay2(0.0);</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">            v2r8 az2(0.0);</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">            v2r8 po2(0.0);</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">            v2r8 nngb2(0.0);</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">            v2r8 ax3(0.0);</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">            v2r8 ay3(0.0);</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">            v2r8 az3(0.0);</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">            v2r8 po3(0.0);</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">            v2r8 nngb3(0.0);</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">            for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">                const v2r8 jp_xy = v2r8::load(epjbuf[j] + 0);</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">                const v2r8 jp_zm = v2r8::load(epjbuf[j] + 2);</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">                inline_kernel_epj_for_p3t(veps2, vrcrit2, jp_xy, jp_zm, xi0, yi0, zi0, ax0, ay0, az0, po0, nngb0);</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">                inline_kernel_epj_for_p3t(veps2, vrcrit2, jp_xy, jp_zm, xi1, yi1, zi1, ax1, ay1, az1, po1, nngb1);</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">                inline_kernel_epj_for_p3t(veps2, vrcrit2, jp_xy, jp_zm, xi2, yi2, zi2, ax2, ay2, az2, po2, nngb2);</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">                inline_kernel_epj_for_p3t(veps2, vrcrit2, jp_xy, jp_zm, xi3, yi3, zi3, ax3, ay3, az3, po3, nngb3);</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">            ax0.store(accpbuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">            ay0.store(accpbuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">            az0.store(accpbuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">            po0.store(accpbuf[0 + i/2][3]);</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">            nngb0.store(accpbuf[0 + i/2][4]);</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">            ax1.store(accpbuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">            ay1.store(accpbuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">            az1.store(accpbuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">            po1.store(accpbuf[1 + i/2][3]);</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">            nngb1.store(accpbuf[1 + i/2][4]);</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">            ax2.store(accpbuf[2 + i/2][0]);</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">            ay2.store(accpbuf[2 + i/2][1]);</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">            az2.store(accpbuf[2 + i/2][2]);</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">            po2.store(accpbuf[2 + i/2][3]);</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">            nngb2.store(accpbuf[2 + i/2][4]);</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">            ax3.store(accpbuf[3 + i/2][0]);</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">            ay3.store(accpbuf[3 + i/2][1]);</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">            az3.store(accpbuf[3 + i/2][2]);</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">            po3.store(accpbuf[3 + i/2][3]);</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">            nngb3.store(accpbuf[3 + i/2][4]);</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((noinline))</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="keywordtype">void</span> kernel_epj_unroll4_for_p3t_with_linear_cutoff(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj){</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;ni; i+=8){</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keyword">const</span> v2r8 veps2 = v2r8(eps2);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keyword">const</span> v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;            <span class="keyword">const</span> v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keyword">const</span> v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;            v2r8 rs0 = v2r8::load(xibuf[0 + i/2][3]);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;            <span class="keyword">const</span> v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="keyword">const</span> v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <span class="keyword">const</span> v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            v2r8 rs1 = v2r8::load(xibuf[1 + i/2][3]);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keyword">const</span> v2r8 xi2 = v2r8::load(xibuf[2 + i/2][0]);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keyword">const</span> v2r8 yi2 = v2r8::load(xibuf[2 + i/2][1]);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <span class="keyword">const</span> v2r8 zi2 = v2r8::load(xibuf[2 + i/2][2]);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;            v2r8 rs2 = v2r8::load(xibuf[2 + i/2][3]);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keyword">const</span> v2r8 xi3 = v2r8::load(xibuf[3 + i/2][0]);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keyword">const</span> v2r8 yi3 = v2r8::load(xibuf[3 + i/2][1]);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keyword">const</span> v2r8 zi3 = v2r8::load(xibuf[3 + i/2][2]);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            v2r8 rs3 = v2r8::load(xibuf[3 + i/2][3]);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            v2r8 ax0(0.0);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            v2r8 ay0(0.0);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            v2r8 az0(0.0);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            v2r8 po0(0.0);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            v2r8 nngb0(0.0);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            v2r8 ax1(0.0);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            v2r8 ay1(0.0);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            v2r8 az1(0.0);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            v2r8 po1(0.0);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            v2r8 nngb1(0.0);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            v2r8 ax2(0.0);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            v2r8 ay2(0.0);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            v2r8 az2(0.0);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            v2r8 po2(0.0);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            v2r8 nngb2(0.0);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            v2r8 ax3(0.0);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            v2r8 ay3(0.0);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            v2r8 az3(0.0);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            v2r8 po3(0.0);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            v2r8 nngb3(0.0);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nj; j++){</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                <span class="keyword">const</span> v2r8 jp_xy = v2r8::load(epjbuf[j] + 0);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keyword">const</span> v2r8 jp_zm = v2r8::load(epjbuf[j] + 2);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                v2r8 rsjp  =  __builtin_fj_set_v2r8(rsearchj[j], rsearchj[j]);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                inline_kernel_epj_for_p3t_with_linear_cutoff(veps2, rsjp, jp_xy, jp_zm, xi0, yi0, zi0, rs0, ax0, ay0, az0, po0, nngb0);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                inline_kernel_epj_for_p3t_with_linear_cutoff(veps2, rsjp, jp_xy, jp_zm, xi1, yi1, zi1, rs1, ax1, ay1, az1, po1, nngb1);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                inline_kernel_epj_for_p3t_with_linear_cutoff(veps2, rsjp, jp_xy, jp_zm, xi2, yi2, zi2, rs2, ax2, ay2, az2, po2, nngb2);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                inline_kernel_epj_for_p3t_with_linear_cutoff(veps2, rsjp, jp_xy, jp_zm, xi3, yi3, zi3, rs3, ax3, ay3, az3, po3, nngb3);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            ax0.store(accpbuf[0 + i/2][0]);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            ay0.store(accpbuf[0 + i/2][1]);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            az0.store(accpbuf[0 + i/2][2]);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            po0.store(accpbuf[0 + i/2][3]);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            nngb0.store(accpbuf[0 + i/2][4]);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            ax1.store(accpbuf[1 + i/2][0]);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            ay1.store(accpbuf[1 + i/2][1]);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            az1.store(accpbuf[1 + i/2][2]);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            po1.store(accpbuf[1 + i/2][3]);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            nngb1.store(accpbuf[1 + i/2][4]);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            ax2.store(accpbuf[2 + i/2][0]);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            ay2.store(accpbuf[2 + i/2][1]);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            az2.store(accpbuf[2 + i/2][2]);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            po2.store(accpbuf[2 + i/2][3]);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            nngb2.store(accpbuf[2 + i/2][4]);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            ax3.store(accpbuf[3 + i/2][0]);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            ay3.store(accpbuf[3 + i/2][1]);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            az3.store(accpbuf[3 + i/2][2]);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;            po3.store(accpbuf[3 + i/2][3]);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            nngb3.store(accpbuf[3 + i/2][4]);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160; </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <span class="comment">/*    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">    void kernel_epj_unroll4_with_cutoff(const int ni, const int nj){</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">        for(int i=0; i&lt;ni; i+=8){</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">            const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">            const v2r8 vrcrit2 = v2r8(r_crit2);</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">            const v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">            const v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">            const v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">            const v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">            const v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">            const v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">            const v2r8 xi2 = v2r8::load(xibuf[2 + i/2][0]);</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">            const v2r8 yi2 = v2r8::load(xibuf[2 + i/2][1]);</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">            const v2r8 zi2 = v2r8::load(xibuf[2 + i/2][2]);</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">            const v2r8 xi3 = v2r8::load(xibuf[3 + i/2][0]);</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">            const v2r8 yi3 = v2r8::load(xibuf[3 + i/2][1]);</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">            const v2r8 zi3 = v2r8::load(xibuf[3 + i/2][2]);</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">            v2r8 ax0(0.0);</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">            v2r8 ay0(0.0);</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="comment">            v2r8 az0(0.0);</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">            v2r8 po0(0.0);</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">            v2r8 nngb0(0.0);</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">            v2r8 ax1(0.0);</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="comment">            v2r8 ay1(0.0);</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">            v2r8 az1(0.0);</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">            v2r8 po1(0.0);</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">            v2r8 nngb1(0.0);</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">            v2r8 ax2(0.0);</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">            v2r8 ay2(0.0);</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">            v2r8 az2(0.0);</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">            v2r8 po2(0.0);</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">            v2r8 nngb2(0.0);</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">            v2r8 ax3(0.0);</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">            v2r8 ay3(0.0);</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">            v2r8 az3(0.0);</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">            v2r8 po3(0.0);</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment">            v2r8 nngb3(0.0);</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">            for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">                const v2r8 jp_xy = v2r8::load(epjbuf[j] + 0);</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">                const v2r8 jp_zm = v2r8::load(epjbuf[j] + 2);</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">                inline_kernel_epj_with_cutoff(veps2, vrcrit2, jp_xy, jp_zm, xi0, yi0, zi0, ax0, ay0, az0, po0, nngb0);</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">                inline_kernel_epj_with_cutoff(veps2, vrcrit2, jp_xy, jp_zm, xi1, yi1, zi1, ax1, ay1, az1, po1, nngb1);</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">                inline_kernel_epj_with_cutoff(veps2, vrcrit2, jp_xy, jp_zm, xi2, yi2, zi2, ax2, ay2, az2, po2, nngb2);</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">                inline_kernel_epj_with_cutoff(veps2, vrcrit2, jp_xy, jp_zm, xi3, yi3, zi3, ax3, ay3, az3, po3, nngb3);</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">            }</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">            ax0.store(accpbuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">            ay0.store(accpbuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">            az0.store(accpbuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">            po0.store(accpbuf[0 + i/2][3]);</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">            nngb0.store(accpbuf[0 + i/2][4]);</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">            ax1.store(accpbuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">            ay1.store(accpbuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">            az1.store(accpbuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">            po1.store(accpbuf[1 + i/2][3]);</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">            nngb1.store(accpbuf[1 + i/2][4]);</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">            ax2.store(accpbuf[2 + i/2][0]);</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">            ay2.store(accpbuf[2 + i/2][1]);</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">            az2.store(accpbuf[2 + i/2][2]);</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">            po2.store(accpbuf[2 + i/2][3]);</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">            nngb2.store(accpbuf[2 + i/2][4]);</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">            ax3.store(accpbuf[3 + i/2][0]);</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">            ay3.store(accpbuf[3 + i/2][1]);</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">            az3.store(accpbuf[3 + i/2][2]);</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment">            po3.store(accpbuf[3 + i/2][3]);</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment">            nngb3.store(accpbuf[3 + i/2][4]);</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((always_inline))</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordtype">void</span> inline_kernel_spj(</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;            <span class="keyword">const</span> v2r8 eps2,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            <span class="keyword">const</span> v2r8 jp_xy,</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keyword">const</span> v2r8 jp_zm,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            <span class="keyword">const</span> v2r8 jp_xx_yy,</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keyword">const</span> v2r8 jp_xy_yz,</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keyword">const</span> v2r8 jp_zx_tr,</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            <span class="keyword">const</span> v2r8 xi,</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            <span class="keyword">const</span> v2r8 yi,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keyword">const</span> v2r8 zi,</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            v2r8 &amp;ax,</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            v2r8 &amp;ay,</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            v2r8 &amp;az,</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            v2r8 &amp;pot)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keyword">const</span> v2r8_bcl xj(jp_xy);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keyword">const</span> v2r8_bch yj(jp_xy);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keyword">const</span> v2r8_bcl zj(jp_zm);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keyword">const</span> v2r8 dx = xj - xi;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keyword">const</span> v2r8 dy = yj - yi;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keyword">const</span> v2r8 dz = zj - zi;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keyword">const</span> v2r8 r2   = ((eps2 + dx*dx) +  dy*dy) + dz*dz;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keyword">const</span> v2r8 ri1  = r2.rsqrta_x3();</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        <span class="keyword">const</span> v2r8 ri2  = ri1  * ri1;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keyword">const</span> v2r8 ri3  = ri1  * ri2;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="keyword">const</span> v2r8 ri4  = ri2  * ri2;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keyword">const</span> v2r8 ri5  = ri2  * ri3;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keyword">const</span> v2r8_bcl q_xx(jp_xx_yy);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keyword">const</span> v2r8_bch q_yy(jp_xx_yy);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="keyword">const</span> v2r8     q_zz = jp_xx_yy.hadd();  <span class="comment">// -q_zz = q_xx + q_yy</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keyword">const</span> v2r8_bcl q_xy(jp_xy_yz);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keyword">const</span> v2r8_bch q_yz(jp_xy_yz);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keyword">const</span> v2r8_bcl q_zx(jp_zx_tr);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keyword">const</span> v2r8 q_tr = v2r8::unpckh(jp_zx_tr, jp_zx_tr); <span class="comment">// -eps2 * tr(q)</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keyword">const</span> v2r8 mj  = v2r8::unpckh(jp_zm, jp_zm);</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        v2r8 qr_x = q_xx * dx;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        qr_x = q_xy.madd(dy, qr_x);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        qr_x = q_zx.madd(dz, qr_x);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        v2r8 qr_y = q_xy * dx;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        qr_y = q_yy.madd(dy, qr_y);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        qr_y = q_yz.madd(dz, qr_y);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        v2r8 qr_z = q_zx * dx;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        qr_z = q_yz.madd(dy, qr_z);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        qr_z = qr_z - q_zz * dz;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        ax = v2r8::nmsub(ri5, qr_x, ax);</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        ay = v2r8::nmsub(ri5, qr_y, ay);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        az = v2r8::nmsub(ri5, qr_z, az);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="keyword">const</span> v2r8 rqr = ((q_tr + qr_x*dx) + qr_y*dy) + qr_z*dz;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keyword">const</span> v2r8 rqr_ri4 = rqr * ri4;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160; </div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keyword">const</span> v2r8 cc(0.5, 2.5);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keyword">const</span> v2r8 madd05 = v2r8_bcl(cc).madd(rqr_ri4, mj);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keyword">const</span> v2r8 madd25 = v2r8_bch(cc).madd(rqr_ri4, mj) * ri3;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        pot -= madd05 * ri1;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        ax = v2r8::madd(madd25, dx, ax);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        ay = v2r8::madd(madd25, dy, ay);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        az = v2r8::madd(madd25, dz, az);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">//#if 0</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">//    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="comment">//    void kernel_spj_nounroll(const int ni, const int nj){</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">//      for(int i=0; i&lt;ni; i+=2){</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">//          const v2r8 xi = v2r8::load(xibuf[i/2][0]);</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="comment">//          const v2r8 yi = v2r8::load(xibuf[i/2][1]);</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="comment">//          const v2r8 zi = v2r8::load(xibuf[i/2][2]);</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="comment">//          const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">//          v2r8 ax(0.0);</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment">//          v2r8 ay(0.0);</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">//          v2r8 az(0.0);</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment">//          v2r8 po(0.0);</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">//          for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">//              const v2r8 jp_xy    = v2r8::load(spjbuf[j] + 0);</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">//              const v2r8 jp_zm    = v2r8::load(spjbuf[j] + 2);</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">//              const v2r8 jp_xx_yy = v2r8::load(spjbuf[j] + 4);</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">//              const v2r8 jp_xy_yz = v2r8::load(spjbuf[j] + 6);</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment">//              const v2r8 jp_zx_tr = v2r8::load(spjbuf[j] + 8);</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi, yi, zi, ax, ay, az, po);</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="comment">//          ax.store(accpbuf[i/2][0]);</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="comment">//          ay.store(accpbuf[i/2][1]);</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment">//          az.store(accpbuf[i/2][2]);</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="comment">//          po.store(accpbuf[i/2][3]);</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="comment">//#if 0</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="comment">//    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="comment">//    void kernel_spj_unroll2(const int ni, const int nj){</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="comment">//      for(int i=0; i&lt;ni; i+=4){</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">//          const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="comment">//          const v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment">//          const v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">//          const v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment">//          const v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">//          const v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">//          const v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment">//          v2r8 ax0(0.0);</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">//          v2r8 ay0(0.0);</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">//          v2r8 az0(0.0);</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="comment">//          v2r8 po0(0.0);</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="comment">//          v2r8 ax1(0.0);</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="comment">//          v2r8 ay1(0.0);</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="comment">//          v2r8 az1(0.0);</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="comment">//          v2r8 po1(0.0);</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">//          for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">//              const v2r8 jp_xy    = v2r8::load(spjbuf[j] + 0);</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="comment">//              const v2r8 jp_zm    = v2r8::load(spjbuf[j] + 2);</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="comment">//              const v2r8 jp_xx_yy = v2r8::load(spjbuf[j] + 4);</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="comment">//              const v2r8 jp_xy_yz = v2r8::load(spjbuf[j] + 6);</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="comment">//              const v2r8 jp_zx_tr = v2r8::load(spjbuf[j] + 8);</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi0, yi0, zi0, ax0, ay0, az0, po0);</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi1, yi1, zi1, ax1, ay1, az1, po1);</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">//          ax0.store(accpbuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">//          ay0.store(accpbuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">//          az0.store(accpbuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">//          po0.store(accpbuf[0 + i/2][3]);</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="comment">//          ax1.store(accpbuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">//          ay1.store(accpbuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">//          az1.store(accpbuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="comment">//          po1.store(accpbuf[1 + i/2][3]);</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">__attribute__</a> ((noinline))</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordtype">void</span> kernel_spj_unroll4(<span class="keyword">const</span> <span class="keywordtype">int</span> ni, <span class="keyword">const</span> <span class="keywordtype">int</span> nj){</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;ni; i+=8){</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            <span class="keyword">const</span> v2r8 veps2 = v2r8(eps2);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <span class="keyword">const</span> v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="keyword">const</span> v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keyword">const</span> v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <span class="keyword">const</span> v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            <span class="keyword">const</span> v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keyword">const</span> v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keyword">const</span> v2r8 xi2 = v2r8::load(xibuf[2 + i/2][0]);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;            <span class="keyword">const</span> v2r8 yi2 = v2r8::load(xibuf[2 + i/2][1]);</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="keyword">const</span> v2r8 zi2 = v2r8::load(xibuf[2 + i/2][2]);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keyword">const</span> v2r8 xi3 = v2r8::load(xibuf[3 + i/2][0]);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="keyword">const</span> v2r8 yi3 = v2r8::load(xibuf[3 + i/2][1]);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keyword">const</span> v2r8 zi3 = v2r8::load(xibuf[3 + i/2][2]);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            v2r8 ax0(0.0);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            v2r8 ay0(0.0);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            v2r8 az0(0.0);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            v2r8 po0(0.0);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            v2r8 ax1(0.0);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            v2r8 ay1(0.0);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            v2r8 az1(0.0);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            v2r8 po1(0.0);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            v2r8 ax2(0.0);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            v2r8 ay2(0.0);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            v2r8 az2(0.0);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            v2r8 po2(0.0);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            v2r8 ax3(0.0);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            v2r8 ay3(0.0);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            v2r8 az3(0.0);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            v2r8 po3(0.0);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160; </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;nj; j++){</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <span class="keyword">const</span> v2r8 jp_xy    = v2r8::load(spjbuf[j] + 0);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                <span class="keyword">const</span> v2r8 jp_zm    = v2r8::load(spjbuf[j] + 2);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                <span class="keyword">const</span> v2r8 jp_xx_yy = v2r8::load(spjbuf[j] + 4);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                <span class="keyword">const</span> v2r8 jp_xy_yz = v2r8::load(spjbuf[j] + 6);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                <span class="keyword">const</span> v2r8 jp_zx_tr = v2r8::load(spjbuf[j] + 8);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi0, yi0, zi0, ax0, ay0, az0, po0);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi1, yi1, zi1, ax1, ay1, az1, po1);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi2, yi2, zi2, ax2, ay2, az2, po2);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi3, yi3, zi3, ax3, ay3, az3, po3);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            ax0.store(accpbuf[0 + i/2][0]);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            ay0.store(accpbuf[0 + i/2][1]);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;            az0.store(accpbuf[0 + i/2][2]);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            po0.store(accpbuf[0 + i/2][3]);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;            ax1.store(accpbuf[1 + i/2][0]);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            ay1.store(accpbuf[1 + i/2][1]);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            az1.store(accpbuf[1 + i/2][2]);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            po1.store(accpbuf[1 + i/2][3]);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            ax2.store(accpbuf[2 + i/2][0]);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            ay2.store(accpbuf[2 + i/2][1]);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            az2.store(accpbuf[2 + i/2][2]);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            po2.store(accpbuf[2 + i/2][3]);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            ax3.store(accpbuf[3 + i/2][0]);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            ay3.store(accpbuf[3 + i/2][1]);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            az3.store(accpbuf[3 + i/2][2]);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            po3.store(accpbuf[3 + i/2][3]);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        }</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    }</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="comment">//#if 0</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="comment">//    __attribute__ ((noinline))</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="comment">//    void kernel_spj_unroll8(const int ni, const int nj){</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="comment">//      for(int i=0; i&lt;ni; i+=16){</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">//          const v2r8 veps2 = v2r8(eps2);</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">//          const v2r8 xi0 = v2r8::load(xibuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">//          const v2r8 yi0 = v2r8::load(xibuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">//          const v2r8 zi0 = v2r8::load(xibuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">//          const v2r8 xi1 = v2r8::load(xibuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">//          const v2r8 yi1 = v2r8::load(xibuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">//          const v2r8 zi1 = v2r8::load(xibuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">//          const v2r8 xi2 = v2r8::load(xibuf[2 + i/2][0]);</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">//          const v2r8 yi2 = v2r8::load(xibuf[2 + i/2][1]);</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">//          const v2r8 zi2 = v2r8::load(xibuf[2 + i/2][2]);</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">//          const v2r8 xi3 = v2r8::load(xibuf[3 + i/2][0]);</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">//          const v2r8 yi3 = v2r8::load(xibuf[3 + i/2][1]);</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">//          const v2r8 zi3 = v2r8::load(xibuf[3 + i/2][2]);</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">//          const v2r8 xi4 = v2r8::load(xibuf[4 + i/2][0]);</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">//          const v2r8 yi4 = v2r8::load(xibuf[4 + i/2][1]);</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">//          const v2r8 zi4 = v2r8::load(xibuf[4 + i/2][2]);</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">//          const v2r8 xi5 = v2r8::load(xibuf[5 + i/2][0]);</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment">//          const v2r8 yi5 = v2r8::load(xibuf[5 + i/2][1]);</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">//          const v2r8 zi5 = v2r8::load(xibuf[5 + i/2][2]);</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">//          const v2r8 xi6 = v2r8::load(xibuf[6 + i/2][0]);</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">//          const v2r8 yi6 = v2r8::load(xibuf[6 + i/2][1]);</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">//          const v2r8 zi6 = v2r8::load(xibuf[6 + i/2][2]);</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">//          const v2r8 xi7 = v2r8::load(xibuf[7 + i/2][0]);</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">//          const v2r8 yi7 = v2r8::load(xibuf[7 + i/2][1]);</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">//          const v2r8 zi7 = v2r8::load(xibuf[7 + i/2][2]);</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">//          v2r8 ax0(0.0);</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">//          v2r8 ay0(0.0);</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">//          v2r8 az0(0.0);</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">//          v2r8 po0(0.0);</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">//          v2r8 ax1(0.0);</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">//          v2r8 ay1(0.0);</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">//          v2r8 az1(0.0);</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">//          v2r8 po1(0.0);</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">//          v2r8 ax2(0.0);</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">//          v2r8 ay2(0.0);</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment">//          v2r8 az2(0.0);</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">//          v2r8 po2(0.0);</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="comment">//          v2r8 ax3(0.0);</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">//          v2r8 ay3(0.0);</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment">//          v2r8 az3(0.0);</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment">//          v2r8 po3(0.0);</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment">//          v2r8 ax4(0.0);</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment">//          v2r8 ay4(0.0);</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment">//          v2r8 az4(0.0);</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">//          v2r8 po4(0.0);</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">//          v2r8 ax5(0.0);</span></div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">//          v2r8 ay5(0.0);</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">//          v2r8 az5(0.0);</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">//          v2r8 po5(0.0);</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">//          v2r8 ax6(0.0);</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">//          v2r8 ay6(0.0);</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">//          v2r8 az6(0.0);</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">//          v2r8 po6(0.0);</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="comment">//          v2r8 ax7(0.0);</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment">//          v2r8 ay7(0.0);</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">//          v2r8 az7(0.0);</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">//          v2r8 po7(0.0);</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="comment">//          for(int j=0; j&lt;nj; j++){</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="comment">//              const v2r8 jp_xy    = v2r8::load(spjbuf[j] + 0);</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="comment">//              const v2r8 jp_zm    = v2r8::load(spjbuf[j] + 2);</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="comment">//              const v2r8 jp_xx_yy = v2r8::load(spjbuf[j] + 4);</span></div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="comment">//              const v2r8 jp_xy_yz = v2r8::load(spjbuf[j] + 6);</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="comment">//              const v2r8 jp_zx_tr = v2r8::load(spjbuf[j] + 8);</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi0, yi0, zi0, ax0, ay0, az0, po0);</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi1, yi1, zi1, ax1, ay1, az1, po1);</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi2, yi2, zi2, ax2, ay2, az2, po2);</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi3, yi3, zi3, ax3, ay3, az3, po3);</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi4, yi4, zi4, ax4, ay4, az4, po4);</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi5, yi5, zi5, ax5, ay5, az5, po5);</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi6, yi6, zi6, ax6, ay6, az6, po6);</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="comment">//              inline_kernel_spj(veps2, jp_xy, jp_zm, jp_xx_yy, jp_xy_yz, jp_zx_tr, xi7, yi7, zi7, ax7, ay7, az7, po7);</span></div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="comment">//          }</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="comment">// </span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">//          ax0.store(accpbuf[0 + i/2][0]);</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">//          ay0.store(accpbuf[0 + i/2][1]);</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">//          az0.store(accpbuf[0 + i/2][2]);</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">//          po0.store(accpbuf[0 + i/2][3]);</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment">//          ax1.store(accpbuf[1 + i/2][0]);</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment">//          ay1.store(accpbuf[1 + i/2][1]);</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">//          az1.store(accpbuf[1 + i/2][2]);</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment">//          po1.store(accpbuf[1 + i/2][3]);</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment">//          ax2.store(accpbuf[2 + i/2][0]);</span></div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment">//          ay2.store(accpbuf[2 + i/2][1]);</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment">//          az2.store(accpbuf[2 + i/2][2]);</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment">//          po2.store(accpbuf[2 + i/2][3]);</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment">//          ax3.store(accpbuf[3 + i/2][0]);</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">//          ay3.store(accpbuf[3 + i/2][1]);</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">//          az3.store(accpbuf[3 + i/2][2]);</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">//          po3.store(accpbuf[3 + i/2][3]);</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">//          ax4.store(accpbuf[4 + i/2][0]);</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment">//          ay4.store(accpbuf[4 + i/2][1]);</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">//          az4.store(accpbuf[4 + i/2][2]);</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">//          po4.store(accpbuf[4 + i/2][3]);</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">//          ax5.store(accpbuf[5 + i/2][0]);</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">//          ay5.store(accpbuf[5 + i/2][1]);</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">//          az5.store(accpbuf[5 + i/2][2]);</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment">//          po5.store(accpbuf[5 + i/2][3]);</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">//          ax6.store(accpbuf[6 + i/2][0]);</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment">//          ay6.store(accpbuf[6 + i/2][1]);</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">//          az6.store(accpbuf[6 + i/2][2]);</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">//          po6.store(accpbuf[6 + i/2][3]);</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">//          ax7.store(accpbuf[7 + i/2][0]);</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">//          ay7.store(accpbuf[7 + i/2][1]);</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">//          az7.store(accpbuf[7 + i/2][2]);</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">//          po7.store(accpbuf[7 + i/2][3]);</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">//#endif</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;} <a class="code" href="phantomquad__for__p3t__k_8hpp.html#a7dea9d4e439d6bb67f37937d3bf6e253">__attribute__</a> ((aligned(128)));</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassPhantomGrapeQuad_html_a68b135fe28235143061518be2cafbfee"><div class="ttname"><a href="classPhantomGrapeQuad.html#a68b135fe28235143061518be2cafbfee">PhantomGrapeQuad::run_epj</a></div><div class="ttdeci">void run_epj(const int ni, const int nj)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:163</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a0a52434a193d7b3c7db20963a03762b6"><div class="ttname"><a href="classPhantomGrapeQuad.html#a0a52434a193d7b3c7db20963a03762b6">PhantomGrapeQuad::set_r_crit2</a></div><div class="ttdeci">void set_r_crit2(const double _r_crit2)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:60</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a7623464a19889be5b75a32bb02e8744b"><div class="ttname"><a href="classPhantomGrapeQuad.html#a7623464a19889be5b75a32bb02e8744b">PhantomGrapeQuad::set_cutoff</a></div><div class="ttdeci">void set_cutoff(const double _r_out, const double _r_in)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:65</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa"><div class="ttname"><a href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1ac27af9f0fda44506e6d29a6073fb1cfa">PhantomGrapeQuad::NJMAX</a></div><div class="ttdeci">@ NJMAX</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:8</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a7a6ef2e89e218a5b2cbaa5e4e84acfeb"><div class="ttname"><a href="classPhantomGrapeQuad.html#a7a6ef2e89e218a5b2cbaa5e4e84acfeb">PhantomGrapeQuad::run_spj</a></div><div class="ttdeci">void run_spj(const int ni, const int nj)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:196</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_af36b8097b2442d3e4c4635cf765b8ef7"><div class="ttname"><a href="classPhantomGrapeQuad.html#af36b8097b2442d3e4c4635cf765b8ef7">PhantomGrapeQuad::accum_accp_one</a></div><div class="ttdeci">void accum_accp_one(const int addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot, real_t &amp;nngb)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:153</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a7b9aab0edd6d54f10816b09b81a57166"><div class="ttname"><a href="classPhantomGrapeQuad.html#a7b9aab0edd6d54f10816b09b81a57166">PhantomGrapeQuad::set_epj_one</a></div><div class="ttdeci">void set_epj_one(const int addr, const double x, const double y, const double z, const double m, const double r_search)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:76</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a37b4068e0d3ce2de6783e3b4b00ae4be"><div class="ttname"><a href="classPhantomGrapeQuad.html#a37b4068e0d3ce2de6783e3b4b00ae4be">PhantomGrapeQuad::set_epj</a></div><div class="ttdeci">void set_epj(const int nj, const EPJ_t epj[])</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_af692dd584d3240820f613b756899dd6c"><div class="ttname"><a href="classPhantomGrapeQuad.html#af692dd584d3240820f613b756899dd6c">PhantomGrapeQuad::set_xi</a></div><div class="ttdeci">void set_xi(const int ni, const EPI_t spj[])</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a166448ffe16034085c6ec5fac45b599d"><div class="ttname"><a href="classPhantomGrapeQuad.html#a166448ffe16034085c6ec5fac45b599d">PhantomGrapeQuad::set_xi_one</a></div><div class="ttdeci">void set_xi_one(const int addr, const double x, const double y, const double z, const double r_search)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:109</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a27280675f9fc272c3c4ece62e319097a"><div class="ttname"><a href="classPhantomGrapeQuad.html#a27280675f9fc272c3c4ece62e319097a">PhantomGrapeQuad::set_eps2</a></div><div class="ttdeci">void set_eps2(const double _eps2)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:56</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_abec53e8037f39f3f628a9cb3c96672aa"><div class="ttname"><a href="classPhantomGrapeQuad.html#abec53e8037f39f3f628a9cb3c96672aa">PhantomGrapeQuad::run_epj_for_p3t_with_linear_cutoff</a></div><div class="ttdeci">void run_epj_for_p3t_with_linear_cutoff(const int ni, const int nj)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:187</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a990fb670fa631cd60579abd2f9698592"><div class="ttname"><a href="classPhantomGrapeQuad.html#a990fb670fa631cd60579abd2f9698592">PhantomGrapeQuad::set_spj</a></div><div class="ttdeci">void set_spj(const int nj, const SPJ_t spj[])</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_ad3bada74be2fd462ad6bc7436a1a2aff"><div class="ttname"><a href="classPhantomGrapeQuad.html#ad3bada74be2fd462ad6bc7436a1a2aff">PhantomGrapeQuad::get_accp_one</a></div><div class="ttdeci">void get_accp_one(const int addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot, real_t &amp;nngb)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:131</div></div>
<div class="ttc" id="aphantomquad__for__p3t__k_8hpp_html_a7dea9d4e439d6bb67f37937d3bf6e253"><div class="ttname"><a href="phantomquad__for__p3t__k_8hpp.html#a7dea9d4e439d6bb67f37937d3bf6e253">__attribute__</a></div><div class="ttdeci">class PhantomGrapeQuad __attribute__((aligned(128)))</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a41fb5578294c3ec07e10835246f53fbd"><div class="ttname"><a href="classPhantomGrapeQuad.html#a41fb5578294c3ec07e10835246f53fbd">PhantomGrapeQuad::accum_accp_one</a></div><div class="ttdeci">void accum_accp_one(const int addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:143</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a71827ad91adb544c807c6d9da5b656b8"><div class="ttname"><a href="classPhantomGrapeQuad.html#a71827ad91adb544c807c6d9da5b656b8">PhantomGrapeQuad::set_spj_one</a></div><div class="ttdeci">void set_spj_one(const int addr, const double x, const double y, const double z, const double m, const double qxx, const double qyy, const double qzz, const double qxy, const double qyz, const double qzx)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:87</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_aad35281ff10595e6adc34348bb7a294a"><div class="ttname"><a href="classPhantomGrapeQuad.html#aad35281ff10595e6adc34348bb7a294a">PhantomGrapeQuad::__attribute__</a></div><div class="ttdeci">enum PhantomGrapeQuad::@0 __attribute__</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d"><div class="ttname"><a href="classPhantomGrapeQuad.html#a575a96b3649db45883d126bb3ddee9f1a8ecf94d5ff53108b51293bdce063b37d">PhantomGrapeQuad::NIMAX</a></div><div class="ttdeci">@ NIMAX</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:7</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_abe360e7a15d8925fbe353ee0de4800f6"><div class="ttname"><a href="classPhantomGrapeQuad.html#abe360e7a15d8925fbe353ee0de4800f6">PhantomGrapeQuad::get_accp_one</a></div><div class="ttdeci">void get_accp_one(const int addr, real_t &amp;ax, real_t &amp;ay, real_t &amp;az, real_t &amp;pot)</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:122</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html_a88473c2a65922d0b4fc5684269e815e5"><div class="ttname"><a href="classPhantomGrapeQuad.html#a88473c2a65922d0b4fc5684269e815e5">PhantomGrapeQuad::PhantomGrapeQuad</a></div><div class="ttdeci">PhantomGrapeQuad()</div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:47</div></div>
<div class="ttc" id="aclassPhantomGrapeQuad_html"><div class="ttname"><a href="classPhantomGrapeQuad.html">PhantomGrapeQuad</a></div><div class="ttdef"><b>Definition:</b> phantomquad_for_p3t_k.hpp:4</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="phantomquad__for__p3t__k_8hpp.html">phantomquad_for_p3t_k.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
